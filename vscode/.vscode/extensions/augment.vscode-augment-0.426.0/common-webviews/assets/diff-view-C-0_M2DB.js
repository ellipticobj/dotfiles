var pp=Object.defineProperty;var Xl=o=>{throw TypeError(o)};var gp=(o,t,r)=>t in o?pp(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r;var m=(o,t,r)=>gp(o,typeof t!="symbol"?t+"":t,r),mu=(o,t,r)=>t.has(o)||Xl("Cannot "+r);var y=(o,t,r)=>(mu(o,t,"read from private field"),r?r.call(o):t.get(o)),ke=(o,t,r)=>t.has(o)?Xl("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,r),ue=(o,t,r,i)=>(mu(o,t,"write to private field"),i?i.call(o,r):t.set(o,r),r),J=(o,t,r)=>(mu(o,t,"access private method"),r);var zo=(o,t,r,i)=>({set _(s){ue(o,t,s,r)},get _(){return y(o,t,i)}});import{al as tn,am as Nh,a9 as bt,ab as pt,aB as Kl,ac as Mu,S as oi,d as ai,e as ui,Y as ur,y as We,Q as Ue,z as G,j as De,E as pn,R as Fi,k as re,l as He,A as Z,T as Rh,G as Rr,b as O,a as $t,t as U,c as wt,m as ie,B as Y,I as Zu,a7 as si,a0 as xt,K as Oi,ap as _p,aq as mp,a4 as hr,n as Be,af as ar,ag as jh,a2 as cr,aa as vu,aC as zi,a5 as eh,ad as vp,ae as Yu,aj as Dh,an as yp,aD as bp,Z as Uh,ah as $p,a8 as wp,U as xp,aE as Cp,aF as Sp}from"./index-Bg5k1fBH.js";import"./design-system-init-CB2neNOj.js";import{g as Ip}from"./globals-D0QH3NT1.js";import{S as Ep,W as it,h as Es,D as yu,a as jr,e as Yo}from"./ButtonAugment-CSwi-JVg.js";import{A as Mp,I as kp}from"./IconButtonAugment-CMGBc7C3.js";import{i as sr,a as Li,E as Yt,b as Ms,S as xs,C as Cs,c as na,d as Ap,e as Tp,D as Fp,f as Op,g as Lp,s as bu,h as Ju,j as Jo,k as Qo,l as Qu,m as Xo,n as Xu,o as Ko,p as Np,q as $u,K as ci,r as Rp,t as ks,u as qh,U as jp,v as Dp,w as Up,x as th,R as qp,B as zp,P as Pp,y as Wp,T as Hp,A as Bp,z as Vp,F as Gp,G as Zp,H as Yp,M as ku,I as zh,J as Jp,L as Qp,N as Xp}from"./Keybindings-B3h1jpi_.js";import{P as Mt,F as Ph,a as Ni,f as Kp,g as Au,e as eg,C as gn,I as ws,E as tg,h as ng,i as nn,j as rg,k as Wh}from"./folder-opened-Bm8IVIHF.js";import{M as Hh,T as ig}from"./TextTooltipAugment-BspEVawc.js";import{S as sg,a as nh}from"./pen-to-square-DVpukHrw.js";import{a as og}from"./Content-DlSDhH-b.js";import{D as wu}from"./index-CqmTMtlA.js";import{M as Pi}from"./MaterialIcon-BhPUHxOM.js";import{E as ag}from"./exclamation-triangle-CVGAe7xx.js";import"./file-paths-BcSg4gks.js";import"./augment-logo-rit98iY0.js";var rh=NaN,ug="[object Symbol]",cg=/^\s+|\s+$/g,lg=/^[-+]0x[0-9a-f]+$/i,hg=/^0b[01]+$/i,fg=/^0o[0-7]+$/i,dg=parseInt,pg=typeof tn=="object"&&tn&&tn.Object===Object&&tn,gg=typeof self=="object"&&self&&self.Object===Object&&self,_g=pg||gg||Function("return this")(),mg=Object.prototype.toString,vg=Math.max,yg=Math.min,xu=function(){return _g.Date.now()};function Tu(o){var t=typeof o;return!!o&&(t=="object"||t=="function")}function ih(o){if(typeof o=="number")return o;if(function(i){return typeof i=="symbol"||function(s){return!!s&&typeof s=="object"}(i)&&mg.call(i)==ug}(o))return rh;if(Tu(o)){var t=typeof o.valueOf=="function"?o.valueOf():o;o=Tu(t)?t+"":t}if(typeof o!="string")return o===0?o:+o;o=o.replace(cg,"");var r=hg.test(o);return r||fg.test(o)?dg(o.slice(2),r?2:8):lg.test(o)?rh:+o}const Fu=Nh(function(o,t,r){var i,s,u,c,h,f,v=0,_=!1,b=!1,x=!0;if(typeof o!="function")throw new TypeError("Expected a function");function E(F){var ne=i,de=s;return i=s=void 0,v=F,c=o.apply(de,ne)}function T(F){var ne=F-f;return f===void 0||ne>=t||ne<0||b&&F-v>=u}function q(){var F=xu();if(T(F))return L(F);h=setTimeout(q,function(ne){var de=t-(ne-f);return b?yg(de,u-(ne-v)):de}(F))}function L(F){return h=void 0,x&&i?E(F):(i=s=void 0,c)}function S(){var F=xu(),ne=T(F);if(i=arguments,s=this,f=F,ne){if(h===void 0)return function(de){return v=de,h=setTimeout(q,t),_?E(de):c}(f);if(b)return h=setTimeout(q,t),E(f)}return h===void 0&&(h=setTimeout(q,t)),c}return t=ih(t)||0,Tu(r)&&(_=!!r.leading,u=(b="maxWait"in r)?vg(ih(r.maxWait)||0,t):u,x="trailing"in r?!!r.trailing:x),S.cancel=function(){h!==void 0&&clearTimeout(h),v=0,i=f=s=h=void 0},S.flush=function(){return h===void 0?c:L(xu())},S});var Ou={exports:{}};(function(o,t){var r="__lodash_hash_undefined__",i=1,s=2,u=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",v="[object Boolean]",_="[object Date]",b="[object Error]",x="[object Function]",E="[object GeneratorFunction]",T="[object Map]",q="[object Number]",L="[object Null]",S="[object Object]",F="[object Promise]",ne="[object Proxy]",de="[object RegExp]",oe="[object Set]",Re="[object String]",pe="[object Symbol]",Ie="[object Undefined]",_e="[object WeakMap]",Fe="[object ArrayBuffer]",Pe="[object DataView]",st=/^\[object .+?Constructor\]$/,Se=/^(?:0|[1-9]\d*)$/,we={};we["[object Float32Array]"]=we["[object Float64Array]"]=we["[object Int8Array]"]=we["[object Int16Array]"]=we["[object Int32Array]"]=we["[object Uint8Array]"]=we["[object Uint8ClampedArray]"]=we["[object Uint16Array]"]=we["[object Uint32Array]"]=!0,we[c]=we[h]=we[Fe]=we[v]=we[Pe]=we[_]=we[b]=we[x]=we[T]=we[q]=we[S]=we[de]=we[oe]=we[Re]=we[_e]=!1;var at=typeof tn=="object"&&tn&&tn.Object===Object&&tn,_n=typeof self=="object"&&self&&self.Object===Object&&self,Ct=at||_n||Function("return this")(),fe=t&&!t.nodeType&&t,mn=fe&&o&&!o.nodeType&&o,Tn=mn&&mn.exports===fe,Bn=Tn&&at.process,fr=function(){try{return Bn&&Bn.binding&&Bn.binding("util")}catch{}}(),li=fr&&fr.isTypedArray;function Wi(C,k){for(var W=-1,ee=C==null?0:C.length;++W<ee;)if(k(C[W],W,C))return!0;return!1}function ra(C){var k=-1,W=Array(C.size);return C.forEach(function(ee,qe){W[++k]=[qe,ee]}),W}function ia(C){var k=-1,W=Array(C.size);return C.forEach(function(ee){W[++k]=ee}),W}var Fs,Hi,Bi,sa=Array.prototype,oa=Function.prototype,hi=Object.prototype,Vi=Ct["__core-js_shared__"],Gi=oa.toString,rn=hi.hasOwnProperty,Os=(Fs=/[^.]+$/.exec(Vi&&Vi.keys&&Vi.keys.IE_PROTO||""))?"Symbol(src)_1."+Fs:"",Ls=hi.toString,Zi=RegExp("^"+Gi.call(rn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ns=Tn?Ct.Buffer:void 0,dr=Ct.Symbol,Rs=Ct.Uint8Array,js=hi.propertyIsEnumerable,aa=sa.splice,Vn=dr?dr.toStringTag:void 0,Ds=Object.getOwnPropertySymbols,ua=Ns?Ns.isBuffer:void 0,ca=(Hi=Object.keys,Bi=Object,function(C){return Hi(Bi(C))}),Yi=Rn(Ct,"DataView"),pr=Rn(Ct,"Map"),Ji=Rn(Ct,"Promise"),Qi=Rn(Ct,"Set"),Xi=Rn(Ct,"WeakMap"),Ur=Rn(Object,"create"),la=Gn(Yi),ha=Gn(pr),fi=Gn(Ji),fa=Gn(Qi),di=Gn(Xi),Ki=dr?dr.prototype:void 0,pi=Ki?Ki.valueOf:void 0;function Fn(C){var k=-1,W=C==null?0:C.length;for(this.clear();++k<W;){var ee=C[k];this.set(ee[0],ee[1])}}function sn(C){var k=-1,W=C==null?0:C.length;for(this.clear();++k<W;){var ee=C[k];this.set(ee[0],ee[1])}}function On(C){var k=-1,W=C==null?0:C.length;for(this.clear();++k<W;){var ee=C[k];this.set(ee[0],ee[1])}}function qr(C){var k=-1,W=C==null?0:C.length;for(this.__data__=new On;++k<W;)this.add(C[k])}function Ln(C){var k=this.__data__=new sn(C);this.size=k.size}function da(C,k){var W=Pr(C),ee=!W&&Ws(C),qe=!W&&!ee&&_i(C),X=!W&&!ee&&!qe&&Vs(C),he=W||ee||qe||X,Qe=he?function(Xe,on){for(var ze=-1,ut=Array(Xe);++ze<Xe;)ut[ze]=on(ze);return ut}(C.length,String):[],Ht=Qe.length;for(var tt in C)!rn.call(C,tt)||he&&(tt=="length"||qe&&(tt=="offset"||tt=="parent")||X&&(tt=="buffer"||tt=="byteLength"||tt=="byteOffset")||Ps(tt,Ht))||Qe.push(tt);return Qe}function zr(C,k){for(var W=C.length;W--;)if(ns(C[W][0],k))return W;return-1}function Nn(C){return C==null?C===void 0?Ie:L:Vn&&Vn in Object(C)?function(k){var W=rn.call(k,Vn),ee=k[Vn];try{k[Vn]=void 0;var qe=!0}catch{}var X=Ls.call(k);return qe&&(W?k[Vn]=ee:delete k[Vn]),X}(C):function(k){return Ls.call(k)}(C)}function es(C){return Wr(C)&&Nn(C)==c}function Us(C,k,W,ee,qe){return C===k||(C==null||k==null||!Wr(C)&&!Wr(k)?C!=C&&k!=k:function(X,he,Qe,Ht,tt,Xe){var on=Pr(X),ze=Pr(he),ut=on?h:vn(X),St=ze?h:vn(he),Zn=(ut=ut==c?S:ut)==S,mr=(St=St==c?S:St)==S,ct=ut==St;if(ct&&_i(X)){if(!_i(he))return!1;on=!0,Zn=!1}if(ct&&!Zn)return Xe||(Xe=new Ln),on||Vs(X)?gi(X,he,Qe,Ht,tt,Xe):function(Oe,Ae,gt,jn,kt,Ut,an){switch(gt){case Pe:if(Oe.byteLength!=Ae.byteLength||Oe.byteOffset!=Ae.byteOffset)return!1;Oe=Oe.buffer,Ae=Ae.buffer;case Fe:return!(Oe.byteLength!=Ae.byteLength||!Ut(new Rs(Oe),new Rs(Ae)));case v:case _:case q:return ns(+Oe,+Ae);case b:return Oe.name==Ae.name&&Oe.message==Ae.message;case de:case Re:return Oe==Ae+"";case T:var It=ra;case oe:var Dn=jn&i;if(It||(It=ia),Oe.size!=Ae.size&&!Dn)return!1;var yr=an.get(Oe);if(yr)return yr==Ae;jn|=s,an.set(Oe,Ae);var je=gi(It(Oe),It(Ae),jn,kt,Ut,an);return an.delete(Oe),je;case pe:if(pi)return pi.call(Oe)==pi.call(Ae)}return!1}(X,he,ut,Qe,Ht,tt,Xe);if(!(Qe&i)){var vr=Zn&&rn.call(X,"__wrapped__"),ss=mr&&rn.call(he,"__wrapped__");if(vr||ss){var Gs=vr?X.value():X,Zs=ss?he.value():he;return Xe||(Xe=new Ln),tt(Gs,Zs,Qe,Ht,Xe)}}return ct?(Xe||(Xe=new Ln),function(Oe,Ae,gt,jn,kt,Ut){var an=gt&i,It=ts(Oe),Dn=It.length,yr=ts(Ae),je=yr.length;if(Dn!=je&&!an)return!1;for(var Bt=Dn;Bt--;){var yn=It[Bt];if(!(an?yn in Ae:rn.call(Ae,yn)))return!1}var Ys=Ut.get(Oe);if(Ys&&Ut.get(Ae))return Ys==Ae;var br=!0;Ut.set(Oe,Ae),Ut.set(Ae,Oe);for(var os=an;++Bt<Dn;){var Hr=Oe[yn=It[Bt]],Yn=Ae[yn];if(jn)var Jn=an?jn(Yn,Hr,yn,Ae,Oe,Ut):jn(Hr,Yn,yn,Oe,Ae,Ut);if(!(Jn===void 0?Hr===Yn||kt(Hr,Yn,gt,jn,Ut):Jn)){br=!1;break}os||(os=yn=="constructor")}if(br&&!os){var mi=Oe.constructor,Br=Ae.constructor;mi==Br||!("constructor"in Oe)||!("constructor"in Ae)||typeof mi=="function"&&mi instanceof mi&&typeof Br=="function"&&Br instanceof Br||(br=!1)}return Ut.delete(Oe),Ut.delete(Ae),br}(X,he,Qe,Ht,tt,Xe)):!1}(C,k,W,ee,Us,qe))}function qs(C){return!(!Bs(C)||function(k){return!!Os&&Os in k}(C))&&(rs(C)?Zi:st).test(Gn(C))}function zs(C){if(W=(k=C)&&k.constructor,ee=typeof W=="function"&&W.prototype||hi,k!==ee)return ca(C);var k,W,ee,qe=[];for(var X in Object(C))rn.call(C,X)&&X!="constructor"&&qe.push(X);return qe}function gi(C,k,W,ee,qe,X){var he=W&i,Qe=C.length,Ht=k.length;if(Qe!=Ht&&!(he&&Ht>Qe))return!1;var tt=X.get(C);if(tt&&X.get(k))return tt==k;var Xe=-1,on=!0,ze=W&s?new qr:void 0;for(X.set(C,k),X.set(k,C);++Xe<Qe;){var ut=C[Xe],St=k[Xe];if(ee)var Zn=he?ee(St,ut,Xe,k,C,X):ee(ut,St,Xe,C,k,X);if(Zn!==void 0){if(Zn)continue;on=!1;break}if(ze){if(!Wi(k,function(mr,ct){if(vr=ct,!ze.has(vr)&&(ut===mr||qe(ut,mr,W,ee,X)))return ze.push(ct);var vr})){on=!1;break}}else if(ut!==St&&!qe(ut,St,W,ee,X)){on=!1;break}}return X.delete(C),X.delete(k),on}function ts(C){return function(k,W,ee){var qe=W(k);return Pr(k)?qe:function(X,he){for(var Qe=-1,Ht=he.length,tt=X.length;++Qe<Ht;)X[tt+Qe]=he[Qe];return X}(qe,ee(k))}(C,is,_r)}function gr(C,k){var W,ee,qe=C.__data__;return((ee=typeof(W=k))=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?W!=="__proto__":W===null)?qe[typeof k=="string"?"string":"hash"]:qe.map}function Rn(C,k){var W=function(ee,qe){return ee==null?void 0:ee[qe]}(C,k);return qs(W)?W:void 0}Fn.prototype.clear=function(){this.__data__=Ur?Ur(null):{},this.size=0},Fn.prototype.delete=function(C){var k=this.has(C)&&delete this.__data__[C];return this.size-=k?1:0,k},Fn.prototype.get=function(C){var k=this.__data__;if(Ur){var W=k[C];return W===r?void 0:W}return rn.call(k,C)?k[C]:void 0},Fn.prototype.has=function(C){var k=this.__data__;return Ur?k[C]!==void 0:rn.call(k,C)},Fn.prototype.set=function(C,k){var W=this.__data__;return this.size+=this.has(C)?0:1,W[C]=Ur&&k===void 0?r:k,this},sn.prototype.clear=function(){this.__data__=[],this.size=0},sn.prototype.delete=function(C){var k=this.__data__,W=zr(k,C);return!(W<0)&&(W==k.length-1?k.pop():aa.call(k,W,1),--this.size,!0)},sn.prototype.get=function(C){var k=this.__data__,W=zr(k,C);return W<0?void 0:k[W][1]},sn.prototype.has=function(C){return zr(this.__data__,C)>-1},sn.prototype.set=function(C,k){var W=this.__data__,ee=zr(W,C);return ee<0?(++this.size,W.push([C,k])):W[ee][1]=k,this},On.prototype.clear=function(){this.size=0,this.__data__={hash:new Fn,map:new(pr||sn),string:new Fn}},On.prototype.delete=function(C){var k=gr(this,C).delete(C);return this.size-=k?1:0,k},On.prototype.get=function(C){return gr(this,C).get(C)},On.prototype.has=function(C){return gr(this,C).has(C)},On.prototype.set=function(C,k){var W=gr(this,C),ee=W.size;return W.set(C,k),this.size+=W.size==ee?0:1,this},qr.prototype.add=qr.prototype.push=function(C){return this.__data__.set(C,r),this},qr.prototype.has=function(C){return this.__data__.has(C)},Ln.prototype.clear=function(){this.__data__=new sn,this.size=0},Ln.prototype.delete=function(C){var k=this.__data__,W=k.delete(C);return this.size=k.size,W},Ln.prototype.get=function(C){return this.__data__.get(C)},Ln.prototype.has=function(C){return this.__data__.has(C)},Ln.prototype.set=function(C,k){var W=this.__data__;if(W instanceof sn){var ee=W.__data__;if(!pr||ee.length<199)return ee.push([C,k]),this.size=++W.size,this;W=this.__data__=new On(ee)}return W.set(C,k),this.size=W.size,this};var _r=Ds?function(C){return C==null?[]:(C=Object(C),function(k,W){for(var ee=-1,qe=k==null?0:k.length,X=0,he=[];++ee<qe;){var Qe=k[ee];W(Qe,ee,k)&&(he[X++]=Qe)}return he}(Ds(C),function(k){return js.call(C,k)}))}:function(){return[]},vn=Nn;function Ps(C,k){return!!(k=k??u)&&(typeof C=="number"||Se.test(C))&&C>-1&&C%1==0&&C<k}function Gn(C){if(C!=null){try{return Gi.call(C)}catch{}try{return C+""}catch{}}return""}function ns(C,k){return C===k||C!=C&&k!=k}(Yi&&vn(new Yi(new ArrayBuffer(1)))!=Pe||pr&&vn(new pr)!=T||Ji&&vn(Ji.resolve())!=F||Qi&&vn(new Qi)!=oe||Xi&&vn(new Xi)!=_e)&&(vn=function(C){var k=Nn(C),W=k==S?C.constructor:void 0,ee=W?Gn(W):"";if(ee)switch(ee){case la:return Pe;case ha:return T;case fi:return F;case fa:return oe;case di:return _e}return k});var Ws=es(function(){return arguments}())?es:function(C){return Wr(C)&&rn.call(C,"callee")&&!js.call(C,"callee")},Pr=Array.isArray,_i=ua||function(){return!1};function rs(C){if(!Bs(C))return!1;var k=Nn(C);return k==x||k==E||k==f||k==ne}function Hs(C){return typeof C=="number"&&C>-1&&C%1==0&&C<=u}function Bs(C){var k=typeof C;return C!=null&&(k=="object"||k=="function")}function Wr(C){return C!=null&&typeof C=="object"}var Vs=li?function(C){return function(k){return C(k)}}(li):function(C){return Wr(C)&&Hs(C.length)&&!!we[Nn(C)]};function is(C){return(k=C)!=null&&Hs(k.length)&&!rs(k)?da(C):zs(C);var k}o.exports=function(C,k){return Us(C,k)}})(Ou,Ou.exports);const bg=Nh(Ou.exports);function Bh(o){return function(t){return"unitOfCodeWork"in t&&!function(r){return r.children.length>0&&"childIds"in r}(t)}(o)?[o]:o.children.flatMap(Bh)}function Ri(o){var t;return((t=o.extraData)==null?void 0:t.isAgentConversation)===!0}var yt=(o=>(o[o.active=0]="active",o[o.inactive=1]="inactive",o))(yt||{}),Vh=(o=>(o[o.unset=0]="unset",o[o.positive=1]="positive",o[o.negative=2]="negative",o))(Vh||{}),Ss=(o=>(o[o.unknown=0]="unknown",o[o.new=1]="new",o[o.checkingSafety=2]="checkingSafety",o[o.runnable=3]="runnable",o[o.running=4]="running",o[o.completed=5]="completed",o[o.error=6]="error",o[o.cancelling=7]="cancelling",o[o.cancelled=8]="cancelled",o))(Ss||{});function Cu(o){return o.requestId+";"+o.toolUseId}function sh(o){const[t,r]=o.split(";");return{requestId:t,toolUseId:r}}const oh=o=>sr(o)&&!!o.request_message;function $g(o,t){const r=o.customPersonalityPrompts;if(r)switch(t){case Mt.DEFAULT:if(r.agent&&r.agent.trim()!=="")return r.agent;break;case Mt.PROTOTYPER:if(r.prototyper&&r.prototyper.trim()!=="")return r.prototyper;break;case Mt.BRAINSTORM:if(r.brainstorm&&r.brainstorm.trim()!=="")return r.brainstorm;break;case Mt.REVIEWER:if(r.reviewer&&r.reviewer.trim()!=="")return r.reviewer}return wg[t]}const wg={[Mt.DEFAULT]:`
# Agent Auggie Personality Description
You are Augment Agent, an agentic coding AI assistant.
Focus on helping the user with their coding tasks efficiently.

## Rules:
- You have no restrictions on the tools you may use
- Follow the original system instructions
  `,[Mt.PROTOTYPER]:`
# Prototyper Auggie Personality Description
You are Prototyper Auggie, an agentic coding AI assistant focused on building prototypes and visual applications.

## Your approach:
- Be fast and action-oriented
- Implement things quickly to show results
- Open webpages to demonstrate functionality
- Focus on building something visual and interactive
- Use modern frameworks and tools to create working prototypes
- Prioritize getting a working demo over perfect architecture
- Show progress frequently with visual results
- Prefer to act and run tools, rather than asking for permission
- Only ask for permission if there is something potentially very dangerous or irreversible

## Implementation preferences:
- When user does not specify which frameworks to use, default to modern frameworks, e.g. React with vite or next.js
- Initialize projects using CLI tools instead of writing from scratch
- For database and auth, use Supabase as a good default option
- Before using open-browser to show the app, use curl to check for errors
- Remember that modern frameworks have hot reload, so avoid calling open-browser multiple times

## Rules:
- For extremely destructive or irreversible actions, you should ask for permission
- For other tasks, you must proceed without asking for permission
  `,[Mt.BRAINSTORM]:`
# Brainstorm Auggie Personality Description
You are Brainstorm Auggie, an agentic coding AI assistant focused on planning and brainstorming solutions.

## Your approach:
- Be slow, careful, and thorough in your analysis
- Look through all upstream/downstream APIs to understand implications
- Focus on finding a comprehensive plan that solves the user's query
- Do not run commands, create code, or implement solutions directly
- Your job is to be introspective and think deeply about the problem
- Brainstorm multiple approaches and evaluate their tradeoffs
- Consider edge cases and potential issues with each approach

## Planning preferences:
- Analyze the codebase thoroughly before suggesting changes
- Consider multiple implementation options with pros and cons
- Identify potential risks and challenges for each approach
- Create detailed, step-by-step plans for implementation
- Provide reasoning for architectural decisions
- Consider performance, maintainability, and scalability
- Do not execute the plan - your role is to provide guidance only

## Rules:
- Prefer information gathering and non-destructive tools
- Prefer non-destructive and non-modifying tools
- You must never execute code, modify the codebase, or make changes
- Consider using Mermaid diagrams to help visualize complex concepts
- Once you have a proposal, please examine it critically, and do a revision before finalizing
  `,[Mt.REVIEWER]:`
# Reviewer Auggie Personality Description
You are Reviewer Auggie, an agentic coding AI assistant focused on reviewing code changes and identifying potential issues.

## Your approach:
- Act like a code detective to find potential bugs and issues
- Use git commands to analyze changes against the merge base
- Be super inquisitive and look for anything suspicious
- Build a mental model of what is happening in the code change
- Analyze API implications and downstream effects
- Guard the codebase from potential negative side effects
- Focus on understanding the changes from first principles

## Review preferences:
- Use git and GitHub tools to get code history information
- Compare changes against the logical base or merge base
- Look for edge cases and potential bugs
- Analyze API contracts and potential breaking changes
- Consider performance implications
- Check for security vulnerabilities
- Verify test coverage for the changes

## Rules:
- Use git commands and GitHub API to analyze code changes
- Be thorough and methodical in your analysis
- Focus on finding potential issues rather than implementing solutions
- Provide constructive feedback with specific examples
- Consider both the technical implementation and the broader impact
  `};function xg(o,t,r=1e3){let i=null,s=0;const u=bt(t),c=()=>{const h=(()=>{const f=Date.now();if(i!==null&&f-s<r)return i;const v=o();return i=v,s=f,v})();u.set(h)};return{subscribe:u.subscribe,resetCache:()=>{i=null,c()},updateStore:c}}class et{constructor(t,r,i,s){m(this,"_state");m(this,"_subscribers",new Set);m(this,"_focusModel",new Ph);m(this,"_onSendExchangeListeners",[]);m(this,"_onNewConversationListeners",[]);m(this,"_onHistoryDeleteListeners",[]);m(this,"_onBeforeChangeConversationListeners",[]);m(this,"_truncatedChatHistory",new Ig(8e5,26e4,3));m(this,"_totalCharactersCacheThrottleMs",1e3);m(this,"_totalCharactersStore");m(this,"subscribe",t=>(this._subscribers.add(t),t(this),()=>{this._subscribers.delete(t)}));m(this,"setConversation",(t,r=!0,i=!0)=>{const s=t.id!==this._state.id;s&&i&&(t.toolUseStates=Object.fromEntries(Object.entries(t.toolUseStates??{}).map(([c,h])=>{if(h.requestId&&h.toolUseId){const{requestId:f,toolUseId:v}=sh(c);return f===h.requestId&&v===h.toolUseId||console.warn("Tool use state key does not match request and tool use IDs. Got key ",c,"but object has ",Cu(h)),[c,h]}return[c,{...h,...sh(c)}]})),(t=this._notifyBeforeChangeConversation(this._state,t)).lastInteractedAtIso=new Date().toISOString()),r&&s&&this.isValid&&(this.saveDraftActiveContextIds(),this._unloadContextFromConversation(this._state));const u=et.isEmpty(t);if(s&&u){const c=this._state.draftExchange;c&&(t.draftExchange=c)}return this._state=t,this._focusModel.setItems(this._state.chatHistory.filter(sr)),this._focusModel.initFocusIdx(-1),this._subscribers.forEach(c=>c(this)),this._saveConversation(this._state),s&&(this._loadContextFromConversation(t),this.loadDraftActiveContextIds(),this._onNewConversationListeners.forEach(c=>c())),!0});m(this,"update",t=>{this.setConversation({...this._state,...t}),this._totalCharactersStore.updateStore()});m(this,"toggleIsPinned",()=>{this.update({isPinned:!this.isPinned})});m(this,"setName",t=>{this.update({name:t})});m(this,"setSelectedModelId",t=>{this.update({selectedModelId:t})});m(this,"updateFeedback",(t,r)=>{this.update({feedbackStates:{...this._state.feedbackStates,[t]:r}})});m(this,"updateToolUseState",t=>{this.update({toolUseStates:{...this._state.toolUseStates,[Cu(t)]:t}})});m(this,"getToolUseState",(t,r)=>t===void 0||r===void 0||this.toolUseStates===void 0?{phase:Ss.unknown,requestId:t??"",toolUseId:r??""}:this.toolUseStates[Cu({requestId:t,toolUseId:r})]||{phase:Ss.new});m(this,"getLastToolUseState",()=>{var i,s;const t=this.lastExchange;if(!t)return{phase:Ss.unknown};const r=(((i=t==null?void 0:t.structured_output_nodes)==null?void 0:i.filter(u=>u.type===Ni.TOOL_USE))??[]).at(-1);return r?this.getToolUseState(t.request_id,(s=r.tool_use)==null?void 0:s.tool_use_id):{phase:Ss.unknown}});m(this,"addExchange",t=>{const r=[...this._state.chatHistory,t];let i;sr(t)&&(i=t.request_id?{...this._state.feedbackStates,[t.request_id]:{selectedRating:Vh.unset,feedbackNote:""}}:void 0),this.update({chatHistory:r,...i?{feedbackStates:i}:{},lastUrl:void 0})});m(this,"resetShareUrl",()=>{this.update({lastUrl:void 0})});m(this,"updateExchangeById",(t,r,i=!1)=>{var h;const s=this.exchangeWithRequestId(r);if(s===null)return console.warn("No exchange with this request ID found."),!1;i&&t.response_text!==void 0&&(t.response_text=(s.response_text??"")+(t.response_text??"")),i&&(t.structured_output_nodes=[...s.structured_output_nodes??[],...t.structured_output_nodes??[]]),i&&t.workspace_file_chunks!==void 0&&(t.workspace_file_chunks=[...s.workspace_file_chunks??[],...t.workspace_file_chunks??[]]);const u=(h=(t.structured_output_nodes||[]).find(f=>f.type===Ni.MAIN_TEXT_FINISHED))==null?void 0:h.content;u&&u!==t.response_text&&(t.response_text=u);let c=this._state.isShareable||Li({...s,...t});return this.update({chatHistory:this.chatHistory.map(f=>f.request_id===r?{...f,...t}:f),isShareable:c}),!0});m(this,"clearMessagesFromHistory",t=>{this.update({chatHistory:this.chatHistory.filter(r=>!r.request_id||!t.has(r.request_id))}),this._extensionClient.clearMetadataFor({requestIds:Array.from(t)})});m(this,"clearHistory",()=>{this._extensionClient.clearMetadataFor({requestIds:this.requestIds}),this.update({chatHistory:[]})});m(this,"clearHistoryFrom",async(t,r=!0)=>{const i=this.historyFrom(t,r),s=i.map(u=>u.request_id).filter(u=>u!==void 0);this.update({chatHistory:this.historyTo(t,!r)}),this._extensionClient.clearMetadataFor({requestIds:s}),i.forEach(u=>{this._onHistoryDeleteListeners.forEach(c=>c(u))})});m(this,"clearMessageFromHistory",t=>{this.update({chatHistory:this.chatHistory.filter(r=>r.request_id!==t)}),this._extensionClient.clearMetadataFor({requestIds:[t]})});m(this,"historyTo",(t,r=!1)=>{const i=this.chatHistory.findIndex(s=>s.request_id===t);return i===-1?[]:this.chatHistory.slice(0,r?i+1:i)});m(this,"historyFrom",(t,r=!0)=>{const i=this.chatHistory.findIndex(s=>s.request_id===t);return i===-1?[]:this.chatHistory.slice(r?i:i+1)});m(this,"resendLastExchange",async()=>{const t=this.lastExchange;if(t&&!this.awaitingReply)return this.resendTurn(t)});m(this,"resendTurn",t=>this.awaitingReply?Promise.resolve():(this._removeTurn(t),this.sendExchange({request_message:t.request_message,rich_text_json_repr:t.rich_text_json_repr,status:Yt.draft,mentioned_items:t.mentioned_items,structured_request_nodes:t.structured_request_nodes})));m(this,"_removeTurn",t=>{this.update({chatHistory:this.chatHistory.filter(r=>r!==t&&(!t.request_id||r.request_id!==t.request_id))})});m(this,"exchangeWithRequestId",t=>this.chatHistory.find(r=>r.request_id===t)||null);m(this,"resetTotalCharactersCache",()=>{this._totalCharactersStore.resetCache()});m(this,"markSeen",async t=>{if(!t.request_id||!this.chatHistory.find(i=>i.request_id===t.request_id))return;const r={seen_state:xs.seen};this.update({chatHistory:this.chatHistory.map(i=>i.request_id===t.request_id?{...i,...r}:i)})});m(this,"createStructuredRequestNodes",t=>this._jsonToStructuredRequest(t));m(this,"saveDraftMentions",t=>{if(!this.draftExchange)return;const r=t.filter(i=>!i.personality);this.update({draftExchange:{...this.draftExchange,mentioned_items:r}})});m(this,"saveDraftActiveContextIds",()=>{const t=this._specialContextInputModel.recentActiveItems.map(r=>r.id);this.update({draftActiveContextIds:t})});m(this,"loadDraftActiveContextIds",()=>{const t=new Set(this.draftActiveContextIds??[]),r=this._specialContextInputModel.recentItems.filter(s=>t.has(s.id)||s.recentFile||s.selection||s.sourceFolder),i=this._specialContextInputModel.recentItems.filter(s=>!(t.has(s.id)||s.recentFile||s.selection||s.sourceFolder));this._specialContextInputModel.markItemsActive(r.reverse()),this._specialContextInputModel.markItemsInactive(i.reverse())});m(this,"saveDraftExchange",(t,r)=>{var c,h,f;const i=t!==((c=this.draftExchange)==null?void 0:c.request_message),s=r!==((h=this.draftExchange)==null?void 0:h.rich_text_json_repr);if(!i&&!s)return;const u=(f=this.draftExchange)==null?void 0:f.mentioned_items;this.update({draftExchange:{request_message:t,rich_text_json_repr:r,mentioned_items:u,status:Yt.draft}})});m(this,"clearDraftExchange",()=>{const t=this.draftExchange;return this.update({draftExchange:void 0}),t});m(this,"sendDraftExchange",()=>{if(this._extensionClient.triggerUsedChatMetric(),!this.canSendDraft||!this.draftExchange)return!1;const t=this.clearDraftExchange();if(!t)return!1;const r=this._chatFlagModel.enableChatMultimodal&&t.rich_text_json_repr?this._jsonToStructuredRequest(t.rich_text_json_repr):void 0;return this.sendExchange({...t,structured_request_nodes:r,model_id:this.selectedModelId??void 0}).then(()=>{var c,h;const i=!this.name&&this.chatHistory.length===1&&((c=this.firstExchange)==null?void 0:c.request_id)===this.chatHistory[0].request_id,s=Ri(this)&&((h=this._state.extraData)==null?void 0:h.hasAgentOnboarded)&&(u=this.chatHistory,u.filter(f=>oh(f))).length===2;var u;this._chatFlagModel.summaryTitles&&(i||s)&&this.updateConversationTitle()}).finally(()=>{var i;Ri(this)&&this._extensionClient.reportAgentRequestEvent({eventName:Kp.sentUserMessage,conversationId:this.id,requestId:((i=this.lastExchange)==null?void 0:i.request_id)??"UNKNOWN_REQUEST_ID",chatHistoryLength:this.chatHistory.length})}),this.focusModel.setFocusIdx(void 0),!0});m(this,"cancelMessage",async()=>{var t;this.canCancelMessage&&((t=this.lastExchange)!=null&&t.request_id)&&(this.updateExchangeById({status:Yt.cancelled},this.lastExchange.request_id),await this._extensionClient.cancelChatStream(this.lastExchange.request_id))});m(this,"sendInstructionExchange",async(t,r)=>{let i=`temp-fe-${crypto.randomUUID()}`;const s={status:Yt.sent,request_id:i,request_message:t,model_id:this.selectedModelId??void 0,structured_output_nodes:[],seen_state:xs.unseen,timestamp:new Date().toISOString()};this.addExchange(s);for await(const u of this._extensionClient.sendInstructionMessage(s,r)){if(!this.updateExchangeById(u,i,!0))return;i=u.request_id||i}});m(this,"updateConversationTitle",async()=>{const{responseText:t}=await this.sendSummaryExchange();this.update({name:t})});m(this,"sendSummaryExchange",()=>{const t={status:Yt.sent,request_message:"Please provide a clear and concise summary of our conversation so far. The summary must be less than 6 words long. The summary must contain the key points of the conversation. The summary must be in the form of a title which will represent the conversation. The response should not include any additional formatting such as wrapping the response with quotation marks.",model_id:this.selectedModelId??void 0,chatItemType:Cs.summaryTitle,disableRetrieval:!0};return this.sendSilentExchange(t)});m(this,"generateCommitMessage",async()=>{let t=`temp-fe-${crypto.randomUUID()}`;const r={status:Yt.sent,request_id:t,request_message:"Please generate a commit message based on the diff of my staged and unstaged changes.",model_id:this.selectedModelId??void 0,mentioned_items:[],seen_state:xs.unseen,chatItemType:Cs.generateCommitMessage,disableSelectedCodeDetails:!0,disableHistory:!0,timestamp:new Date().toISOString()};this.addExchange(r);for await(const i of this._extensionClient.generateCommitMessage()){if(!this.updateExchangeById(i,t,!0))return;t=i.request_id||t}});m(this,"sendExchange",async t=>{var u;this.updateLastInteraction();let r=`temp-fe-${crypto.randomUUID()}`,i=this._chatFlagModel.isModelIdValid(t.model_id)?t.model_id:void 0;t=await this._addIdeStateNode(ah(t));const s={status:Yt.sent,request_id:r,request_message:t.request_message,rich_text_json_repr:t.rich_text_json_repr,model_id:i,mentioned_items:t.mentioned_items,structured_output_nodes:t.structured_output_nodes,seen_state:xs.unseen,chatItemType:t.chatItemType,disableSelectedCodeDetails:t.disableSelectedCodeDetails,disableHistory:t.disableHistory,structured_request_nodes:t.structured_request_nodes,timestamp:new Date().toISOString()};this.addExchange(s),this._loadContextFromExchange(s),this._onSendExchangeListeners.forEach(c=>c(s));for await(const c of this.sendUserMessage(r,s)){if(((u=this.exchangeWithRequestId(r))==null?void 0:u.status)!==Yt.sent||!this.updateExchangeById(c,r,!0))return;r=c.request_id||r}});m(this,"sendSuggestedQuestion",t=>{this.sendExchange({request_message:t,status:Yt.draft}),this._extensionClient.triggerUsedChatMetric(),this._extensionClient.reportWebviewClientEvent(Au.chatUseSuggestedQuestion)});m(this,"recoverAllExchanges",async()=>{await Promise.all(this.recoverableExchanges.map(this.recoverExchange))});m(this,"recoverExchange",async t=>{var s;if(!t.request_id||t.status!==Yt.sent)return;let r=t.request_id;const i=(s=t.structured_output_nodes)==null?void 0:s.filter(u=>u.type===Ni.AGENT_MEMORY);this.updateExchangeById({...t,response_text:"",structured_output_nodes:i??[]},r);for await(const u of this.getChatStream(t)){if(!this.updateExchangeById(u,r,!0))return;r=u.request_id||r}});m(this,"_loadContextFromConversation",t=>{t.chatHistory.forEach(r=>{sr(r)&&this._loadContextFromExchange(r)})});m(this,"_loadContextFromExchange",t=>{t.mentioned_items&&(this._specialContextInputModel.updateItems(t.mentioned_items,[]),this._specialContextInputModel.markItemsActive(t.mentioned_items))});m(this,"_unloadContextFromConversation",t=>{t.chatHistory.forEach(r=>{sr(r)&&this._unloadContextFromExchange(r)})});m(this,"_unloadContextFromExchange",t=>{t.mentioned_items&&this._specialContextInputModel.updateItems([],t.mentioned_items)});m(this,"updateLastInteraction",()=>{this.update({lastInteractedAtIso:new Date().toISOString()})});m(this,"_jsonToStructuredRequest",t=>{const r=[],i=u=>{var h;const c=r.at(-1);if((c==null?void 0:c.type)===gn.TEXT){const f=((h=c.text_node)==null?void 0:h.content)??"",v={...c,text_node:{content:f+u}};r[r.length-1]=v}else r.push({id:r.length,type:gn.TEXT,text_node:{content:u}})},s=u=>{var c,h,f,v;if(u.type==="doc"||u.type==="paragraph")for(const _ of u.content??[])s(_);else if(u.type==="hardBreak")i(`
`);else if(u.type==="text")i(u.text??"");else if(u.type==="image"){if(typeof((c=u.attrs)==null?void 0:c.src)!="string")return void console.error("Image source is not a string: ",(h=u.attrs)==null?void 0:h.src);if(u.attrs.isLoading)return;const _=(f=u.attrs)==null?void 0:f.title,b=this._fileNameToImageFormat(_);r.push({id:r.length,type:gn.IMAGE_ID,image_id_node:{image_id:u.attrs.src,format:b}})}else if(u.type==="mention"){const _=(v=u.attrs)==null?void 0:v.data;_&&na(_)?r.push({id:r.length,type:gn.TEXT,text_node:{content:$g(this._chatFlagModel,_.personality.type)}}):i(`@${_==null?void 0:_.name}`)}};return s(t),r});this._extensionClient=t,this._chatFlagModel=r,this._specialContextInputModel=i,this._saveConversation=s,this._state={...et.create()},this._totalCharactersStore=this._createTotalCharactersStore()}_createTotalCharactersStore(){return xg(()=>{let t=0;const r=this._state.chatHistory;return this._convertHistoryToExchanges(r).forEach(i=>{t+=JSON.stringify(i).length}),this._state.draftExchange&&(t+=JSON.stringify(this._state.draftExchange).length),t},0,this._totalCharactersCacheThrottleMs)}async decidePersonaType(){var t;try{return(((t=(await this._extensionClient.getWorkspaceInfo()).trackedFileCount)==null?void 0:t.reduce((i,s)=>i+s,0))||0)<=4?Mt.PROTOTYPER:Mt.DEFAULT}catch(r){return console.error("Error determining persona type:",r),Mt.DEFAULT}}static create(t={}){const r=new Date().toISOString();return{id:crypto.randomUUID(),name:void 0,createdAtIso:r,lastInteractedAtIso:r,chatHistory:[],feedbackStates:{},toolUseStates:{},draftExchange:void 0,draftActiveContextIds:void 0,selectedModelId:void 0,requestIds:[],isPinned:!1,lastUrl:void 0,isShareable:!1,extraData:{},personaType:Mt.DEFAULT,...t}}static toSentenceCase(t){return t.charAt(0).toUpperCase()+t.slice(1)}static getDisplayName(t){var u,c;const r=this._filterToExchanges(t);let i;var s;return s=t,i=((u=s.extraData)==null?void 0:u.isAutofix)===!0?"Autofix Chat":Ri(t)?"New Agent":"New Chat",et.toSentenceCase(t.name||((c=r[0])==null?void 0:c.request_message)||i)}static _filterToExchanges(t){return t.chatHistory.filter(r=>sr(r))}static isEmpty(t){var r;return t.chatHistory.filter(i=>sr(i)).length===0&&!((r=t.draftExchange)!=null&&r.request_message)}static isNamed(t){return t.name!==void 0&&t.name!==""}static getTime(t,r){return r==="lastMessageTimestamp"?et.lastMessageTimestamp(t):r==="lastInteractedAt"?et.lastInteractedAt(t):et.createdAt(t)}static createdAt(t){return new Date(t.createdAtIso)}static lastInteractedAt(t){return new Date(t.lastInteractedAtIso)}static lastMessageTimestamp(t){const r=this._filterToExchanges(t);if(r.length===0)return this.createdAt(t);const i=r[r.length-1];return i.timestamp?new Date(i.timestamp):this.createdAt(t)}static isValid(t){return t.id!==void 0&&(!et.isEmpty(t)||et.isNamed(t))}onBeforeChangeConversation(t){return this._onBeforeChangeConversationListeners.push(t),()=>{this._onBeforeChangeConversationListeners=this._onBeforeChangeConversationListeners.filter(r=>r!==t)}}_notifyBeforeChangeConversation(t,r){let i=r;for(const s of this._onBeforeChangeConversationListeners){const u=s(t,i);u!==void 0&&(i=u)}return i}get extraData(){return this._state.extraData}set extraData(t){this.update({extraData:t})}get focusModel(){return this._focusModel}get isValid(){return et.isValid(this._state)}get id(){return this._state.id}get name(){return this._state.name}get personaType(){return this._state.personaType??Mt.DEFAULT}get displayName(){return et.getDisplayName(this._state)}get createdAtIso(){return this._state.createdAtIso}get createdAt(){return et.createdAt(this._state)}get chatHistory(){return this._state.chatHistory}get feedbackStates(){return this._state.feedbackStates}get toolUseStates(){return this._state.toolUseStates}get draftExchange(){return this._state.draftExchange}get selectedModelId(){return this._state.selectedModelId}get isPinned(){return!!this._state.isPinned}get extensionClient(){return this._extensionClient}addChatItem(t){this.addExchange(t)}get requestIds(){return this._state.chatHistory.map(t=>t.request_id).filter(t=>t!==void 0)}get hasDraft(){var i;const t=(((i=this.draftExchange)==null?void 0:i.request_message)??"").trim()!=="",r=this.hasImagesInDraft();return t||r}hasImagesInDraft(){var i;const t=(i=this.draftExchange)==null?void 0:i.rich_text_json_repr;if(!t)return!1;const r=s=>Array.isArray(s)?s.some(r):!!s&&(s.type==="image"||!(!s.content||!Array.isArray(s.content))&&s.content.some(r));return r(t)}get canSendDraft(){return this.hasDraft&&!this.awaitingReply}get canCancelMessage(){return this.awaitingReply}get firstExchange(){const t=et._filterToExchanges(this);return t.length===0?null:t[0]}get lastExchange(){const t=et._filterToExchanges(this);return t.length===0?null:t[t.length-1]}get canClearHistory(){return this._state.chatHistory.length!==0&&!this.awaitingReply}get recoverableExchanges(){return this._state.chatHistory.filter(t=>sr(t)&&t.status===Yt.sent)}get successfulMessages(){return this._state.chatHistory.filter(t=>Li(t)||Ms(t))}get totalCharactersStore(){return this._totalCharactersStore}_convertHistoryToExchanges(t){if(t.length===0)return[];const r=[];for(const i of t)if(Li(i))r.push(Sg(i));else if(Ms(i)&&i.fromTimestamp!==void 0&&i.toTimestamp!==void 0&&i.revertTarget){const s=Cg(i,1),u={request_message:"",response_text:"",request_id:i.request_id||crypto.randomUUID(),request_nodes:[s],response_nodes:[]};r.push(u)}return r}get awaitingReply(){return this.lastExchange!==null&&this.lastExchange.status===Yt.sent}get lastInteractedAtIso(){return this._state.lastInteractedAtIso}get draftActiveContextIds(){return this._state.draftActiveContextIds}async sendSilentExchange(t){const r=crypto.randomUUID();let i,s="";const u=await this._addIdeStateNode(ah({...t,request_id:r,status:Yt.sent,timestamp:new Date().toISOString()}));for await(const c of this.sendUserMessage(r,u))c.response_text&&(s+=c.response_text),c.request_id&&(i=c.request_id);return{responseText:s,requestId:i}}async*getChatStream(t){t.request_id&&(yield*this._extensionClient.getExistingChatStream(t,{flags:this._chatFlagModel}))}async*sendUserMessage(t,r){var v;const i=this._specialContextInputModel.chatActiveContext;let s=this.successfulMessages;if(r.chatItemType===Cs.summaryTitle){const _=s.findIndex(b=>b.chatItemType!==Cs.agentOnboarding&&oh(b));_!==-1&&(s=s.slice(_))}const u=r.disableHistory===!0?[]:s;let c=this._convertHistoryToExchanges(u);this._chatFlagModel.truncateChatHistory&&(c=this._truncatedChatHistory.getTruncatedChatHistory(c,()=>this._extensionClient.reportAgentSessionEvent({eventName:eg.chatHistoryTruncated,conversationId:this.id})));let h=this.personaType;if(r.structured_request_nodes){const _=r.structured_request_nodes.find(b=>b.type===gn.CHANGE_PERSONALITY);_&&_.change_personality_node&&(h=_.change_personality_node.personality_type)}const f={text:r.request_message,chatHistory:c,modelId:r.model_id,context:i,userSpecifiedFiles:i.userSpecifiedFiles,externalSourceIds:(v=i.externalSources)==null?void 0:v.map(_=>_.id),disableRetrieval:r.disableRetrieval??!1,disableSelectedCodeDetails:r.disableSelectedCodeDetails??!1,nodes:r.structured_request_nodes,memoriesInfo:r.memoriesInfo,personaType:h,conversationId:this.id};yield*this._extensionClient.startChatStreamWithRetry(t,f,{flags:this._chatFlagModel})}onSendExchange(t){return this._onSendExchangeListeners.push(t),()=>{this._onSendExchangeListeners=this._onSendExchangeListeners.filter(r=>r!==t)}}onNewConversation(t){return this._onNewConversationListeners.push(t),()=>{this._onNewConversationListeners=this._onNewConversationListeners.filter(r=>r!==t)}}onHistoryDelete(t){return this._onHistoryDeleteListeners.push(t),()=>{this._onHistoryDeleteListeners=this._onHistoryDeleteListeners.filter(r=>r!==t)}}updateChatItem(t,r){return this.chatHistory.find(i=>i.request_id===t)===null?(console.warn("No exchange with this request ID found."),!1):(this.update({chatHistory:this.chatHistory.map(i=>i.request_id===t?{...i,...r}:i)}),!0)}_fileNameToImageFormat(t){var i;switch((i=t.split(".").at(-1))==null?void 0:i.toLowerCase()){case"jpeg":case"jpg":return ws.JPEG;case"png":return ws.PNG;case"gif":return ws.GIF;case"webp":return ws.WEBP;default:return ws.IMAGE_FORMAT_UNSPECIFIED}}async _addIdeStateNode(t){let r=(t.structured_request_nodes??[]).filter(s=>s.type!==gn.IDE_STATE);const i=await this._extensionClient.getChatRequestIdeState();return i?(r=[...r,{id:Gh(r)+1,type:gn.IDE_STATE,ide_state_node:i}],{...t,structured_request_nodes:r}):t}}function Cg(o,t){const r=(Ms(o),o.fromTimestamp),i=(Ms(o),o.toTimestamp),s=Ms(o)&&o.revertTarget!==void 0;return{id:t,type:gn.CHECKPOINT_REF,checkpoint_ref_node:{request_id:o.request_id||"",from_timestamp:r,to_timestamp:i,source:s?tg.CHECKPOINT_REVERT:void 0}}}function Sg(o){const t=(o.structured_output_nodes??[]).filter(r=>r.type===Ni.RAW_RESPONSE||r.type===Ni.TOOL_USE);return{request_message:o.request_message,response_text:o.response_text??"",request_id:o.request_id||"",request_nodes:o.structured_request_nodes??[],response_nodes:t}}function Gh(o){return o.length>0?Math.max(...o.map(t=>t.id)):0}function ah(o){var t;if(o.request_message.length>0&&!((t=o.structured_request_nodes)!=null&&t.some(r=>r.type===gn.TEXT))){let r=o.structured_request_nodes??[];return r=[...r,{id:Gh(r)+1,type:gn.TEXT,text_node:{content:o.request_message}}],{...o,structured_request_nodes:r}}return o}class Ig{constructor(t,r,i){m(this,"_cachedTruncatedHistory",[]);m(this,"_cachedTruncatedChars",[]);m(this,"_cachedUntruncatedChars",new Map);this._maxHistoryChars=t,this._truncateToChars=r,this._avoidTruncationExchangeCount=i}getTruncatedChatHistory(t,r){const i=[];t.length<this._cachedTruncatedHistory.length&&(this._cachedTruncatedHistory.splice(t.length),this._cachedTruncatedChars.splice(t.length));for(let f=0;f<this._cachedTruncatedHistory.length;f++){const v=t[f],_=this._cachedTruncatedHistory[f];if(v.request_id!==_.request_id){this._cachedTruncatedHistory.splice(f),this._cachedTruncatedChars.splice(f);break}}const s=this._cachedTruncatedHistory.length;i.push(...this._cachedTruncatedHistory);let u=this._cachedTruncatedChars.reduce((f,v)=>f+v,0);const c=t.slice(s).map(f=>this._getUntruncatedChars(f)).reduce((f,v)=>f+v,0);if(u+c<this._maxHistoryChars)return i.push(...t.slice(s)),i;r==null||r();let h=u+c-this._truncateToChars;for(let f=s;f<t.length-this._avoidTruncationExchangeCount;f++){const v=this._truncateExchange(t[f]),_=JSON.stringify(v).length;if(this._cachedTruncatedHistory.push(v),this._cachedTruncatedChars.push(_),i.push(v),u+=_,h-=this._getUntruncatedChars(t[f])-_,h<=0)break}return i.push(...t.slice(i.length)),i}_truncateExchange(t){var u,c;const r=(u=t.request_nodes)==null?void 0:u.map(h=>h.type===gn.TOOL_RESULT?{...h,tool_result_node:{...h.tool_result_node,content:"[Tool result truncated...]"}}:h),i=(c=t.response_nodes)==null?void 0:c.map(h=>h.type===Ni.TOOL_USE?{...h,tool_use:h.tool_use&&this._truncateToolUse(h.tool_use)}:h),s={...t,request_nodes:r,response_nodes:i};return JSON.stringify(s).length>JSON.stringify(t).length?t:s}_truncateToolUse(t){let r;try{r=JSON.parse(t.input_json)}catch{return{...t,input_json:JSON.stringify({message:"[Tool use truncated...]"})}}for(const i of Object.keys(r))r[i].length>14&&(r[i]="[Truncated...]");return{...t,input_json:JSON.stringify(r)}}_getUntruncatedChars(t){if(this._cachedUntruncatedChars.has(t.request_id))return this._cachedUntruncatedChars.get(t.request_id);{const r=JSON.stringify(t).length;return this._cachedUntruncatedChars.set(t.request_id,r),r}}}class Eg{constructor(t=!0,r=setTimeout){m(this,"_notify",new Set);m(this,"_clearTimeout",t=>{t.timeoutId&&clearTimeout(t.timeoutId)});m(this,"_schedule",t=>{if(!this._started||t.date&&(t.timeout=t.date.getTime()-Date.now(),t.timeout<0))return;const r=this._setTimeout;t.timeoutId=r(this._handle,t.timeout,t)});m(this,"_handle",t=>{t.notify(),t.date?this._notify.delete(t):t.once||this._schedule(t)});m(this,"dispose",()=>{this._notify.forEach(this._clearTimeout),this._notify.clear()});this._started=t,this._setTimeout=r}start(){return this._started||(this._started=!0,this._notify.forEach(this._schedule)),this}stop(){return this._started=!1,this._notify.forEach(this._clearTimeout),this}get isStarted(){return this._started}set isStarted(t){t?this.start():this.stop()}once(t,r){return this._register(t,r,!0)}interval(t,r){return this._register(t,r,!1)}at(t,r){return this._register(0,r,!1,typeof t=="number"?new Date(Date.now()+t):t)}reschedule(){this._notify.forEach(t=>{this._clearTimeout(t),this._schedule(t)})}_register(t,r,i,s){if(!t&&!s)return()=>{};const u={timeout:t,notify:r,once:i,date:s};return this._notify.add(u),this._schedule(u),()=>{this._clearTimeout(u),this._notify.delete(u)}}}class Mg{constructor(t=0,r=0,i=new Eg,s=bt("busy"),u=bt(!1)){m(this,"unsubNotify");m(this,"unsubMessage");m(this,"activity",()=>{this.idleStatus.set("busy"),this.idleScheduler.reschedule()});m(this,"focus",t=>{this.focusAfterIdle.set(t)});this._idleNotifyTimeout=t,this._idleMessageTimeout=r,this.idleScheduler=i,this.idleStatus=s,this.focusAfterIdle=u,this.idleNotifyTimeout=t,this.idleMessageTimeout=r}set idleMessageTimeout(t){var r;this._idleMessageTimeout!==t&&(this._idleMessageTimeout=t,(r=this.unsubMessage)==null||r.call(this),this.unsubMessage=this.idleScheduler.once(t,()=>{this.idleStatus.set("idle-message")}))}set idleNotifyTimeout(t){var r;this._idleNotifyTimeout!==t&&(this._idleNotifyTimeout=t,(r=this.unsubNotify)==null||r.call(this),this.unsubNotify=this.idleScheduler.once(t,()=>{this.idleStatus.set("idle-notify")}))}get idleMessageTimeout(){return this._idleMessageTimeout}get idleNotifyTimeout(){return this._idleNotifyTimeout}get notifyEnabled(){return this._idleNotifyTimeout>0}get messageEnabled(){return this._idleMessageTimeout>0}dispose(){var t,r;(t=this.unsubNotify)==null||t.call(this),(r=this.unsubMessage)==null||r.call(this),this.idleScheduler.dispose(),this.idleStatus.set("busy"),this.focusAfterIdle.set(!1)}}const Po=bt("idle");class Zh{constructor(t,r,i,s={}){m(this,"_state",{currentConversationId:void 0,conversations:{},agentExecutionMode:"manual",isAgentEditsCollapsed:!0});m(this,"extensionClient");m(this,"_chatFlagsModel");m(this,"_currConversationModel");m(this,"subscribers",new Set);m(this,"idleMessageModel",new Mg);m(this,"isAgentEditsCollapsed");m(this,"agentExecutionMode");m(this,"sortConversationsBy");m(this,"onLoaded",async()=>{var r,i;const t=await this.extensionClient.getChatInitData();this._chatFlagsModel.update({enableEditableHistory:t.enableEditableHistory??!1,enablePreferenceCollection:t.enablePreferenceCollection??!1,enableRetrievalDataCollection:t.enableRetrievalDataCollection??!1,enableDebugFeatures:t.enableDebugFeatures??!1,enableRichTextHistory:t.useRichTextHistory??!0,modelDisplayNameToId:t.modelDisplayNameToId??{},fullFeatured:t.fullFeatured??!0,smallSyncThreshold:t.smallSyncThreshold??Fp,bigSyncThreshold:t.bigSyncThreshold??Op,enableExternalSourcesInChat:t.enableExternalSourcesInChat??!1,enableSmartPaste:t.enableSmartPaste??!1,enableDirectApply:t.enableDirectApply??!1,summaryTitles:t.summaryTitles??!1,suggestedEditsAvailable:t.suggestedEditsAvailable??!1,enableShareService:t.enableShareService??!1,maxTrackableFileCount:t.maxTrackableFileCount??Lp,enableDesignSystemRichTextEditor:t.enableDesignSystemRichTextEditor??!1,enableSources:t.enableSources??!1,enableChatMermaidDiagrams:t.enableChatMermaidDiagrams??!1,smartPastePrecomputeMode:t.smartPastePrecomputeMode??Ep.visibleHover,useNewThreadsMenu:t.useNewThreadsMenu??!1,enableChatMermaidDiagramsMinVersion:t.enableChatMermaidDiagramsMinVersion??!1,idleNewSessionMessageTimeoutMs:t.idleNewSessionMessageTimeoutMs,idleNewSessionNotificationTimeoutMs:t.idleNewSessionNotificationTimeoutMs,enableChatMultimodal:t.enableChatMultimodal??!1,enableAgentMode:t.enableAgentMode??!1,agentMemoriesFilePathName:t.agentMemoriesFilePathName,enableRichCheckpointInfo:t.enableRichCheckpointInfo??!1,userTier:t.userTier??"unknown",truncateChatHistory:t.truncateChatHistory??!1,enableBackgroundAgents:t.enableBackgroundAgents??!1,enableVirtualizedMessageList:t.enableVirtualizedMessageList??!1,customPersonalityPrompts:t.customPersonalityPrompts??{},enablePersonalities:t.enablePersonalities??!1,memoryClassificationOnFirstToken:t.memoryClassificationOnFirstToken??!1}),(i=(r=this.options).onLoaded)==null||i.call(r),this.notifySubscribers()});m(this,"subscribe",t=>(this.subscribers.add(t),t(this),()=>{this.subscribers.delete(t)}));m(this,"initialize",t=>{this._state={...this._state,...this._host.getState()},t&&(this._state.conversations[t==null?void 0:t.id]=t),this._chatFlagsModel.fullFeatured&&((t==null?void 0:t.id)!==bu&&this.currentConversationId!==bu||(delete this._state.conversations[bu],this.setCurrentConversationToWelcome())),this._chatFlagsModel.subscribe(r=>{this.idleMessageModel.idleNotifyTimeout=r.idleNewSessionNotificationTimeoutMs,this.idleMessageModel.idleMessageTimeout=r.idleNewSessionMessageTimeoutMs}),this._state.conversations=Object.fromEntries(Object.entries(this._state.conversations).filter(([r,i])=>et.isValid(i))),this.initializeIsShareableState(),t?this.setCurrentConversation(t.id):this.setCurrentConversation(this.currentConversationId),this.subscribe(()=>this.idleMessageModel.activity()),this.setState(this._state)});m(this,"initializeIsShareableState",()=>{const t={...this._state.conversations};for(const[r,i]of Object.entries(t)){if(i.isShareable)continue;const s=i.chatHistory.some(u=>Li(u));t[r]={...i,isShareable:s}}this._state.conversations=t});m(this,"updateChatState",t=>{this._state={...this._state,...t};const r=this._state.conversations,i=new Set;for(const[s,u]of Object.entries(r))u.isPinned&&i.add(s);this.setState(this._state),this.notifySubscribers()});m(this,"saveImmediate",()=>{this._host.setState(this._state)});m(this,"setState",Fu(t=>{this._host.setState({...t,isAgentEditsCollapsed:pt(this.isAgentEditsCollapsed),agentExecutionMode:pt(this.agentExecutionMode),sortConversationsBy:pt(this.sortConversationsBy)})},1e3,{maxWait:15e3}));m(this,"notifySubscribers",()=>{this.subscribers.forEach(t=>t(this))});m(this,"withWebviewClientEvent",(t,r)=>(...i)=>(this.extensionClient.reportWebviewClientEvent(t),r(...i)));m(this,"setCurrentConversationToWelcome",()=>{this.setCurrentConversation(),this._currConversationModel.setName("Welcome to Augment"),this._currConversationModel.addChatItem({chatItemType:Cs.educateFeatures,request_id:crypto.randomUUID(),seen_state:xs.seen})});m(this,"popCurrentConversation",async()=>{var r,i;const t=this.currentConversationId;t&&await this.deleteConversation(t,((r=this.nextConversation)==null?void 0:r.id)??((i=this.previousConversation)==null?void 0:i.id))});m(this,"setCurrentConversation",async(t,r=!0)=>{let i;t===void 0?(this.deleteInvalidConversations(Ri(this._currConversationModel)?"agent":"chat"),i=et.create({personaType:await this._currConversationModel.decidePersonaType()})):i=this._state.conversations[t]??et.create({personaType:await this._currConversationModel.decidePersonaType()});const s=this.conversations[this._currConversationModel.id]===void 0;this._currConversationModel.setConversation(i,!s,r),this._currConversationModel.recoverAllExchanges(),this._currConversationModel.resetTotalCharactersCache()});m(this,"saveConversation",t=>{this.updateChatState({conversations:{...this._state.conversations,[t.id]:t},currentConversationId:t.id})});m(this,"isConversationShareable",t=>{var r;return((r=this._state.conversations[t])==null?void 0:r.isShareable)??!0});m(this,"setSortConversationsBy",t=>{this.sortConversationsBy.set(t),this.updateChatState({})});m(this,"getConversationUrl",async t=>{const r=this._state.conversations[t];if(r.lastUrl)return r.lastUrl;Po.set("copying");const i=r==null?void 0:r.chatHistory,s=i.reduce((h,f)=>(Li(f)&&h.push({request_id:f.request_id||"",request_message:f.request_message,response_text:f.response_text||""}),h),[]);if(s.length===0)throw new Error("No chat history to share");const u=et.getDisplayName(r),c=await this.extensionClient.saveChat(t,s,u);if(c.data){let h=c.data.url;return this.updateChatState({conversations:{...this._state.conversations,[t]:{...r,lastUrl:h}}}),h}throw new Error("Failed to create URL")});m(this,"shareConversation",async t=>{if(t!==void 0)try{const r=await this.getConversationUrl(t);if(!r)return void Po.set("idle");navigator.clipboard.writeText(r),Po.set("copied")}catch{Po.set("failed")}});m(this,"deleteConversations",async(t,r=void 0)=>{if(await this.extensionClient.openConfirmationModal({title:"Delete Conversation",message:`Are you sure you want to delete ${t.length>1?"these conversations":"this conversation"}?`,confirmButtonText:"Delete",cancelButtonText:"Cancel"})){const i=new Set(t);this.deleteConversationIds(i),this.currentConversationId&&i.has(this.currentConversationId)&&this.setCurrentConversation(r)}});m(this,"deleteConversation",async(t,r=void 0)=>{await this.deleteConversations([t],r)});m(this,"deleteConversationIds",async t=>{var i;const r=[];for(const s of t){const u=((i=this._state.conversations[s])==null?void 0:i.requestIds)??[];r.push(...u)}for(const s of Object.values(this._state.conversations))if(t.has(s.id)){for(const c of s.chatHistory)sr(c)&&this.deleteImagesInExchange(c);const u=s.draftExchange;u&&this.deleteImagesInExchange(u)}this.updateChatState({conversations:Object.fromEntries(Object.entries(this._state.conversations).filter(([s])=>!t.has(s)))}),this.extensionClient.clearMetadataFor({requestIds:r,conversationIds:Array.from(t)})});m(this,"deleteImagesInExchange",t=>{const r=new Set([...t.rich_text_json_repr?this.findImagesInJson(t.rich_text_json_repr):[],...t.structured_request_nodes?this.findImagesInStructuredRequest(t.structured_request_nodes):[]]);for(const i of r)this.deleteImage(i)});m(this,"findImagesInJson",t=>{const r=[],i=s=>{var u;if(s.type==="image"&&((u=s.attrs)!=null&&u.src))r.push(s.attrs.src);else if((s.type==="doc"||s.type==="paragraph")&&s.content)for(const c of s.content)i(c)};return i(t),r});m(this,"findImagesInStructuredRequest",t=>t.reduce((r,i)=>(i.type===gn.IMAGE_ID&&i.image_id_node&&r.push(i.image_id_node.image_id),r),[]));m(this,"toggleConversationPinned",t=>{const r=this._state.conversations[t],i={...r,isPinned:!r.isPinned};this.updateChatState({conversations:{...this._state.conversations,[t]:i}}),t===this.currentConversationId&&this._currConversationModel.toggleIsPinned()});m(this,"renameConversation",(t,r)=>{const i={...this._state.conversations[t],name:r};this.updateChatState({conversations:{...this._state.conversations,[t]:i}}),t===this.currentConversationId&&this._currConversationModel.setName(r)});m(this,"smartPaste",(t,r,i,s)=>{const u=this._currConversationModel.historyTo(t,!0).filter(c=>Li(c)).map(c=>({request_message:c.request_message,response_text:c.response_text||"",request_id:c.request_id||""}));this.extensionClient.smartPaste({generatedCode:r,chatHistory:u,targetFile:i??void 0,options:s})});m(this,"saveImage",async t=>await this.extensionClient.saveImage(t));m(this,"deleteImage",async t=>await this.extensionClient.deleteImage(t));m(this,"renderImage",async t=>await this.extensionClient.loadImage(t));this._asyncMsgSender=t,this._host=r,this._specialContextInputModel=i,this.options=s,this._chatFlagsModel=new Ap(s.initialFlags),this.extensionClient=new Tp(this._host,this._asyncMsgSender,this._chatFlagsModel),this._currConversationModel=new et(this.extensionClient,this._chatFlagsModel,this._specialContextInputModel,this.saveConversation),this.initialize(s.initialConversation),this.isAgentEditsCollapsed=bt(this._state.isAgentEditsCollapsed),this.agentExecutionMode=bt(this._state.agentExecutionMode??"manual"),this.sortConversationsBy=bt(this._state.sortConversationsBy??"lastMessageTimestamp"),this.onLoaded()}get flags(){return this._chatFlagsModel}get specialContextInputModel(){return this._specialContextInputModel}get currentConversationId(){return this._state.currentConversationId}get currentConversationModel(){return this._currConversationModel}get conversations(){return this._state.conversations}orderedConversations(t,r="desc",i){const s=t||this._state.sortConversationsBy||"lastMessageTimestamp";let u=Object.values(this._state.conversations);return i&&(u=u.filter(i)),u.sort((c,h)=>{const f=et.getTime(c,s).getTime(),v=et.getTime(h,s).getTime();return r==="asc"?f-v:v-f})}get nextConversation(){if(!this.currentConversationId)return;const t=this.orderedConversations(),r=t.findIndex(i=>i.id===this.currentConversationId);return t.length>r+1?t[r+1]:void 0}get previousConversation(){if(!this.currentConversationId)return;const t=this.orderedConversations(),r=t.findIndex(i=>i.id===this.currentConversationId);return r>0?t[r-1]:void 0}get host(){return this._host}deleteInvalidConversations(t="all"){const r=Object.keys(this.conversations).filter(i=>{const s=!et.isValid(this.conversations[i]),u=Ri(this.conversations[i]);return s&&(t==="agent"&&u||t==="chat"&&!u||t==="all")});r.length&&this.deleteConversationIds(new Set(r))}get lastMessageTimestamp(){const t=this.currentConversationModel.lastExchange;return t==null?void 0:t.timestamp}handleMessageFromExtension(t){return t.data.type===it.newThread&&(this.setCurrentConversation(),!0)}}function uh(o,t){let r,i,s=t;const u=()=>s.editor.getModifiedEditor(),c=()=>{const{afterLineNumber:h}=s,f=u();if(h===void 0)return void f.changeViewZones(_=>{r&&f&&i&&_.removeZone(i)});const v={...s,afterLineNumber:h,domNode:o,suppressMouseDown:!0};f==null||f.changeViewZones(_=>{r&&i&&_.removeZone(i),i=_.addZone(v),r=v})};return c(),{update:h=>{s=h,c()},destroy:()=>{const h=u();h.changeViewZones(f=>{if(r&&h&&i)try{f.removeZone(i)}catch(v){if(v instanceof Error){if(v.message.includes("Cannot read properties of null (reading 'removeChild')"))return}else console.warn(`Failed to remove view zone: ${v}`)}})}}}var Dr=(o=>(o.edit="edit",o.instruction="instruction",o))(Dr||{}),Lu=(o=>(o[o.instructionDrawer=0]="instructionDrawer",o[o.chunkActionPanel=1]="chunkActionPanel",o))(Lu||{});const Ai=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,ch=new Set,Nu=typeof process=="object"&&process?process:{},Yh=(o,t,r,i)=>{typeof Nu.emitWarning=="function"?Nu.emitWarning(o,t,r,i):console.error(`[${r}] ${t}: ${o}`)};let ea=globalThis.AbortController,lh=globalThis.AbortSignal;var Fh;if(ea===void 0){lh=class{constructor(){m(this,"onabort");m(this,"_onabort",[]);m(this,"reason");m(this,"aborted",!1)}addEventListener(r,i){this._onabort.push(i)}},ea=class{constructor(){m(this,"signal",new lh);t()}abort(r){var i,s;if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(const u of this.signal._onabort)u(r);(s=(i=this.signal).onabort)==null||s.call(i,r)}}};let o=((Fh=Nu.env)==null?void 0:Fh.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const t=()=>{o&&(o=!1,Yh("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const kr=o=>o&&o===Math.floor(o)&&o>0&&isFinite(o),Jh=o=>kr(o)?o<=Math.pow(2,8)?Uint8Array:o<=Math.pow(2,16)?Uint16Array:o<=Math.pow(2,32)?Uint32Array:o<=Number.MAX_SAFE_INTEGER?Vo:null:null;class Vo extends Array{constructor(t){super(t),this.fill(0)}}var ji;const ni=class ni{constructor(t,r){m(this,"heap");m(this,"length");if(!y(ni,ji))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(t),this.length=0}static create(t){const r=Jh(t);if(!r)return[];ue(ni,ji,!0);const i=new ni(t,r);return ue(ni,ji,!1),i}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}};ji=new WeakMap,ke(ni,ji,!1);let Ru=ni;var Oh,Lh,xn,Jt,Cn,Sn,Di,Ui,dt,In,ot,Ye,be,jt,Qt,Ot,mt,En,vt,Mn,kn,Xt,An,Nr,Dt,H,Du,ri,or,As,Kt,Qh,ii,qi,Ts,Ar,Tr,Uu,Go,Zo,Ze,qu,Is,Fr,zu;const tc=class tc{constructor(t){ke(this,H);ke(this,xn);ke(this,Jt);ke(this,Cn);ke(this,Sn);ke(this,Di);ke(this,Ui);m(this,"ttl");m(this,"ttlResolution");m(this,"ttlAutopurge");m(this,"updateAgeOnGet");m(this,"updateAgeOnHas");m(this,"allowStale");m(this,"noDisposeOnSet");m(this,"noUpdateTTL");m(this,"maxEntrySize");m(this,"sizeCalculation");m(this,"noDeleteOnFetchRejection");m(this,"noDeleteOnStaleGet");m(this,"allowStaleOnFetchAbort");m(this,"allowStaleOnFetchRejection");m(this,"ignoreFetchAbort");ke(this,dt);ke(this,In);ke(this,ot);ke(this,Ye);ke(this,be);ke(this,jt);ke(this,Qt);ke(this,Ot);ke(this,mt);ke(this,En);ke(this,vt);ke(this,Mn);ke(this,kn);ke(this,Xt);ke(this,An);ke(this,Nr);ke(this,Dt);ke(this,ri,()=>{});ke(this,or,()=>{});ke(this,As,()=>{});ke(this,Kt,()=>!1);ke(this,ii,t=>{});ke(this,qi,(t,r,i)=>{});ke(this,Ts,(t,r,i,s)=>{if(i||s)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});m(this,Oh,"LRUCache");const{max:r=0,ttl:i,ttlResolution:s=1,ttlAutopurge:u,updateAgeOnGet:c,updateAgeOnHas:h,allowStale:f,dispose:v,disposeAfter:_,noDisposeOnSet:b,noUpdateTTL:x,maxSize:E=0,maxEntrySize:T=0,sizeCalculation:q,fetchMethod:L,memoMethod:S,noDeleteOnFetchRejection:F,noDeleteOnStaleGet:ne,allowStaleOnFetchRejection:de,allowStaleOnFetchAbort:oe,ignoreFetchAbort:Re}=t;if(r!==0&&!kr(r))throw new TypeError("max option must be a nonnegative integer");const pe=r?Jh(r):Array;if(!pe)throw new Error("invalid max value: "+r);if(ue(this,xn,r),ue(this,Jt,E),this.maxEntrySize=T||y(this,Jt),this.sizeCalculation=q,this.sizeCalculation){if(!y(this,Jt)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(S!==void 0&&typeof S!="function")throw new TypeError("memoMethod must be a function if defined");if(ue(this,Ui,S),L!==void 0&&typeof L!="function")throw new TypeError("fetchMethod must be a function if specified");if(ue(this,Di,L),ue(this,Nr,!!L),ue(this,ot,new Map),ue(this,Ye,new Array(r).fill(void 0)),ue(this,be,new Array(r).fill(void 0)),ue(this,jt,new pe(r)),ue(this,Qt,new pe(r)),ue(this,Ot,0),ue(this,mt,0),ue(this,En,Ru.create(r)),ue(this,dt,0),ue(this,In,0),typeof v=="function"&&ue(this,Cn,v),typeof _=="function"?(ue(this,Sn,_),ue(this,vt,[])):(ue(this,Sn,void 0),ue(this,vt,void 0)),ue(this,An,!!y(this,Cn)),ue(this,Dt,!!y(this,Sn)),this.noDisposeOnSet=!!b,this.noUpdateTTL=!!x,this.noDeleteOnFetchRejection=!!F,this.allowStaleOnFetchRejection=!!de,this.allowStaleOnFetchAbort=!!oe,this.ignoreFetchAbort=!!Re,this.maxEntrySize!==0){if(y(this,Jt)!==0&&!kr(y(this,Jt)))throw new TypeError("maxSize must be a positive integer if specified");if(!kr(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");J(this,H,Qh).call(this)}if(this.allowStale=!!f,this.noDeleteOnStaleGet=!!ne,this.updateAgeOnGet=!!c,this.updateAgeOnHas=!!h,this.ttlResolution=kr(s)||s===0?s:1,this.ttlAutopurge=!!u,this.ttl=i||0,this.ttl){if(!kr(this.ttl))throw new TypeError("ttl must be a positive integer if specified");J(this,H,Du).call(this)}if(y(this,xn)===0&&this.ttl===0&&y(this,Jt)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!y(this,xn)&&!y(this,Jt)){const Ie="LRU_CACHE_UNBOUNDED";(_e=>!ch.has(_e))(Ie)&&(ch.add(Ie),Yh("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Ie,tc))}}static unsafeExposeInternals(t){return{starts:y(t,kn),ttls:y(t,Xt),sizes:y(t,Mn),keyMap:y(t,ot),keyList:y(t,Ye),valList:y(t,be),next:y(t,jt),prev:y(t,Qt),get head(){return y(t,Ot)},get tail(){return y(t,mt)},free:y(t,En),isBackgroundFetch:r=>{var i;return J(i=t,H,Ze).call(i,r)},backgroundFetch:(r,i,s,u)=>{var c;return J(c=t,H,Zo).call(c,r,i,s,u)},moveToTail:r=>{var i;return J(i=t,H,Is).call(i,r)},indexes:r=>{var i;return J(i=t,H,Ar).call(i,r)},rindexes:r=>{var i;return J(i=t,H,Tr).call(i,r)},isStale:r=>{var i;return y(i=t,Kt).call(i,r)}}}get max(){return y(this,xn)}get maxSize(){return y(this,Jt)}get calculatedSize(){return y(this,In)}get size(){return y(this,dt)}get fetchMethod(){return y(this,Di)}get memoMethod(){return y(this,Ui)}get dispose(){return y(this,Cn)}get disposeAfter(){return y(this,Sn)}getRemainingTTL(t){return y(this,ot).has(t)?1/0:0}*entries(){for(const t of J(this,H,Ar).call(this))y(this,be)[t]===void 0||y(this,Ye)[t]===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield[y(this,Ye)[t],y(this,be)[t]])}*rentries(){for(const t of J(this,H,Tr).call(this))y(this,be)[t]===void 0||y(this,Ye)[t]===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield[y(this,Ye)[t],y(this,be)[t]])}*keys(){for(const t of J(this,H,Ar).call(this)){const r=y(this,Ye)[t];r===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield r)}}*rkeys(){for(const t of J(this,H,Tr).call(this)){const r=y(this,Ye)[t];r===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield r)}}*values(){for(const t of J(this,H,Ar).call(this))y(this,be)[t]===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield y(this,be)[t])}*rvalues(){for(const t of J(this,H,Tr).call(this))y(this,be)[t]===void 0||J(this,H,Ze).call(this,y(this,be)[t])||(yield y(this,be)[t])}[(Lh=Symbol.iterator,Oh=Symbol.toStringTag,Lh)](){return this.entries()}find(t,r={}){for(const i of J(this,H,Ar).call(this)){const s=y(this,be)[i],u=J(this,H,Ze).call(this,s)?s.__staleWhileFetching:s;if(u!==void 0&&t(u,y(this,Ye)[i],this))return this.get(y(this,Ye)[i],r)}}forEach(t,r=this){for(const i of J(this,H,Ar).call(this)){const s=y(this,be)[i],u=J(this,H,Ze).call(this,s)?s.__staleWhileFetching:s;u!==void 0&&t.call(r,u,y(this,Ye)[i],this)}}rforEach(t,r=this){for(const i of J(this,H,Tr).call(this)){const s=y(this,be)[i],u=J(this,H,Ze).call(this,s)?s.__staleWhileFetching:s;u!==void 0&&t.call(r,u,y(this,Ye)[i],this)}}purgeStale(){let t=!1;for(const r of J(this,H,Tr).call(this,{allowStale:!0}))y(this,Kt).call(this,r)&&(J(this,H,Fr).call(this,y(this,Ye)[r],"expire"),t=!0);return t}info(t){const r=y(this,ot).get(t);if(r===void 0)return;const i=y(this,be)[r],s=J(this,H,Ze).call(this,i)?i.__staleWhileFetching:i;if(s===void 0)return;const u={value:s};if(y(this,Xt)&&y(this,kn)){const c=y(this,Xt)[r],h=y(this,kn)[r];if(c&&h){const f=c-(Ai.now()-h);u.ttl=f,u.start=Date.now()}}return y(this,Mn)&&(u.size=y(this,Mn)[r]),u}dump(){const t=[];for(const r of J(this,H,Ar).call(this,{allowStale:!0})){const i=y(this,Ye)[r],s=y(this,be)[r],u=J(this,H,Ze).call(this,s)?s.__staleWhileFetching:s;if(u===void 0||i===void 0)continue;const c={value:u};if(y(this,Xt)&&y(this,kn)){c.ttl=y(this,Xt)[r];const h=Ai.now()-y(this,kn)[r];c.start=Math.floor(Date.now()-h)}y(this,Mn)&&(c.size=y(this,Mn)[r]),t.unshift([i,c])}return t}load(t){this.clear();for(const[r,i]of t){if(i.start){const s=Date.now()-i.start;i.start=Ai.now()-s}this.set(r,i.value,i)}}set(t,r,i={}){var x,E,T,q,L;if(r===void 0)return this.delete(t),this;const{ttl:s=this.ttl,start:u,noDisposeOnSet:c=this.noDisposeOnSet,sizeCalculation:h=this.sizeCalculation,status:f}=i;let{noUpdateTTL:v=this.noUpdateTTL}=i;const _=y(this,Ts).call(this,t,r,i.size||0,h);if(this.maxEntrySize&&_>this.maxEntrySize)return f&&(f.set="miss",f.maxEntrySizeExceeded=!0),J(this,H,Fr).call(this,t,"set"),this;let b=y(this,dt)===0?void 0:y(this,ot).get(t);if(b===void 0)b=y(this,dt)===0?y(this,mt):y(this,En).length!==0?y(this,En).pop():y(this,dt)===y(this,xn)?J(this,H,Go).call(this,!1):y(this,dt),y(this,Ye)[b]=t,y(this,be)[b]=r,y(this,ot).set(t,b),y(this,jt)[y(this,mt)]=b,y(this,Qt)[b]=y(this,mt),ue(this,mt,b),zo(this,dt)._++,y(this,qi).call(this,b,_,f),f&&(f.set="add"),v=!1;else{J(this,H,Is).call(this,b);const S=y(this,be)[b];if(r!==S){if(y(this,Nr)&&J(this,H,Ze).call(this,S)){S.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:F}=S;F===void 0||c||(y(this,An)&&((x=y(this,Cn))==null||x.call(this,F,t,"set")),y(this,Dt)&&((E=y(this,vt))==null||E.push([F,t,"set"])))}else c||(y(this,An)&&((T=y(this,Cn))==null||T.call(this,S,t,"set")),y(this,Dt)&&((q=y(this,vt))==null||q.push([S,t,"set"])));if(y(this,ii).call(this,b),y(this,qi).call(this,b,_,f),y(this,be)[b]=r,f){f.set="replace";const F=S&&J(this,H,Ze).call(this,S)?S.__staleWhileFetching:S;F!==void 0&&(f.oldValue=F)}}else f&&(f.set="update")}if(s===0||y(this,Xt)||J(this,H,Du).call(this),y(this,Xt)&&(v||y(this,As).call(this,b,s,u),f&&y(this,or).call(this,f,b)),!c&&y(this,Dt)&&y(this,vt)){const S=y(this,vt);let F;for(;F=S==null?void 0:S.shift();)(L=y(this,Sn))==null||L.call(this,...F)}return this}pop(){var t;try{for(;y(this,dt);){const r=y(this,be)[y(this,Ot)];if(J(this,H,Go).call(this,!0),J(this,H,Ze).call(this,r)){if(r.__staleWhileFetching)return r.__staleWhileFetching}else if(r!==void 0)return r}}finally{if(y(this,Dt)&&y(this,vt)){const r=y(this,vt);let i;for(;i=r==null?void 0:r.shift();)(t=y(this,Sn))==null||t.call(this,...i)}}}has(t,r={}){const{updateAgeOnHas:i=this.updateAgeOnHas,status:s}=r,u=y(this,ot).get(t);if(u!==void 0){const c=y(this,be)[u];if(J(this,H,Ze).call(this,c)&&c.__staleWhileFetching===void 0)return!1;if(!y(this,Kt).call(this,u))return i&&y(this,ri).call(this,u),s&&(s.has="hit",y(this,or).call(this,s,u)),!0;s&&(s.has="stale",y(this,or).call(this,s,u))}else s&&(s.has="miss");return!1}peek(t,r={}){const{allowStale:i=this.allowStale}=r,s=y(this,ot).get(t);if(s===void 0||!i&&y(this,Kt).call(this,s))return;const u=y(this,be)[s];return J(this,H,Ze).call(this,u)?u.__staleWhileFetching:u}async fetch(t,r={}){const{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:u=this.noDeleteOnStaleGet,ttl:c=this.ttl,noDisposeOnSet:h=this.noDisposeOnSet,size:f=0,sizeCalculation:v=this.sizeCalculation,noUpdateTTL:_=this.noUpdateTTL,noDeleteOnFetchRejection:b=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:x=this.allowStaleOnFetchRejection,ignoreFetchAbort:E=this.ignoreFetchAbort,allowStaleOnFetchAbort:T=this.allowStaleOnFetchAbort,context:q,forceRefresh:L=!1,status:S,signal:F}=r;if(!y(this,Nr))return S&&(S.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:u,status:S});const ne={allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:u,ttl:c,noDisposeOnSet:h,size:f,sizeCalculation:v,noUpdateTTL:_,noDeleteOnFetchRejection:b,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:T,ignoreFetchAbort:E,status:S,signal:F};let de=y(this,ot).get(t);if(de===void 0){S&&(S.fetch="miss");const oe=J(this,H,Zo).call(this,t,de,ne,q);return oe.__returned=oe}{const oe=y(this,be)[de];if(J(this,H,Ze).call(this,oe)){const _e=i&&oe.__staleWhileFetching!==void 0;return S&&(S.fetch="inflight",_e&&(S.returnedStale=!0)),_e?oe.__staleWhileFetching:oe.__returned=oe}const Re=y(this,Kt).call(this,de);if(!L&&!Re)return S&&(S.fetch="hit"),J(this,H,Is).call(this,de),s&&y(this,ri).call(this,de),S&&y(this,or).call(this,S,de),oe;const pe=J(this,H,Zo).call(this,t,de,ne,q),Ie=pe.__staleWhileFetching!==void 0&&i;return S&&(S.fetch=Re?"stale":"refresh",Ie&&Re&&(S.returnedStale=!0)),Ie?pe.__staleWhileFetching:pe.__returned=pe}}async forceFetch(t,r={}){const i=await this.fetch(t,r);if(i===void 0)throw new Error("fetch() returned undefined");return i}memo(t,r={}){const i=y(this,Ui);if(!i)throw new Error("no memoMethod provided to constructor");const{context:s,forceRefresh:u,...c}=r,h=this.get(t,c);if(!u&&h!==void 0)return h;const f=i(t,h,{options:c,context:s});return this.set(t,f,c),f}get(t,r={}){const{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:u=this.noDeleteOnStaleGet,status:c}=r,h=y(this,ot).get(t);if(h!==void 0){const f=y(this,be)[h],v=J(this,H,Ze).call(this,f);return c&&y(this,or).call(this,c,h),y(this,Kt).call(this,h)?(c&&(c.get="stale"),v?(c&&i&&f.__staleWhileFetching!==void 0&&(c.returnedStale=!0),i?f.__staleWhileFetching:void 0):(u||J(this,H,Fr).call(this,t,"expire"),c&&i&&(c.returnedStale=!0),i?f:void 0)):(c&&(c.get="hit"),v?f.__staleWhileFetching:(J(this,H,Is).call(this,h),s&&y(this,ri).call(this,h),f))}c&&(c.get="miss")}delete(t){return J(this,H,Fr).call(this,t,"delete")}clear(){return J(this,H,zu).call(this,"delete")}};xn=new WeakMap,Jt=new WeakMap,Cn=new WeakMap,Sn=new WeakMap,Di=new WeakMap,Ui=new WeakMap,dt=new WeakMap,In=new WeakMap,ot=new WeakMap,Ye=new WeakMap,be=new WeakMap,jt=new WeakMap,Qt=new WeakMap,Ot=new WeakMap,mt=new WeakMap,En=new WeakMap,vt=new WeakMap,Mn=new WeakMap,kn=new WeakMap,Xt=new WeakMap,An=new WeakMap,Nr=new WeakMap,Dt=new WeakMap,H=new WeakSet,Du=function(){const t=new Vo(y(this,xn)),r=new Vo(y(this,xn));ue(this,Xt,t),ue(this,kn,r),ue(this,As,(u,c,h=Ai.now())=>{if(r[u]=c!==0?h:0,t[u]=c,c!==0&&this.ttlAutopurge){const f=setTimeout(()=>{y(this,Kt).call(this,u)&&J(this,H,Fr).call(this,y(this,Ye)[u],"expire")},c+1);f.unref&&f.unref()}}),ue(this,ri,u=>{r[u]=t[u]!==0?Ai.now():0}),ue(this,or,(u,c)=>{if(t[c]){const h=t[c],f=r[c];if(!h||!f)return;u.ttl=h,u.start=f,u.now=i||s();const v=u.now-f;u.remainingTTL=h-v}});let i=0;const s=()=>{const u=Ai.now();if(this.ttlResolution>0){i=u;const c=setTimeout(()=>i=0,this.ttlResolution);c.unref&&c.unref()}return u};this.getRemainingTTL=u=>{const c=y(this,ot).get(u);if(c===void 0)return 0;const h=t[c],f=r[c];return!h||!f?1/0:h-((i||s())-f)},ue(this,Kt,u=>{const c=r[u],h=t[u];return!!h&&!!c&&(i||s())-c>h})},ri=new WeakMap,or=new WeakMap,As=new WeakMap,Kt=new WeakMap,Qh=function(){const t=new Vo(y(this,xn));ue(this,In,0),ue(this,Mn,t),ue(this,ii,r=>{ue(this,In,y(this,In)-t[r]),t[r]=0}),ue(this,Ts,(r,i,s,u)=>{if(J(this,H,Ze).call(this,i))return 0;if(!kr(s)){if(!u)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if(typeof u!="function")throw new TypeError("sizeCalculation must be a function");if(s=u(i,r),!kr(s))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return s}),ue(this,qi,(r,i,s)=>{if(t[r]=i,y(this,Jt)){const u=y(this,Jt)-t[r];for(;y(this,In)>u;)J(this,H,Go).call(this,!0)}ue(this,In,y(this,In)+t[r]),s&&(s.entrySize=i,s.totalCalculatedSize=y(this,In))})},ii=new WeakMap,qi=new WeakMap,Ts=new WeakMap,Ar=function*({allowStale:t=this.allowStale}={}){if(y(this,dt))for(let r=y(this,mt);J(this,H,Uu).call(this,r)&&(!t&&y(this,Kt).call(this,r)||(yield r),r!==y(this,Ot));)r=y(this,Qt)[r]},Tr=function*({allowStale:t=this.allowStale}={}){if(y(this,dt))for(let r=y(this,Ot);J(this,H,Uu).call(this,r)&&(!t&&y(this,Kt).call(this,r)||(yield r),r!==y(this,mt));)r=y(this,jt)[r]},Uu=function(t){return t!==void 0&&y(this,ot).get(y(this,Ye)[t])===t},Go=function(t){var u,c;const r=y(this,Ot),i=y(this,Ye)[r],s=y(this,be)[r];return y(this,Nr)&&J(this,H,Ze).call(this,s)?s.__abortController.abort(new Error("evicted")):(y(this,An)||y(this,Dt))&&(y(this,An)&&((u=y(this,Cn))==null||u.call(this,s,i,"evict")),y(this,Dt)&&((c=y(this,vt))==null||c.push([s,i,"evict"]))),y(this,ii).call(this,r),t&&(y(this,Ye)[r]=void 0,y(this,be)[r]=void 0,y(this,En).push(r)),y(this,dt)===1?(ue(this,Ot,ue(this,mt,0)),y(this,En).length=0):ue(this,Ot,y(this,jt)[r]),y(this,ot).delete(i),zo(this,dt)._--,r},Zo=function(t,r,i,s){const u=r===void 0?void 0:y(this,be)[r];if(J(this,H,Ze).call(this,u))return u;const c=new ea,{signal:h}=i;h==null||h.addEventListener("abort",()=>c.abort(h.reason),{signal:c.signal});const f={signal:c.signal,options:i,context:s},v=(E,T=!1)=>{const{aborted:q}=c.signal,L=i.ignoreFetchAbort&&E!==void 0;if(i.status&&(q&&!T?(i.status.fetchAborted=!0,i.status.fetchError=c.signal.reason,L&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),q&&!L&&!T)return _(c.signal.reason);const S=b;return y(this,be)[r]===b&&(E===void 0?S.__staleWhileFetching?y(this,be)[r]=S.__staleWhileFetching:J(this,H,Fr).call(this,t,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(t,E,f.options))),E},_=E=>{const{aborted:T}=c.signal,q=T&&i.allowStaleOnFetchAbort,L=q||i.allowStaleOnFetchRejection,S=L||i.noDeleteOnFetchRejection,F=b;if(y(this,be)[r]===b&&(!S||F.__staleWhileFetching===void 0?J(this,H,Fr).call(this,t,"fetch"):q||(y(this,be)[r]=F.__staleWhileFetching)),L)return i.status&&F.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),F.__staleWhileFetching;if(F.__returned===F)throw E};i.status&&(i.status.fetchDispatched=!0);const b=new Promise((E,T)=>{var L;const q=(L=y(this,Di))==null?void 0:L.call(this,t,u,f);q&&q instanceof Promise&&q.then(S=>E(S===void 0?void 0:S),T),c.signal.addEventListener("abort",()=>{i.ignoreFetchAbort&&!i.allowStaleOnFetchAbort||(E(void 0),i.allowStaleOnFetchAbort&&(E=S=>v(S,!0)))})}).then(v,E=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=E),_(E))),x=Object.assign(b,{__abortController:c,__staleWhileFetching:u,__returned:void 0});return r===void 0?(this.set(t,x,{...f.options,status:void 0}),r=y(this,ot).get(t)):y(this,be)[r]=x,x},Ze=function(t){if(!y(this,Nr))return!1;const r=t;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof ea},qu=function(t,r){y(this,Qt)[r]=t,y(this,jt)[t]=r},Is=function(t){t!==y(this,mt)&&(t===y(this,Ot)?ue(this,Ot,y(this,jt)[t]):J(this,H,qu).call(this,y(this,Qt)[t],y(this,jt)[t]),J(this,H,qu).call(this,y(this,mt),t),ue(this,mt,t))},Fr=function(t,r){var s,u,c,h;let i=!1;if(y(this,dt)!==0){const f=y(this,ot).get(t);if(f!==void 0)if(i=!0,y(this,dt)===1)J(this,H,zu).call(this,r);else{y(this,ii).call(this,f);const v=y(this,be)[f];if(J(this,H,Ze).call(this,v)?v.__abortController.abort(new Error("deleted")):(y(this,An)||y(this,Dt))&&(y(this,An)&&((s=y(this,Cn))==null||s.call(this,v,t,r)),y(this,Dt)&&((u=y(this,vt))==null||u.push([v,t,r]))),y(this,ot).delete(t),y(this,Ye)[f]=void 0,y(this,be)[f]=void 0,f===y(this,mt))ue(this,mt,y(this,Qt)[f]);else if(f===y(this,Ot))ue(this,Ot,y(this,jt)[f]);else{const _=y(this,Qt)[f];y(this,jt)[_]=y(this,jt)[f];const b=y(this,jt)[f];y(this,Qt)[b]=y(this,Qt)[f]}zo(this,dt)._--,y(this,En).push(f)}}if(y(this,Dt)&&((c=y(this,vt))!=null&&c.length)){const f=y(this,vt);let v;for(;v=f==null?void 0:f.shift();)(h=y(this,Sn))==null||h.call(this,...v)}return i},zu=function(t){var r,i,s;for(const u of J(this,H,Tr).call(this,{allowStale:!0})){const c=y(this,be)[u];if(J(this,H,Ze).call(this,c))c.__abortController.abort(new Error("deleted"));else{const h=y(this,Ye)[u];y(this,An)&&((r=y(this,Cn))==null||r.call(this,c,h,t)),y(this,Dt)&&((i=y(this,vt))==null||i.push([c,h,t]))}}if(y(this,ot).clear(),y(this,be).fill(void 0),y(this,Ye).fill(void 0),y(this,Xt)&&y(this,kn)&&(y(this,Xt).fill(0),y(this,kn).fill(0)),y(this,Mn)&&y(this,Mn).fill(0),ue(this,Ot,0),ue(this,mt,0),y(this,En).length=0,ue(this,In,0),ue(this,dt,0),y(this,Dt)&&y(this,vt)){const u=y(this,vt);let c;for(;c=u==null?void 0:u.shift();)(s=y(this,Sn))==null||s.call(this,...c)}};let ju=tc;class Xh{constructor(){m(this,"_syncStatus",{status:sg.done,foldersProgress:[]});m(this,"_syncEnabledState",nh.initializing);m(this,"_workspaceGuidelines",[]);m(this,"_openUserGuidelinesInput",!1);m(this,"_userGuidelines");m(this,"_contextStore",new kg);m(this,"_prevOpenFiles",[]);m(this,"_disableContext",!1);m(this,"_enableAgentMemories",!1);m(this,"subscribers",new Set);m(this,"subscribe",t=>(this.subscribers.add(t),t(this),()=>{this.subscribers.delete(t)}));m(this,"handleMessageFromExtension",t=>{const r=t.data;switch(r.type){case it.sourceFoldersUpdated:this.onSourceFoldersUpdated(r.data.sourceFolders);break;case it.sourceFoldersSyncStatus:this.onSyncStatusUpdated(r.data);break;case it.fileRangesSelected:this.updateSelections(r.data);break;case it.currentlyOpenFiles:this.setCurrentlyOpenFiles(r.data);break;case it.syncEnabledState:this.onSyncEnabledStateUpdate(r.data);break;case it.updateGuidelinesState:this.onGuidelinesStateUpdate(r.data);break;default:return!1}return!0});m(this,"onSourceFoldersUpdated",t=>{const r=this.sourceFolders;t=this.updateSourceFoldersWithGuidelines(t),this._contextStore.update(t.map(i=>({sourceFolder:i,status:yt.active,label:i.folderRoot,showWarning:i.guidelinesOverLimit,id:i.folderRoot+String(i.guidelinesEnabled)+String(i.guidelinesOverLimit)})),r,i=>i.id),this.notifySubscribers()});m(this,"onSyncStatusUpdated",t=>{this._syncStatus=t,this.notifySubscribers()});m(this,"disableContext",()=>{this._disableContext=!0,this.notifySubscribers()});m(this,"enableContext",()=>{this._disableContext=!1,this.notifySubscribers()});m(this,"addFile",t=>{this.addFiles([t])});m(this,"addFiles",t=>{this.updateFiles(t,[])});m(this,"removeFile",t=>{this.removeFiles([t])});m(this,"removeFiles",t=>{this.updateFiles([],t)});m(this,"updateItems",(t,r)=>{this.updateItemsInplace(t,r),this.notifySubscribers()});m(this,"updateItemsInplace",(t,r)=>{this._contextStore.update(t,r,i=>i.id)});m(this,"updateFiles",(t,r)=>{const i=c=>({file:c,...$u(c)}),s=t.map(i),u=r.map(i);this._contextStore.update(s,u,c=>c.id),this.notifySubscribers()});m(this,"enableAgentMemories",()=>{this._enableAgentMemories=!0,this.notifySubscribers()});m(this,"disableAgentMemories",()=>{this._enableAgentMemories=!1,this.notifySubscribers()});m(this,"setCurrentlyOpenFiles",t=>{const r=t.map(s=>({recentFile:s,...$u(s)})),i=this._prevOpenFiles;this._prevOpenFiles=r,this._contextStore.update(r,i,s=>s.id),i.forEach(s=>{const u=this._contextStore.peekKey(s.id);u!=null&&u.recentFile&&(u.file=u.recentFile,delete u.recentFile)}),r.forEach(s=>{const u=this._contextStore.peekKey(s.id);u!=null&&u.file&&(u.recentFile=u.file,delete u.file)}),this.notifySubscribers()});m(this,"onSyncEnabledStateUpdate",t=>{this._syncEnabledState=t,this.notifySubscribers()});m(this,"updateUserGuidelines",t=>{const r=this.userGuidelines,i={userGuidelines:t,label:"User Guidelines",id:"userGuidelines",status:yt.active,referenceCount:1,showWarning:t.overLimit};this._contextStore.update([i],r,s=>{var u,c;return s.id+String((u=s.userGuidelines)==null?void 0:u.enabled)+String((c=s.userGuidelines)==null?void 0:c.overLimit)}),this.notifySubscribers()});m(this,"onGuidelinesStateUpdate",t=>{this._userGuidelines=t.userGuidelines,this._workspaceGuidelines=t.workspaceGuidelines??[];const r=t.userGuidelines;r&&this.updateUserGuidelines(r),this.onSourceFoldersUpdated(this.sourceFolders.map(i=>i.sourceFolder))});m(this,"updateSourceFoldersWithGuidelines",t=>t.map(r=>{const i=this._workspaceGuidelines.find(s=>s.workspaceFolder===r.folderRoot);return{...r,guidelinesEnabled:(i==null?void 0:i.enabled)??!1,guidelinesOverLimit:(i==null?void 0:i.overLimit)??!1,guidelinesLengthLimit:(i==null?void 0:i.lengthLimit)??2e3}}));m(this,"toggleStatus",t=>{this._contextStore.toggleStatus(t.id),this.notifySubscribers()});m(this,"updateExternalSources",(t,r)=>{this._contextStore.update(t,r,i=>i.id),this.notifySubscribers()});m(this,"clearFiles",()=>{this._contextStore.update([],this.files,t=>t.id),this.notifySubscribers()});m(this,"updateSelections",t=>{const r=this._contextStore.values.filter(Qo);this._contextStore.update(t.map(i=>({selection:i,...$u(i)})),r,i=>i.id),this.notifySubscribers()});m(this,"maybeHandleDelete",({editor:t})=>{if(t.state.selection.empty&&t.state.selection.$anchor.pos===1&&this.recentActiveItems.length>0){const r=this.recentActiveItems[0];return this.markInactive(r),!0}return!1});m(this,"markInactive",t=>{this.markItemsInactive([t])});m(this,"markItemsInactive",t=>{t.forEach(r=>{this._contextStore.setStatus(r.id,yt.inactive)}),this.notifySubscribers()});m(this,"markAllInactive",()=>{this.markItemsInactive(this.recentActiveItems)});m(this,"markActive",t=>{this.markItemsActive([t])});m(this,"markItemsActive",t=>{t.forEach(r=>{this._contextStore.setStatus(r.id,yt.active)}),this.notifySubscribers()});m(this,"markAllActive",()=>{this.markItemsActive(this.recentInactiveItems)});m(this,"unpin",t=>{this._contextStore.unpin(t.id),this.notifySubscribers()});m(this,"togglePinned",t=>{this._contextStore.togglePinned(t.id),this.notifySubscribers()});m(this,"notifySubscribers",()=>{this.subscribers.forEach(t=>t(this))});this.clearFiles()}get files(){return this._disableContext?[]:this._contextStore.values.filter(t=>Ju(t)&&!Jo(t))}get recentFiles(){return this._disableContext?[]:this._contextStore.values.filter(Jo)}get userGuidelinesText(){var t;return((t=this._userGuidelines)==null?void 0:t.contents)??""}get selections(){return this._disableContext?[]:this._contextStore.values.filter(Qo)}get folders(){return this._disableContext?[]:this._contextStore.values.filter(Qu)}get sourceFolders(){return this._disableContext?[]:this._contextStore.values.filter(Xo)}get externalSources(){return this._disableContext?[]:this._contextStore.values.filter(Xu)}get userGuidelines(){return this._contextStore.values.filter(Ko)}get agentMemories(){return[{...Np,status:this._enableAgentMemories?yt.active:yt.inactive,referenceCount:1}]}get activeFiles(){return this._disableContext?[]:this.files.filter(t=>t.status===yt.active)}get activeRecentFiles(){return this._disableContext?[]:this.recentFiles.filter(t=>t.status===yt.active)}get activeExternalSources(){return this._disableContext?[]:this.externalSources.filter(t=>t.status===yt.active)}get activeSelections(){return this._disableContext?[]:this.selections.filter(t=>t.status===yt.active)}get activeSourceFolders(){return this._disableContext?[]:this.sourceFolders.filter(t=>t.status===yt.active)}get syncStatus(){return this._syncStatus.status}get syncEnabledState(){return this._syncEnabledState}get syncProgress(){var f;if(this.syncEnabledState===nh.disabled||!this._syncStatus.foldersProgress)return;const t=this._syncStatus.foldersProgress.filter(v=>v.progress!==void 0);if(t.length===0)return;const r=t.reduce((v,_)=>{var b;return v+(((b=_==null?void 0:_.progress)==null?void 0:b.trackedFiles)??0)},0),i=t.reduce((v,_)=>{var b;return v+(((b=_==null?void 0:_.progress)==null?void 0:b.backlogSize)??0)},0),s=Math.max(r,0),u=Math.min(Math.max(i,0),s),c=s-u,h=[];for(const v of t)(f=v==null?void 0:v.progress)!=null&&f.newlyTracked&&h.push(v.folderRoot);return{status:this._syncStatus.status,totalFiles:s,syncedCount:c,backlogSize:u,newlyTrackedFolders:h}}get contextCounts(){return this._contextStore.values.length??0}get chatActiveContext(){return{userSpecifiedFiles:this.activeFiles.map(t=>({rootPath:t.file.repoRoot,relPath:t.file.pathName})),recentFiles:this.activeRecentFiles.map(t=>({rootPath:t.recentFile.repoRoot,relPath:t.recentFile.pathName})),externalSources:this.activeExternalSources.map(t=>t.externalSource),selections:this.activeSelections.map(t=>t.selection),sourceFolders:this.activeSourceFolders.map(t=>({rootPath:t.sourceFolder.folderRoot,relPath:""}))}}get recentItems(){return this._disableContext?this.userGuidelines:[...this._contextStore.values.filter(t=>!Xo(t)&&!Ko(t)&&!na(t)),...this.sourceFolders,...this.userGuidelines,...this.agentMemories]}get recentActiveItems(){return this.recentItems.filter(t=>t.status===yt.active)}get recentInactiveItems(){return this.recentItems.filter(t=>t.status===yt.inactive)}get isContextDisabled(){return this._disableContext}}class kg{constructor(){m(this,"_cache",new ju({max:1e3}));m(this,"peekKey",t=>this._cache.get(t,{updateAgeOnGet:!1}));m(this,"clear",()=>{this._cache.clear()});m(this,"update",(t,r,i)=>{t.forEach(s=>this.addInPlace(s,i)),r.forEach(s=>this.removeInPlace(s,i))});m(this,"removeFromStore",(t,r)=>{const i=r(t);this._cache.delete(i)});m(this,"addInPlace",(t,r)=>{const i=r(t),s=t.referenceCount??1,u=this._cache.get(i),c=t.status??(u==null?void 0:u.status)??yt.active;u?(u.referenceCount+=s,u.status=c,u.pinned=t.pinned??u.pinned,u.showWarning=t.showWarning??u.showWarning):this._cache.set(i,{...t,pinned:void 0,referenceCount:s,status:c})});m(this,"removeInPlace",(t,r)=>{const i=r(t),s=this._cache.get(i);s&&(s.referenceCount-=1,s.referenceCount===0&&this._cache.delete(i))});m(this,"setStatus",(t,r)=>{const i=this._cache.get(t);i&&(i.status=r)});m(this,"togglePinned",t=>{const r=this._cache.peek(t);r&&(r.pinned?this.unpin(t):this.pin(t))});m(this,"pin",t=>{const r=this._cache.peek(t);r&&!r.pinned&&(r.pinned=!0,r.referenceCount+=1)});m(this,"unpin",t=>{const r=this._cache.peek(t);r&&r.pinned&&(r.pinned=!1,r.referenceCount-=1,r.referenceCount===0&&this._cache.delete(t))});m(this,"toggleStatus",t=>{const r=this._cache.get(t);r&&(r.status=r.status===yt.active?yt.inactive:yt.active)})}get store(){return Object.fromEntries(this._cache.entries())}get values(){return[...this._cache.values()]}}class Ag{constructor(t,r,i){m(this,"_originalModel");m(this,"_modifiedModel");m(this,"_fullEdits",[]);m(this,"_currEdit");m(this,"_currOriginalEdit");m(this,"swapBaseModel",t=>{this._originalModel.setValue(t),this._modifiedModel.setValue(t),this._fullEdits.forEach(r=>{this._modifiedModel.applyEdits([r])}),this._currEdit&&this._modifiedModel.applyEdits([this._currEdit]),this._currOriginalEdit&&this._originalModel.applyEdits([this._currOriginalEdit])});m(this,"finish",()=>this._completeCurrEdit());m(this,"onReceiveChunk",t=>t.data.newChunkStart?this._startNewEdit(t.data.newChunkStart):t.data.chunkContinue&&this._currEdit?this._continueEdit(t.data.chunkContinue):t.data.chunkEnd&&this._currEdit?this._completeCurrEdit(t.data.chunkEnd):void 0);m(this,"_completeCurrEdit",t=>{const r={resetOriginal:[],original:[],modified:[]};if(!t)return r;if(this._currEdit){this._currEdit.range=new this._monaco.Range(t.stagedStartLine,0,t.stagedEndLine,0);const i=this._nextModifiedInsertPosition(),s=t.stagedEndLine-t.stagedStartLine,u={range:new this._monaco.Range(i.lineNumber,0,i.lineNumber+s,0),text:""};r.modified.push(u),this._modifiedModel.applyEdits([u]),this._fullEdits.push(this._currEdit),this._currEdit=void 0}return r});m(this,"_startNewEdit",t=>{const r={resetOriginal:[],original:[],modified:[]};return this._currOriginalEdit=void 0,this._currEdit={range:new this._monaco.Range(t.stagedStartLine,0,t.stagedStartLine,0),text:""},r.modified.push(this._currEdit),this._modifiedModel.applyEdits([this._currEdit]),r});m(this,"_continueEdit",t=>{if(!this._currEdit)throw new Error("No current edit");const r=this._nextModifiedInsertPosition(),i={...this._currEdit,text:t.newText,range:new this._monaco.Range(r.lineNumber,r.column,r.lineNumber,r.column)};return this._modifiedModel.applyEdits([i]),this._currEdit.text+=t.newText,{resetOriginal:[],original:[],modified:t.newText.length>0?[i]:[]}});m(this,"_nextModifiedInsertPosition",()=>{var r;if(!this._currEdit)throw new Error("No current edit");const t=this._modifiedModel.getOffsetAt({lineNumber:this._currEdit.range.startLineNumber,column:this._currEdit.range.startColumn})+(((r=this._currEdit.text)==null?void 0:r.length)??0);return this._modifiedModel.getPositionAt(t)});this.id=t,this.originalCode=r,this._monaco=i,this._originalModel=this._monaco.editor.createModel(r),this._modifiedModel=this._monaco.editor.createModel(r)}get hasReceivedFirstChunk(){return this._currEdit!==void 0||this._fullEdits.length>0}get originalValue(){return this._originalModel.getValue()}get modifiedValue(){return this._modifiedModel.getValue()}get currEdit(){return this._currEdit}}class Tg{constructor(t,r,i){m(this,"_asyncMsgSender");m(this,"_editor");m(this,"_chatModel");m(this,"_focusModel",new Ph);m(this,"_hasScrolledOnInit",!1);m(this,"_markHasScrolledOnInit",Fu(()=>{this._hasScrolledOnInit=!0},200));m(this,"_resetScrollOnInit",()=>{this._markHasScrolledOnInit.cancel(),this._hasScrolledOnInit=!1});m(this,"_subscribers",new Set);m(this,"_disposables",[]);m(this,"_rootChunk");m(this,"_keybindings",bt({}));m(this,"_requestId",bt(void 0));m(this,"requestId",this._requestId);m(this,"_disableResolution",bt(!1));m(this,"disableResolution",Kl(this._disableResolution));m(this,"_disableApply",bt(!1));m(this,"disableApply",Kl(this._disableApply));m(this,"_currStream");m(this,"_isLoadingDiffChunks",bt(!1));m(this,"_selectionLines",bt(void 0));m(this,"_mode",bt(Dr.edit));m(this,"initializeEditor",t=>{var r,i,s,u,c,h,f,v,_,b,x,E;this._editor=this._monaco.editor.createDiffEditor(this._editorContainer,{automaticLayout:!0,theme:t,readOnly:!0,contextmenu:!1,renderSideBySide:!1,renderIndicators:!0,renderMarginRevertIcon:!1,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!1,ignoreTrimWhitespace:!1,scrollBeyondLastLine:!0,maxComputationTime:0,minimap:{enabled:!1},padding:{top:16}}),this._editor.getOriginalEditor().updateOptions({lineNumbers:"off"}),this._chatModel=new Zh(new Hh(Es),Es,new Xh),(i=(r=this._monaco.editor).registerCommand)==null||i.call(r,"acceptFocusedChunk",this.acceptFocusedChunk),(u=(s=this._monaco.editor).registerCommand)==null||u.call(s,"rejectFocusedChunk",this.rejectFocusedChunk),(h=(c=this._monaco.editor).registerCommand)==null||h.call(c,"acceptAllChunks",this.acceptAllChunks),(v=(f=this._monaco.editor).registerCommand)==null||v.call(f,"rejectAllChunks",this.rejectAllChunks),(b=(_=this._monaco.editor).registerCommand)==null||b.call(_,"focusNextChunk",this.focusNextChunk),(E=(x=this._monaco.editor).registerCommand)==null||E.call(x,"focusPrevChunk",this.focusPrevChunk),this._disposables.push(this._editor,this._editor.onDidUpdateDiff(this.onDidUpdateDiff),this._editor.getModifiedEditor().onMouseMove(this.onMouseMoveModified),{dispose:this._focusModel.subscribe(T=>this.notifySubscribers())}),this.initialize()});m(this,"subscribe",t=>(this._subscribers.add(t),t(this),()=>{this._subscribers.delete(t)}));m(this,"dispose",()=>{this._editor.dispose(),this._subscribers.clear(),this._disposables.forEach(t=>t.dispose())});m(this,"notifySubscribers",()=>{this._subscribers.forEach(t=>t(this))});m(this,"onDidUpdateDiff",()=>{var t;if(this.updateCodeChunk(),!this._hasScrolledOnInit&&((t=this.leaves)==null?void 0:t.length)){this._markHasScrolledOnInit();const r=this.leaves[0];this.revealChunk(r)}this.notifyDiffViewUpdated(),this.notifySubscribers()});m(this,"onMouseMoveModified",t=>{var s,u,c,h,f,v;if(((s=t.target.position)==null?void 0:s.lineNumber)===void 0||this.leaves===void 0)return;const r=this.editorOffset,i=(u=t.target.position)==null?void 0:u.lineNumber;for(let _=0;_<this.leaves.length;_++){const b=this.leaves[_],x=(c=b.unitOfCodeWork.lineChanges)==null?void 0:c.lineChanges[0].modifiedStart,E=(h=b.unitOfCodeWork.lineChanges)==null?void 0:h.lineChanges[0].modifiedEnd,T=(f=b.unitOfCodeWork.lineChanges)==null?void 0:f.lineChanges[0].originalStart,q=(v=b.unitOfCodeWork.lineChanges)==null?void 0:v.lineChanges[0].originalEnd;if(x!==void 0&&E!==void 0&&T!==void 0&&q!==void 0){if(x!==E||i!==x){if(x<=i&&i<E){this.setCurrFocusedChunkIdx(_,!1);break}}else if(t.target.type===this._monaco.editor.MouseTargetType.CONTENT_VIEW_ZONE){const L=this._editor.getOriginalEditor(),S=L.getOption(this._monaco.editor.EditorOption.lineHeight),F=L.getScrolledVisiblePosition({lineNumber:T,column:0}),ne=L.getScrolledVisiblePosition({lineNumber:q+1,column:0});if(F===null||ne===null)continue;const de=F.top-S/2+r,oe=ne.top-S/2+r;if(t.event.posy>=de&&t.event.posy<=oe){this.setCurrFocusedChunkIdx(_,!1);break}break}}}});m(this,"updateIsWebviewFocused",async t=>{await this._asyncMsgSender.send({type:it.diffViewWindowFocusChange,data:t})});m(this,"setCurrFocusedChunkIdx",(t,r=!0)=>{this._focusModel.focusedItemIdx!==t&&(this._focusModel.setFocusIdx(t),r&&this.revealCurrFocusedChunk(),this.notifySubscribers())});m(this,"revealCurrFocusedChunk",()=>{const t=this._focusModel.focusedItem;t&&this.revealChunk(t)});m(this,"revealChunk",t=>{var s;const r=(s=t.unitOfCodeWork.lineChanges)==null?void 0:s.lineChanges[0],i=r==null?void 0:r.modifiedStart;i!==void 0&&this._editor.revealLineNearTop(i-1)});m(this,"renderCentralOverlayWidget",t=>{const r=()=>({editor:this._editor,id:"central-overlay-widget"}),i=function(s,u,c){let h,f=u;const v=()=>f.editor.getModifiedEditor(),_=()=>{const b=v();if(!b)return;const x={getDomNode:()=>s,getId:()=>f.id,getPosition:()=>({preference:c.monaco.editor.OverlayWidgetPositionPreference.TOP_CENTER})};h&&b.removeOverlayWidget(h),b.addOverlayWidget(x),h=x};return _(),{update:b=>{f=b,_()},destroy:()=>{const b=v();b&&h&&b.removeOverlayWidget(h)}}}(t,r(),{monaco:this._monaco});return{update:()=>{i.update(r())},destroy:i.destroy}});m(this,"renderInstructionsDrawerViewZone",(t,r)=>{let i=!1,s=r;const u=r.autoFocus??!0,c=_=>{u&&!i&&(this._editor.revealLineNearTop(_),i=!0)},h=_=>({..._,ordinal:Lu.instructionDrawer,editor:this._editor,afterLineNumber:_.line}),f=uh(t,h(r)),v=[];return u&&v.push(this._editor.onDidUpdateDiff(()=>{c(s.line)})),{update:_=>{const b={...s,..._};bg(b,s)||(f.update(h(b)),s=b,c(b.line))},destroy:()=>{f.destroy(),v.forEach(_=>_.dispose())}}});m(this,"renderActionsViewZone",(t,r)=>{const i=u=>{var h;let c;return c=u.chunk?(h=u.chunk.unitOfCodeWork.lineChanges)==null?void 0:h.lineChanges[0].modifiedStart:1,{...u,ordinal:Lu.chunkActionPanel,editor:this._editor,afterLineNumber:c?c-1:void 0}},s=uh(t,i(r));return{update:u=>{s.update(i(u))},destroy:s.destroy}});m(this,"acceptAllChunks",()=>{this.leaves&&this.acceptChunks(this.leaves,!0)});m(this,"rejectAllChunks",()=>{this.leaves&&this.rejectChunks(this.leaves,!0)});m(this,"acceptFocusedChunk",()=>{const t=this._focusModel.focusedItem;t&&this.acceptChunk(t)});m(this,"rejectFocusedChunk",()=>{const t=this._focusModel.focusedItem;t&&this.rejectChunk(t)});m(this,"focusNextChunk",()=>{this._focusModel.focusNext(),this.revealCurrFocusedChunk()});m(this,"focusPrevChunk",()=>{this._focusModel.focusPrev(),this.revealCurrFocusedChunk()});m(this,"initialize",async()=>{var f;const t=await this._asyncMsgSender.send({type:it.diffViewLoaded},2e3);this._resetScrollOnInit();const{file:r,instruction:i,keybindings:s,editable:u}=t.data;this._editor.updateOptions({readOnly:!u});const c=pt(this._keybindings);this._keybindings.set(s??c);const h=i==null?void 0:i.selection;h&&(h.start.line===h.end.line&&h.start.character===h.end.character&&this._mode.set(Dr.instruction),pt(this.selectionLines)===void 0&&this._selectionLines.set({start:h.start.line,end:h.end.line})),this.updateModels(r.originalCode??"",r.modifiedCode??"",{rootPath:r.repoRoot,relPath:r.pathName}),(f=this._currStream)==null||f.finish(),this._currStream=void 0,this._disableResolution.set(!!t.data.disableResolution),this._disableApply.set(!!t.data.disableApply),await this._tryFetchStream(),this._syncStreamToModels()});m(this,"disposeDiffViewPanel",async()=>{await this._asyncMsgSender.send({type:it.disposeDiffView})});m(this,"_tryFetchStream",async()=>{var r,i,s;const t=this._asyncMsgSender.stream({type:it.diffViewFetchPendingStream},15e3,6e4);for await(const u of t)switch(u.type){case it.diffViewDiffStreamStarted:{this.setLoading(!0),this._requestId.set(u.data.requestId);const c=this._editor.getOriginalEditor().getValue();this._currStream=new Ag(u.data.streamId,c,this._monaco),this._syncStreamToModels();break}case it.diffViewDiffStreamEnded:if(((r=this._currStream)==null?void 0:r.id)!==u.data.streamId)return;this.setLoading(!1),this._cleanupStream();break;case it.diffViewDiffStreamChunk:{if(((i=this._currStream)==null?void 0:i.id)!==u.data.streamId)return;const c=this._editor.getOriginalEditor().getModel();if(!this._editor.getModifiedEditor().getModel()||!c)return this.setLoading(!1),void this._cleanupStream();const h=(s=this._currStream)==null?void 0:s.onReceiveChunk(u);h&&(this._applyDeltaDiff(h),pt(this._selectionLines)!=null&&this._selectionLines.set(null));break}}});m(this,"handleMessageFromExtension",async t=>{switch(t.data.type){case it.diffViewNotifyReinit:this.setLoading(!1),this._cleanupStream(),this.initialize();break;case it.diffViewAcceptAllChunks:this.acceptAllChunks();break;case it.diffViewAcceptFocusedChunk:this.acceptFocusedChunk();break;case it.diffViewRejectFocusedChunk:this.rejectFocusedChunk();break;case it.diffViewFocusPrevChunk:this.focusPrevChunk();break;case it.diffViewFocusNextChunk:this.focusNextChunk()}});m(this,"_applyDeltaDiff",t=>{const r=this._editor.getOriginalEditor().getModel(),i=this._editor.getModifiedEditor().getModel();r&&i&&(r.pushEditOperations([],t.resetOriginal,()=>[]),t.original.forEach(s=>{r.pushEditOperations([],[s],()=>[])}),t.modified.forEach(s=>{i.pushEditOperations([],[s],()=>[])}))});m(this,"_cleanupStream",()=>{var t;if(this._currStream){const r=(t=this._currStream)==null?void 0:t.finish();this._applyDeltaDiff(r),this._currStream=void 0,this._resetScrollOnInit()}});m(this,"_syncStreamToModels",()=>{var i,s;const t=(i=this._currStream)==null?void 0:i.originalValue,r=(s=this._currStream)==null?void 0:s.modifiedValue;t&&t!==this._editor.getOriginalEditor().getValue()&&this._editor.getOriginalEditor().setValue(t),r&&r!==this._editor.getModifiedEditor().getValue()&&this._editor.getModifiedEditor().setValue(r)});m(this,"acceptChunk",async t=>{pt(this._disableApply)||this.acceptChunks([t])});m(this,"acceptChunks",async(t,r=!1)=>{pt(this._disableApply)||(this.executeDiffChunks(t,!0),this.notifyResolvedChunks(t,yu.accept,r),await Mu(),this.areModelsEqual()&&!pt(this.isLoading)&&this.disposeDiffViewPanel())});m(this,"areModelsEqual",()=>{var i,s;const t=(i=this._editor.getModel())==null?void 0:i.original,r=(s=this._editor.getModel())==null?void 0:s.modified;return(t==null?void 0:t.getValue())===(r==null?void 0:r.getValue())});m(this,"rejectChunk",async t=>{this.rejectChunks([t])});m(this,"rejectChunks",async(t,r=!1)=>{this.executeDiffChunks(t,!1),this.notifyResolvedChunks(t,yu.reject,r),await Mu(),this.areModelsEqual()&&!pt(this.isLoading)&&this.disposeDiffViewPanel()});m(this,"notifyDiffViewUpdated",Fu(()=>{this.notifyResolvedChunks([],yu.accept)},1e3));m(this,"notifyResolvedChunks",async(t,r,i=!1)=>{var u;const s=(u=this._editor.getModel())==null?void 0:u.original.uri.path;s&&await this._asyncMsgSender.send({type:it.diffViewResolveChunk,data:{file:{repoRoot:"",pathName:s,originalCode:this._originalCode,modifiedCode:this._modifiedCode},changes:t.map(c=>c.unitOfCodeWork),resolveType:r,shouldApplyToAll:i}},2e3)});m(this,"executeDiffChunks",(t,r)=>{var _,b,x;if(pt(this._disableResolution)||r&&pt(this._disableApply))return;const i=(_=this._editor.getModel())==null?void 0:_.original,s=(b=this._editor.getModel())==null?void 0:b.modified;if(!i||!s||this._currStream!==void 0)return;const u=[],c=[];for(const E of t){const T=(x=E.unitOfCodeWork.lineChanges)==null?void 0:x.lineChanges[0];if(!T||E.unitOfCodeWork.originalCode===void 0||E.unitOfCodeWork.modifiedCode===void 0)continue;let q={startLineNumber:T.originalStart,startColumn:1,endLineNumber:T.originalEnd,endColumn:1},L={startLineNumber:T.modifiedStart,startColumn:1,endLineNumber:T.modifiedEnd,endColumn:1};const S=r?E.unitOfCodeWork.modifiedCode:E.unitOfCodeWork.originalCode;S!==void 0&&(u.push({range:q,text:S}),c.push({range:L,text:S}))}i.pushEditOperations([],u,()=>[]),s.pushEditOperations([],c,()=>[]);const h=this._focusModel.nextIdx({nowrap:!0});if(h===void 0)return;const f=h===this._focusModel.focusedItemIdx?h-1:h,v=this._focusModel.items[f];v&&this.revealChunk(v)});m(this,"updateCodeChunk",()=>{this._rootChunk=this.computeCodeChunk(),this._focusModel.setItems(this.leaves??[]),this._focusModel.initFocusIdx(0),this.notifySubscribers()});m(this,"handleInstructionSubmit",t=>{const r=this._editor.getModifiedEditor(),i=this.getSelectedCodeDetails(r);if(!i)throw Error("No selected code details found");this._chatModel.currentConversationModel.sendInstructionExchange(t,i)});m(this,"updateModels",(t,r,i)=>{var c,h;const s=(h=(c=this._editor.getModel())==null?void 0:c.original)==null?void 0:h.uri,u=(i&&this._monaco.Uri.file(i.relPath))??s;if(u)if((s==null?void 0:s.fsPath)!==u.fsPath||(s==null?void 0:s.authority)!==u.authority){const f=u.with({fragment:crypto.randomUUID()}),v=u.with({fragment:crypto.randomUUID()});this._editor.setModel({original:this._monaco.editor.createModel(t,void 0,f),modified:this._monaco.editor.createModel(r??"",void 0,v)})}else this._originalCode!==t&&this.getOriginalEditor().setValue(t),this._modifiedCode!==r&&this.getModifiedEditor().setValue(r??"");else console.warn("No URI found for diff view. Not updating models.")});m(this,"updateTheme",t=>{this._monaco.editor.setTheme(t)});this._editorContainer=t,this._monaco=i,this._asyncMsgSender=new Mp(s=>Es.postMessage(s)),this.initializeEditor(r)}get editorOffset(){return this._editorContainer.getBoundingClientRect().top}get currFocusedChunkIdx(){return this._focusModel.focusedItemIdx}get selectionLines(){return this._selectionLines}get mode(){return this._mode}get keybindings(){return this._keybindings}getOriginalEditor(){return this._editor.getOriginalEditor()}getModifiedEditor(){return this._editor.getModifiedEditor()}get isLoading(){return{subscribe:this._isLoadingDiffChunks.subscribe}}setLoading(t){this._isLoadingDiffChunks.set(t)}get _originalCode(){var t;return((t=this._currStream)==null?void 0:t.originalCode)??this._editor.getOriginalEditor().getValue()}get _modifiedCode(){return this._editor.getModifiedEditor().getValue()}get leaves(){const t=this.codeChunk;if(t)return Bh(t)}get codeChunk(){return this._rootChunk}computeCodeChunk(){var u,c;const t=[],r=this._editor.getLineChanges(),i=(u=this._editor.getModel())==null?void 0:u.original,s=(c=this._editor.getModel())==null?void 0:c.modified;if(r&&i&&s){for(const h of r){const f=hh({startLineNumber:h.originalStartLineNumber,startColumn:1,endLineNumber:h.originalEndLineNumber,endColumn:1}),v=hh({startLineNumber:h.modifiedStartLineNumber,startColumn:1,endLineNumber:h.modifiedEndLineNumber,endColumn:1}),_=Fg(this._editor,f,v);t.push(_)}return{id:crypto.randomUUID(),name:"",title:"",description:"",generationSource:"",supportedActions:[],children:t,childIds:t.map(h=>h.id)}}}getSelectedCodeDetails(t){const r=t.getModel();if(!r)return null;const i=r.getLanguageId(),s=1,u=1,c={lineNumber:r.getLineCount(),column:r.getLineMaxColumn(r.getLineCount())},h=pt(this._selectionLines);if(!h)throw new Error("No selection lines found");const f=Math.min(h.end+1,c.lineNumber),v=new this._monaco.Range(h.start+1,1,f,r.getLineMaxColumn(f));let _=r.getValueInRange(v);f<r.getLineCount()&&(_+=r.getEOL());const b=new this._monaco.Range(s,u,v.startLineNumber,v.startColumn),x=Math.min(v.endLineNumber+1,c.lineNumber),E=new this._monaco.Range(x,1,c.lineNumber,c.column);return{selectedCode:_,prefix:r.getValueInRange(b),suffix:r.getValueInRange(E),path:r.uri.path,language:i,prefixBegin:b.startLineNumber-1,suffixEnd:E.endLineNumber-1}}}function Fg(o,t,r){var u,c;const i=(u=o.getModel())==null?void 0:u.original,s=(c=o.getModel())==null?void 0:c.modified;if(!i||!s)throw new Error("No models found");return function(h,f,v,_){return{id:crypto.randomUUID(),name:"",title:"",description:"",generationSource:"",supportedActions:[],unitOfCodeWork:{repoRoot:"",pathName:"",originalCode:h,modifiedCode:f,lineChanges:{lineChanges:[{originalStart:v.startLineNumber,originalEnd:v.endLineNumber,modifiedStart:_.startLineNumber,modifiedEnd:_.endLineNumber}],lineOffset:0}},children:[],childIds:[]}}(i.getValueInRange(t),s.getValueInRange(r),t,r)}function hh(o){return o.endLineNumber===0?{startLineNumber:o.startLineNumber+1,startColumn:1,endLineNumber:o.startLineNumber+1,endColumn:1}:{startLineNumber:o.startLineNumber,startColumn:1,endLineNumber:o.endLineNumber+1,endColumn:1}}function fh(o){let t,r;return t=new jr({props:{size:1,variant:"ghost",color:"success",$$slots:{default:[Og]},$$scope:{ctx:o}}}),t.$on("click",function(){ur(o[4])&&o[4].apply(this,arguments)}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){o=i;const u={};132096&s&&(u.$$scope={dirty:s,ctx:o}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function Og(o){let t,r,i;return t=new ci({props:{keybinding:o[10].acceptFocusedChunk}}),{c(){G(t.$$.fragment),r=xt(`
        Accept`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};1024&u&&(c.keybinding=s[10].acceptFocusedChunk),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function Lg(o){let t,r,i;return t=new ci({props:{keybinding:o[10].rejectFocusedChunk}}),{c(){G(t.$$.fragment),r=xt(`
      Reject`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};1024&u&&(c.keybinding=s[10].rejectFocusedChunk),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function Ng(o){let t,r,i,s,u,c,h,f,v,_,b=!o[3]&&fh(o);return h=new jr({props:{size:1,variant:"ghost",color:"error",$$slots:{default:[Lg]},$$scope:{ctx:o}}}),h.$on("click",function(){ur(o[5])&&o[5].apply(this,arguments)}),{c(){t=We("div"),i=Ue(),s=We("div"),u=We("div"),b&&b.c(),c=Ue(),G(h.$$.fragment),De(t,"class","svelte-zm1705"),pn(t,"c-chunk-diff-border--focused",!!o[7]&&o[1]),De(u,"class","c-button-container svelte-zm1705"),pn(u,"c-button-container--focused",o[1]),pn(u,"c-button-container--transparent",o[9]),De(s,"class","c-chunk-action-panel-anchor svelte-zm1705"),Fi(s,"top",o[8]+"px"),pn(s,"c-chunk-action-panel-anchor--left",o[0]==="left"),pn(s,"c-chunk-action-panel-anchor--right",o[0]==="right"),pn(s,"c-chunk-action-panel-anchor--focused",o[1])},m(x,E){re(x,t,E),re(x,i,E),re(x,s,E),He(s,u),b&&b.m(u,null),He(u,c),Z(h,u,null),f=!0,v||(_=[Rh(r=o[6].renderActionsViewZone(t,{chunk:o[7],heightInPx:o[2],onDomNodeTop:o[12]})),Rr(s,"mouseenter",o[13]),Rr(s,"mousemove",o[13]),Rr(s,"mouseleave",o[13])],v=!0)},p(x,[E]){o=x,r&&ur(r.update)&&132&E&&r.update.call(null,{chunk:o[7],heightInPx:o[2],onDomNodeTop:o[12]}),(!f||130&E)&&pn(t,"c-chunk-diff-border--focused",!!o[7]&&o[1]),o[3]?b&&($t(),U(b,1,1,()=>{b=null}),wt()):b?(b.p(o,E),8&E&&O(b,1)):(b=fh(o),b.c(),O(b,1),b.m(u,c));const T={};132096&E&&(T.$$scope={dirty:E,ctx:o}),h.$set(T),(!f||2&E)&&pn(u,"c-button-container--focused",o[1]),(!f||512&E)&&pn(u,"c-button-container--transparent",o[9]),(!f||256&E)&&Fi(s,"top",o[8]+"px"),(!f||1&E)&&pn(s,"c-chunk-action-panel-anchor--left",o[0]==="left"),(!f||1&E)&&pn(s,"c-chunk-action-panel-anchor--right",o[0]==="right"),(!f||2&E)&&pn(s,"c-chunk-action-panel-anchor--focused",o[1])},i(x){f||(O(b),O(h.$$.fragment,x),f=!0)},o(x){U(b),U(h.$$.fragment,x),f=!1},d(x){x&&(ie(t),ie(i),ie(s)),b&&b.d(),Y(h),v=!1,Zu(_)}}}function Rg(o,t,r){let i,{align:s="right"}=t,{isFocused:u}=t,{heightInPx:c=1}=t,{disableApply:h=!1}=t,{onAccept:f}=t,{onReject:v}=t,{diffViewModel:_}=t,{leaf:b}=t;const x=_.keybindings;si(o,x,S=>r(10,i=S));let E=0,T,q=!1;function L(){T&&(clearTimeout(T),T=void 0),r(9,q=!1)}return o.$$set=S=>{"align"in S&&r(0,s=S.align),"isFocused"in S&&r(1,u=S.isFocused),"heightInPx"in S&&r(2,c=S.heightInPx),"disableApply"in S&&r(3,h=S.disableApply),"onAccept"in S&&r(4,f=S.onAccept),"onReject"in S&&r(5,v=S.onReject),"diffViewModel"in S&&r(6,_=S.diffViewModel),"leaf"in S&&r(7,b=S.leaf)},[s,u,c,h,f,v,_,b,E,q,i,x,S=>{r(8,E=S)},function(S){S.target.closest(".c-button-container")?L():S.type==="mouseenter"||S.type==="mousemove"?(L(),T=setTimeout(()=>{r(9,q=!0)},400)):S.type==="mouseleave"&&L()}]}class jg extends oi{constructor(t){super(),ai(this,t,Rg,Ng,ui,{align:0,isFocused:1,heightInPx:2,disableApply:3,onAccept:4,onReject:5,diffViewModel:6,leaf:7})}}function dh(o){let t,r,i;function s(c){o[18](c)}let u={onOpenChange:o[16],content:o[3],triggerOn:[og.Hover],$$slots:{default:[Ug]},$$scope:{ctx:o}};return o[4]!==void 0&&(u.requestClose=o[4]),t=new ig({props:u}),Oi.push(()=>_p(t,"requestClose",s)),{c(){G(t.$$.fragment)},m(c,h){Z(t,c,h),i=!0},p(c,h){const f={};8&h&&(f.content=c[3]),1048576&h&&(f.$$scope={dirty:h,ctx:c}),!r&&16&h&&(r=!0,f.requestClose=c[4],mp(()=>r=!1)),t.$set(f)},i(c){i||(O(t.$$.fragment,c),i=!0)},o(c){U(t.$$.fragment,c),i=!1},d(c){Y(t,c)}}}function Dg(o){let t,r;return t=new ng({}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function Ug(o){let t,r;return t=new kp({props:{variant:"ghost",color:"neutral",size:1,$$slots:{default:[Dg]},$$scope:{ctx:o}}}),t.$on("click",o[17]),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1048576&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function qg(o){let t;return{c(){t=We("span"),t.textContent="No changes",De(t,"class","c-diff-page-counter svelte-4zjwll")},m(r,i){re(r,t,i)},p:Be,i:Be,o:Be,d(r){r&&ie(t)}}}function zg(o){var v,_;let t,r,i,s,u,c,h,f=((_=(v=o[1])==null?void 0:v.leaves)==null?void 0:_.length)+"";return c=new jh({props:{size:1,loading:o[10]}}),{c(){t=We("span"),r=xt(o[2]),i=xt(" of "),s=xt(f),u=Ue(),G(c.$$.fragment),De(t,"class","c-diff-page-counter svelte-4zjwll")},m(b,x){re(b,t,x),He(t,r),He(t,i),He(t,s),He(t,u),Z(c,t,null),h=!0},p(b,x){var T,q;(!h||4&x)&&cr(r,b[2]),(!h||2&x)&&f!==(f=((q=(T=b[1])==null?void 0:T.leaves)==null?void 0:q.length)+"")&&cr(s,f);const E={};1024&x&&(E.loading=b[10]),c.$set(E)},i(b){h||(O(c.$$.fragment,b),h=!0)},o(b){U(c.$$.fragment,b),h=!1},d(b){b&&ie(t),Y(c)}}}function Pg(o){let t,r,i,s;return i=new jh({props:{size:1,loading:o[10]}}),{c(){t=We("span"),r=xt(`Generating changes
        `),G(i.$$.fragment),De(t,"class","c-diff-page-counter svelte-4zjwll")},m(u,c){re(u,t,c),He(t,r),Z(i,t,null),s=!0},p(u,c){const h={};1024&c&&(h.loading=u[10]),i.$set(h)},i(u){s||(O(i.$$.fragment,u),s=!0)},o(u){U(i.$$.fragment,u),s=!1},d(u){u&&ie(t),Y(i)}}}function ph(o){let t,r,i,s,u,c;t=new jr({props:{size:1,variant:"ghost",color:"neutral",$$slots:{default:[Wg]},$$scope:{ctx:o}}}),t.$on("click",function(){ur(o[0].focusPrevChunk)&&o[0].focusPrevChunk.apply(this,arguments)}),i=new jr({props:{size:1,variant:"ghost",color:"neutral",$$slots:{default:[Hg]},$$scope:{ctx:o}}}),i.$on("click",function(){ur(o[0].focusNextChunk)&&o[0].focusNextChunk.apply(this,arguments)});let h=!o[12]&&gh(o);return{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment),s=Ue(),h&&h.c(),u=hr()},m(f,v){Z(t,f,v),re(f,r,v),Z(i,f,v),re(f,s,v),h&&h.m(f,v),re(f,u,v),c=!0},p(f,v){o=f;const _={};1050624&v&&(_.$$scope={dirty:v,ctx:o}),t.$set(_);const b={};1050624&v&&(b.$$scope={dirty:v,ctx:o}),i.$set(b),o[12]?h&&($t(),U(h,1,1,()=>{h=null}),wt()):h?(h.p(o,v),4096&v&&O(h,1)):(h=gh(o),h.c(),O(h,1),h.m(u.parentNode,u))},i(f){c||(O(t.$$.fragment,f),O(i.$$.fragment,f),O(h),c=!0)},o(f){U(t.$$.fragment,f),U(i.$$.fragment,f),U(h),c=!1},d(f){f&&(ie(r),ie(s),ie(u)),Y(t,f),Y(i,f),h&&h.d(f)}}}function Wg(o){let t,r,i;return t=new ci({props:{keybinding:o[11].focusPrevChunk}}),{c(){G(t.$$.fragment),r=xt(`
        Back`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};2048&u&&(c.keybinding=s[11].focusPrevChunk),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function Hg(o){let t,r,i;return t=new ci({props:{keybinding:o[11].focusNextChunk}}),{c(){G(t.$$.fragment),r=xt(`
        Next`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};2048&u&&(c.keybinding=s[11].focusNextChunk),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function gh(o){let t,r,i,s=!o[13]&&_h(o);return r=new jr({props:{size:1,variant:"ghost",color:"error",$$slots:{default:[Vg]},$$scope:{ctx:o}}}),r.$on("click",function(){ur(o[0].rejectAllChunks)&&o[0].rejectAllChunks.apply(this,arguments)}),{c(){s&&s.c(),t=Ue(),G(r.$$.fragment)},m(u,c){s&&s.m(u,c),re(u,t,c),Z(r,u,c),i=!0},p(u,c){(o=u)[13]?s&&($t(),U(s,1,1,()=>{s=null}),wt()):s?(s.p(o,c),8192&c&&O(s,1)):(s=_h(o),s.c(),O(s,1),s.m(t.parentNode,t));const h={};1050624&c&&(h.$$scope={dirty:c,ctx:o}),r.$set(h)},i(u){i||(O(s),O(r.$$.fragment,u),i=!0)},o(u){U(s),U(r.$$.fragment,u),i=!1},d(u){u&&ie(t),s&&s.d(u),Y(r,u)}}}function _h(o){let t,r;return t=new jr({props:{size:1,variant:"ghost",color:"success",$$slots:{default:[Bg]},$$scope:{ctx:o}}}),t.$on("click",function(){ur(o[0].acceptAllChunks)&&o[0].acceptAllChunks.apply(this,arguments)}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){o=i;const u={};1050624&s&&(u.$$scope={dirty:s,ctx:o}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function Bg(o){let t,r,i;return t=new ci({props:{keybinding:o[11].acceptAllChunks}}),{c(){G(t.$$.fragment),r=xt(`
            Accept All`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};2048&u&&(c.keybinding=s[11].acceptAllChunks),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function Vg(o){let t,r,i;return t=new ci({props:{keybinding:o[11].rejectAllChunks}}),{c(){G(t.$$.fragment),r=xt(`
          Reject All`)},m(s,u){Z(t,s,u),re(s,r,u),i=!0},p(s,u){const c={};2048&u&&(c.keybinding=s[11].rejectAllChunks),t.$set(c)},i(s){i||(O(t.$$.fragment,s),i=!0)},o(s){U(t.$$.fragment,s),i=!1},d(s){s&&ie(r),Y(t,s)}}}function Gg(o){let t,r,i,s,u,c,h,f=o[9]&&dh(o);const v=[Pg,zg,qg],_=[];function b(E,T){return!E[5]&&E[10]?0:E[5]?1:2}s=b(o),u=_[s]=v[s](o);let x=o[5]&&ph(o);return{c(){t=We("div"),r=We("div"),f&&f.c(),i=Ue(),u.c(),c=Ue(),x&&x.c(),De(r,"class","c-button-container svelte-4zjwll"),De(t,"class","c-top-action-panel-anchor svelte-4zjwll")},m(E,T){re(E,t,T),He(t,r),f&&f.m(r,null),He(r,i),_[s].m(r,null),He(r,c),x&&x.m(r,null),h=!0},p(E,[T]){E[9]?f?(f.p(E,T),512&T&&O(f,1)):(f=dh(E),f.c(),O(f,1),f.m(r,i)):f&&($t(),U(f,1,1,()=>{f=null}),wt());let q=s;s=b(E),s===q?_[s].p(E,T):($t(),U(_[q],1,1,()=>{_[q]=null}),wt(),u=_[s],u?u.p(E,T):(u=_[s]=v[s](E),u.c()),O(u,1),u.m(r,c)),E[5]?x?(x.p(E,T),32&T&&O(x,1)):(x=ph(E),x.c(),O(x,1),x.m(r,null)):x&&($t(),U(x,1,1,()=>{x=null}),wt())},i(E){h||(O(f),O(u),O(x),h=!0)},o(E){U(f),U(u),U(x),h=!1},d(E){E&&ie(t),f&&f.d(),_[s].d(),x&&x.d()}}}function Zg(o,t,r){let i,s,u,c,h,f,v,_,b,x,E=Be,T=()=>(E(),E=ar(F,_e=>r(1,f=_e)),F),q=Be,L=Be,S=Be;o.$$.on_destroy.push(()=>E()),o.$$.on_destroy.push(()=>q()),o.$$.on_destroy.push(()=>L()),o.$$.on_destroy.push(()=>S());let{diffViewModel:F}=t;T();const ne=F.keybindings;si(o,ne,_e=>r(11,_=_e));const de=F.requestId;si(o,de,_e=>r(9,h=_e));let oe,Re="x",pe="Copy request ID",Ie=()=>{};return o.$$set=_e=>{"diffViewModel"in _e&&T(r(0,F=_e.diffViewModel))},o.$$.update=()=>{var _e;2&o.$$.dirty&&(r(8,i=f.disableResolution),L(),L=ar(i,Fe=>r(12,b=Fe))),2&o.$$.dirty&&(r(7,s=f.disableApply),S(),S=ar(s,Fe=>r(13,x=Fe))),2&o.$$.dirty&&(f.currFocusedChunkIdx!==void 0?r(2,Re=(f.currFocusedChunkIdx+1).toString()):r(2,Re="x")),2&o.$$.dirty&&(r(6,u=f.isLoading),q(),q=ar(u,Fe=>r(10,v=Fe))),2&o.$$.dirty&&r(5,c=!!((_e=f.leaves)!=null&&_e.length))},[F,f,Re,pe,Ie,c,u,s,i,h,v,_,b,x,ne,de,function(_e){_e||(clearTimeout(oe),oe=void 0,r(3,pe="Copy request ID"))},async function(){h&&(await navigator.clipboard.writeText(h),r(3,pe="Copied!"),clearTimeout(oe),oe=setTimeout(Ie,1500))},function(_e){Ie=_e,r(4,Ie)}]}class Yg extends oi{constructor(t){super(),ai(this,t,Zg,Gg,ui,{diffViewModel:0})}}var Wo,Ho,Pu={exports:{}};Wo=Pu,Ho=Pu.exports,(function(){var o,t="Expected a function",r="__lodash_hash_undefined__",i="__lodash_placeholder__",s=16,u=32,c=64,h=128,f=256,v=1/0,_=9007199254740991,b=NaN,x=4294967295,E=[["ary",h],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",u],["partialRight",c],["rearg",f]],T="[object Arguments]",q="[object Array]",L="[object Boolean]",S="[object Date]",F="[object Error]",ne="[object Function]",de="[object GeneratorFunction]",oe="[object Map]",Re="[object Number]",pe="[object Object]",Ie="[object Promise]",_e="[object RegExp]",Fe="[object Set]",Pe="[object String]",st="[object Symbol]",Se="[object WeakMap]",we="[object ArrayBuffer]",at="[object DataView]",_n="[object Float32Array]",Ct="[object Float64Array]",fe="[object Int8Array]",mn="[object Int16Array]",Tn="[object Int32Array]",Bn="[object Uint8Array]",fr="[object Uint8ClampedArray]",li="[object Uint16Array]",Wi="[object Uint32Array]",ra=/\b__p \+= '';/g,ia=/\b(__p \+=) '' \+/g,Fs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Hi=/&(?:amp|lt|gt|quot|#39);/g,Bi=/[&<>"']/g,sa=RegExp(Hi.source),oa=RegExp(Bi.source),hi=/<%-([\s\S]+?)%>/g,Vi=/<%([\s\S]+?)%>/g,Gi=/<%=([\s\S]+?)%>/g,rn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Os=/^\w*$/,Ls=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zi=/[\\^$.*+?()[\]{}|]/g,Ns=RegExp(Zi.source),dr=/^\s+/,Rs=/\s/,js=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,aa=/\{\n\/\* \[wrapped with (.+)\] \*/,Vn=/,? & /,Ds=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ua=/[()=,{}\[\]\/\s]/,ca=/\\(\\)?/g,Yi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pr=/\w*$/,Ji=/^[-+]0x[0-9a-f]+$/i,Qi=/^0b[01]+$/i,Xi=/^\[object .+?Constructor\]$/,Ur=/^0o[0-7]+$/i,la=/^(?:0|[1-9]\d*)$/,ha=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fi=/($^)/,fa=/['\n\r\u2028\u2029\\]/g,di="\\ud800-\\udfff",Ki="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pi="\\u2700-\\u27bf",Fn="a-z\\xdf-\\xf6\\xf8-\\xff",sn="A-Z\\xc0-\\xd6\\xd8-\\xde",On="\\ufe0e\\ufe0f",qr="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ln="['’]",da="["+di+"]",zr="["+qr+"]",Nn="["+Ki+"]",es="\\d+",Us="["+pi+"]",qs="["+Fn+"]",zs="[^"+di+qr+es+pi+Fn+sn+"]",gi="\\ud83c[\\udffb-\\udfff]",ts="[^"+di+"]",gr="(?:\\ud83c[\\udde6-\\uddff]){2}",Rn="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+sn+"]",vn="\\u200d",Ps="(?:"+qs+"|"+zs+")",Gn="(?:"+_r+"|"+zs+")",ns="(?:['’](?:d|ll|m|re|s|t|ve))?",Ws="(?:['’](?:D|LL|M|RE|S|T|VE))?",Pr="(?:"+Nn+"|"+gi+")?",_i="["+On+"]?",rs=_i+Pr+"(?:"+vn+"(?:"+[ts,gr,Rn].join("|")+")"+_i+Pr+")*",Hs="(?:"+[Us,gr,Rn].join("|")+")"+rs,Bs="(?:"+[ts+Nn+"?",Nn,gr,Rn,da].join("|")+")",Wr=RegExp(Ln,"g"),Vs=RegExp(Nn,"g"),is=RegExp(gi+"(?="+gi+")|"+Bs+rs,"g"),C=RegExp([_r+"?"+qs+"+"+ns+"(?="+[zr,_r,"$"].join("|")+")",Gn+"+"+Ws+"(?="+[zr,_r+Ps,"$"].join("|")+")",_r+"?"+Ps+"+"+ns,_r+"+"+Ws,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",es,Hs].join("|"),"g"),k=RegExp("["+vn+di+Ki+On+"]"),W=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ee=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qe=-1,X={};X[_n]=X[Ct]=X[fe]=X[mn]=X[Tn]=X[Bn]=X[fr]=X[li]=X[Wi]=!0,X[T]=X[q]=X[we]=X[L]=X[at]=X[S]=X[F]=X[ne]=X[oe]=X[Re]=X[pe]=X[_e]=X[Fe]=X[Pe]=X[Se]=!1;var he={};he[T]=he[q]=he[we]=he[at]=he[L]=he[S]=he[_n]=he[Ct]=he[fe]=he[mn]=he[Tn]=he[oe]=he[Re]=he[pe]=he[_e]=he[Fe]=he[Pe]=he[st]=he[Bn]=he[fr]=he[li]=he[Wi]=!0,he[F]=he[ne]=he[Se]=!1;var Qe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ht=parseFloat,tt=parseInt,Xe=typeof tn=="object"&&tn&&tn.Object===Object&&tn,on=typeof self=="object"&&self&&self.Object===Object&&self,ze=Xe||on||Function("return this")(),ut=Ho&&!Ho.nodeType&&Ho,St=ut&&Wo&&!Wo.nodeType&&Wo,Zn=St&&St.exports===ut,mr=Zn&&Xe.process,ct=function(){try{var M=St&&St.require&&St.require("util").types;return M||mr&&mr.binding&&mr.binding("util")}catch{}}(),vr=ct&&ct.isArrayBuffer,ss=ct&&ct.isDate,Gs=ct&&ct.isMap,Zs=ct&&ct.isRegExp,Oe=ct&&ct.isSet,Ae=ct&&ct.isTypedArray;function gt(M,j,D){switch(D.length){case 0:return M.call(j);case 1:return M.call(j,D[0]);case 2:return M.call(j,D[0],D[1]);case 3:return M.call(j,D[0],D[1],D[2])}return M.apply(j,D)}function jn(M,j,D,V){for(var me=-1,Me=M==null?0:M.length;++me<Me;){var lt=M[me];j(V,lt,D(lt),M)}return V}function kt(M,j){for(var D=-1,V=M==null?0:M.length;++D<V&&j(M[D],D,M)!==!1;);return M}function Ut(M,j){for(var D=M==null?0:M.length;D--&&j(M[D],D,M)!==!1;);return M}function an(M,j){for(var D=-1,V=M==null?0:M.length;++D<V;)if(!j(M[D],D,M))return!1;return!0}function It(M,j){for(var D=-1,V=M==null?0:M.length,me=0,Me=[];++D<V;){var lt=M[D];j(lt,D,M)&&(Me[me++]=lt)}return Me}function Dn(M,j){return!(M==null||!M.length)&&Jn(M,j,0)>-1}function yr(M,j,D){for(var V=-1,me=M==null?0:M.length;++V<me;)if(D(j,M[V]))return!0;return!1}function je(M,j){for(var D=-1,V=M==null?0:M.length,me=Array(V);++D<V;)me[D]=j(M[D],D,M);return me}function Bt(M,j){for(var D=-1,V=j.length,me=M.length;++D<V;)M[me+D]=j[D];return M}function yn(M,j,D,V){var me=-1,Me=M==null?0:M.length;for(V&&Me&&(D=M[++me]);++me<Me;)D=j(D,M[me],me,M);return D}function Ys(M,j,D,V){var me=M==null?0:M.length;for(V&&me&&(D=M[--me]);me--;)D=j(D,M[me],me,M);return D}function br(M,j){for(var D=-1,V=M==null?0:M.length;++D<V;)if(j(M[D],D,M))return!0;return!1}var os=pa("length");function Hr(M,j,D){var V;return D(M,function(me,Me,lt){if(j(me,Me,lt))return V=Me,!1}),V}function Yn(M,j,D,V){for(var me=M.length,Me=D+(V?1:-1);V?Me--:++Me<me;)if(j(M[Me],Me,M))return Me;return-1}function Jn(M,j,D){return j==j?function(V,me,Me){for(var lt=Me-1,Un=V.length;++lt<Un;)if(V[lt]===me)return lt;return-1}(M,j,D):Yn(M,Br,D)}function mi(M,j,D,V){for(var me=D-1,Me=M.length;++me<Me;)if(V(M[me],j))return me;return-1}function Br(M){return M!=M}function nc(M,j){var D=M==null?0:M.length;return D?_a(M,j)/D:b}function pa(M){return function(j){return j==null?o:j[M]}}function ga(M){return function(j){return M==null?o:M[j]}}function rc(M,j,D,V,me){return me(M,function(Me,lt,Un){D=V?(V=!1,Me):j(D,Me,lt,Un)}),D}function _a(M,j){for(var D,V=-1,me=M.length;++V<me;){var Me=j(M[V]);Me!==o&&(D=D===o?Me:D+Me)}return D}function ma(M,j){for(var D=-1,V=Array(M);++D<M;)V[D]=j(D);return V}function ic(M){return M&&M.slice(0,uc(M)+1).replace(dr,"")}function Vt(M){return function(j){return M(j)}}function va(M,j){return je(j,function(D){return M[D]})}function as(M,j){return M.has(j)}function sc(M,j){for(var D=-1,V=M.length;++D<V&&Jn(j,M[D],0)>-1;);return D}function oc(M,j){for(var D=M.length;D--&&Jn(j,M[D],0)>-1;);return D}var cf=ga({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),lf=ga({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function hf(M){return"\\"+Qe[M]}function vi(M){return k.test(M)}function ya(M){var j=-1,D=Array(M.size);return M.forEach(function(V,me){D[++j]=[me,V]}),D}function ac(M,j){return function(D){return M(j(D))}}function $r(M,j){for(var D=-1,V=M.length,me=0,Me=[];++D<V;){var lt=M[D];lt!==j&&lt!==i||(M[D]=i,Me[me++]=D)}return Me}function Js(M){var j=-1,D=Array(M.size);return M.forEach(function(V){D[++j]=V}),D}function ff(M){var j=-1,D=Array(M.size);return M.forEach(function(V){D[++j]=[V,V]}),D}function yi(M){return vi(M)?function(j){for(var D=is.lastIndex=0;is.test(j);)++D;return D}(M):os(M)}function bn(M){return vi(M)?function(j){return j.match(is)||[]}(M):function(j){return j.split("")}(M)}function uc(M){for(var j=M.length;j--&&Rs.test(M.charAt(j)););return j}var df=ga({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),bi=function M(j){var D,V=(j=j==null?ze:bi.defaults(ze.Object(),j,bi.pick(ze,ee))).Array,me=j.Date,Me=j.Error,lt=j.Function,Un=j.Math,Ve=j.Object,ba=j.RegExp,pf=j.String,un=j.TypeError,Qs=V.prototype,gf=lt.prototype,$i=Ve.prototype,Xs=j["__core-js_shared__"],Ks=gf.toString,Ne=$i.hasOwnProperty,_f=0,cc=(D=/[^.]+$/.exec(Xs&&Xs.keys&&Xs.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"",eo=$i.toString,mf=Ks.call(Ve),vf=ze._,yf=ba("^"+Ks.call(Ne).replace(Zi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),to=Zn?j.Buffer:o,wr=j.Symbol,no=j.Uint8Array,lc=to?to.allocUnsafe:o,ro=ac(Ve.getPrototypeOf,Ve),hc=Ve.create,fc=$i.propertyIsEnumerable,io=Qs.splice,dc=wr?wr.isConcatSpreadable:o,us=wr?wr.iterator:o,Vr=wr?wr.toStringTag:o,so=function(){try{var e=Qr(Ve,"defineProperty");return e({},"",{}),e}catch{}}(),bf=j.clearTimeout!==ze.clearTimeout&&j.clearTimeout,$f=me&&me.now!==ze.Date.now&&me.now,wf=j.setTimeout!==ze.setTimeout&&j.setTimeout,oo=Un.ceil,ao=Un.floor,$a=Ve.getOwnPropertySymbols,xf=to?to.isBuffer:o,pc=j.isFinite,Cf=Qs.join,Sf=ac(Ve.keys,Ve),ht=Un.max,At=Un.min,If=me.now,Ef=j.parseInt,gc=Un.random,Mf=Qs.reverse,wa=Qr(j,"DataView"),cs=Qr(j,"Map"),xa=Qr(j,"Promise"),wi=Qr(j,"Set"),ls=Qr(j,"WeakMap"),hs=Qr(Ve,"create"),uo=ls&&new ls,xi={},kf=Xr(wa),Af=Xr(cs),Tf=Xr(xa),Ff=Xr(wi),Of=Xr(ls),co=wr?wr.prototype:o,fs=co?co.valueOf:o,_c=co?co.toString:o;function p(e){if(Ke(e)&&!$e(e)&&!(e instanceof Ee)){if(e instanceof cn)return e;if(Ne.call(e,"__wrapped__"))return ml(e)}return new cn(e)}var Ci=function(){function e(){}return function(n){if(!Je(n))return{};if(hc)return hc(n);e.prototype=n;var a=new e;return e.prototype=o,a}}();function lo(){}function cn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=o}function Ee(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=x,this.__views__=[]}function Gr(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var l=e[n];this.set(l[0],l[1])}}function Qn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var l=e[n];this.set(l[0],l[1])}}function Xn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var l=e[n];this.set(l[0],l[1])}}function Zr(e){var n=-1,a=e==null?0:e.length;for(this.__data__=new Xn;++n<a;)this.add(e[n])}function $n(e){var n=this.__data__=new Qn(e);this.size=n.size}function mc(e,n){var a=$e(e),l=!a&&Kr(e),d=!a&&!l&&Er(e),g=!a&&!l&&!d&&Mi(e),$=a||l||d||g,w=$?ma(e.length,pf):[],I=w.length;for(var N in e)!n&&!Ne.call(e,N)||$&&(N=="length"||d&&(N=="offset"||N=="parent")||g&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||nr(N,I))||w.push(N);return w}function vc(e){var n=e.length;return n?e[La(0,n-1)]:o}function Lf(e,n){return So(qt(e),Yr(n,0,e.length))}function Nf(e){return So(qt(e))}function Ca(e,n,a){(a!==o&&!wn(e[n],a)||a===o&&!(n in e))&&Kn(e,n,a)}function ds(e,n,a){var l=e[n];Ne.call(e,n)&&wn(l,a)&&(a!==o||n in e)||Kn(e,n,a)}function ho(e,n){for(var a=e.length;a--;)if(wn(e[a][0],n))return a;return-1}function Rf(e,n,a,l){return xr(e,function(d,g,$){n(l,d,a(d),$)}),l}function yc(e,n){return e&&zn(n,_t(n),e)}function Kn(e,n,a){n=="__proto__"&&so?so(e,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[n]=a}function Sa(e,n){for(var a=-1,l=n.length,d=V(l),g=e==null;++a<l;)d[a]=g?o:su(e,n[a]);return d}function Yr(e,n,a){return e==e&&(a!==o&&(e=e<=a?e:a),n!==o&&(e=e>=n?e:n)),e}function ln(e,n,a,l,d,g){var $,w=1&n,I=2&n,N=4&n;if(a&&($=d?a(e,l,d,g):a(e)),$!==o)return $;if(!Je(e))return e;var A=$e(e);if(A){if($=function(R){var P=R.length,ce=new R.constructor(P);return P&&typeof R[0]=="string"&&Ne.call(R,"index")&&(ce.index=R.index,ce.input=R.input),ce}(e),!w)return qt(e,$)}else{var z=Tt(e),Q=z==ne||z==de;if(Er(e))return Wc(e,w);if(z==pe||z==T||Q&&!d){if($=I||Q?{}:ul(e),!w)return I?function(R,P){return zn(R,ol(R),P)}(e,function(R,P){return R&&zn(P,Pt(P),R)}($,e)):function(R,P){return zn(R,Za(R),P)}(e,yc($,e))}else{if(!he[z])return d?e:{};$=function(R,P,ce){var B,ye=R.constructor;switch(P){case we:return za(R);case L:case S:return new ye(+R);case at:return function(ge,Te){var te=Te?za(ge.buffer):ge.buffer;return new ge.constructor(te,ge.byteOffset,ge.byteLength)}(R,ce);case _n:case Ct:case fe:case mn:case Tn:case Bn:case fr:case li:case Wi:return Hc(R,ce);case oe:return new ye;case Re:case Pe:return new ye(R);case _e:return function(ge){var Te=new ge.constructor(ge.source,pr.exec(ge));return Te.lastIndex=ge.lastIndex,Te}(R);case Fe:return new ye;case st:return B=R,fs?Ve(fs.call(B)):{}}}(e,z,w)}}g||(g=new $n);var K=g.get(e);if(K)return K;g.set(e,$),Nl(e)?e.forEach(function(R){$.add(ln(R,n,a,R,e,g))}):Ol(e)&&e.forEach(function(R,P){$.set(P,ln(R,n,a,P,e,g))});var se=A?o:(N?I?Ba:Ha:I?Pt:_t)(e);return kt(se||e,function(R,P){se&&(R=e[P=R]),ds($,P,ln(R,n,a,P,e,g))}),$}function bc(e,n,a){var l=a.length;if(e==null)return!l;for(e=Ve(e);l--;){var d=a[l],g=n[d],$=e[d];if($===o&&!(d in e)||!g($))return!1}return!0}function $c(e,n,a){if(typeof e!="function")throw new un(t);return bs(function(){e.apply(o,a)},n)}function ps(e,n,a,l){var d=-1,g=Dn,$=!0,w=e.length,I=[],N=n.length;if(!w)return I;a&&(n=je(n,Vt(a))),l?(g=yr,$=!1):n.length>=200&&(g=as,$=!1,n=new Zr(n));e:for(;++d<w;){var A=e[d],z=a==null?A:a(A);if(A=l||A!==0?A:0,$&&z==z){for(var Q=N;Q--;)if(n[Q]===z)continue e;I.push(A)}else g(n,z,l)||I.push(A)}return I}p.templateSettings={escape:hi,evaluate:Vi,interpolate:Gi,variable:"",imports:{_:p}},p.prototype=lo.prototype,p.prototype.constructor=p,cn.prototype=Ci(lo.prototype),cn.prototype.constructor=cn,Ee.prototype=Ci(lo.prototype),Ee.prototype.constructor=Ee,Gr.prototype.clear=function(){this.__data__=hs?hs(null):{},this.size=0},Gr.prototype.delete=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},Gr.prototype.get=function(e){var n=this.__data__;if(hs){var a=n[e];return a===r?o:a}return Ne.call(n,e)?n[e]:o},Gr.prototype.has=function(e){var n=this.__data__;return hs?n[e]!==o:Ne.call(n,e)},Gr.prototype.set=function(e,n){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=hs&&n===o?r:n,this},Qn.prototype.clear=function(){this.__data__=[],this.size=0},Qn.prototype.delete=function(e){var n=this.__data__,a=ho(n,e);return!(a<0||(a==n.length-1?n.pop():io.call(n,a,1),--this.size,0))},Qn.prototype.get=function(e){var n=this.__data__,a=ho(n,e);return a<0?o:n[a][1]},Qn.prototype.has=function(e){return ho(this.__data__,e)>-1},Qn.prototype.set=function(e,n){var a=this.__data__,l=ho(a,e);return l<0?(++this.size,a.push([e,n])):a[l][1]=n,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Gr,map:new(cs||Qn),string:new Gr}},Xn.prototype.delete=function(e){var n=Co(this,e).delete(e);return this.size-=n?1:0,n},Xn.prototype.get=function(e){return Co(this,e).get(e)},Xn.prototype.has=function(e){return Co(this,e).has(e)},Xn.prototype.set=function(e,n){var a=Co(this,e),l=a.size;return a.set(e,n),this.size+=a.size==l?0:1,this},Zr.prototype.add=Zr.prototype.push=function(e){return this.__data__.set(e,r),this},Zr.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Qn,this.size=0},$n.prototype.delete=function(e){var n=this.__data__,a=n.delete(e);return this.size=n.size,a},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,n){var a=this.__data__;if(a instanceof Qn){var l=a.__data__;if(!cs||l.length<199)return l.push([e,n]),this.size=++a.size,this;a=this.__data__=new Xn(l)}return a.set(e,n),this.size=a.size,this};var xr=Zc(qn),wc=Zc(Ea,!0);function jf(e,n){var a=!0;return xr(e,function(l,d,g){return a=!!n(l,d,g)}),a}function fo(e,n,a){for(var l=-1,d=e.length;++l<d;){var g=e[l],$=n(g);if($!=null&&(w===o?$==$&&!Zt($):a($,w)))var w=$,I=g}return I}function xc(e,n){var a=[];return xr(e,function(l,d,g){n(l,d,g)&&a.push(l)}),a}function Et(e,n,a,l,d){var g=-1,$=e.length;for(a||(a=Yf),d||(d=[]);++g<$;){var w=e[g];n>0&&a(w)?n>1?Et(w,n-1,a,l,d):Bt(d,w):l||(d[d.length]=w)}return d}var Ia=Yc(),Cc=Yc(!0);function qn(e,n){return e&&Ia(e,n,_t)}function Ea(e,n){return e&&Cc(e,n,_t)}function po(e,n){return It(n,function(a){return rr(e[a])})}function Jr(e,n){for(var a=0,l=(n=Sr(n,e)).length;e!=null&&a<l;)e=e[Pn(n[a++])];return a&&a==l?e:o}function Sc(e,n,a){var l=n(e);return $e(e)?l:Bt(l,a(e))}function Lt(e){return e==null?e===o?"[object Undefined]":"[object Null]":Vr&&Vr in Ve(e)?function(n){var a=Ne.call(n,Vr),l=n[Vr];try{n[Vr]=o;var d=!0}catch{}var g=eo.call(n);return d&&(a?n[Vr]=l:delete n[Vr]),g}(e):function(n){return eo.call(n)}(e)}function Ma(e,n){return e>n}function Df(e,n){return e!=null&&Ne.call(e,n)}function Uf(e,n){return e!=null&&n in Ve(e)}function ka(e,n,a){for(var l=a?yr:Dn,d=e[0].length,g=e.length,$=g,w=V(g),I=1/0,N=[];$--;){var A=e[$];$&&n&&(A=je(A,Vt(n))),I=At(A.length,I),w[$]=!a&&(n||d>=120&&A.length>=120)?new Zr($&&A):o}A=e[0];var z=-1,Q=w[0];e:for(;++z<d&&N.length<I;){var K=A[z],se=n?n(K):K;if(K=a||K!==0?K:0,!(Q?as(Q,se):l(N,se,a))){for($=g;--$;){var R=w[$];if(!(R?as(R,se):l(e[$],se,a)))continue e}Q&&Q.push(se),N.push(K)}}return N}function gs(e,n,a){var l=(e=fl(e,n=Sr(n,e)))==null?e:e[Pn(fn(n))];return l==null?o:gt(l,e,a)}function Ic(e){return Ke(e)&&Lt(e)==T}function _s(e,n,a,l,d){return e===n||(e==null||n==null||!Ke(e)&&!Ke(n)?e!=e&&n!=n:function(g,$,w,I,N,A){var z=$e(g),Q=$e($),K=z?q:Tt(g),se=Q?q:Tt($),R=(K=K==T?pe:K)==pe,P=(se=se==T?pe:se)==pe,ce=K==se;if(ce&&Er(g)){if(!Er($))return!1;z=!0,R=!1}if(ce&&!R)return A||(A=new $n),z||Mi(g)?sl(g,$,w,I,N,A):function(te,le,ft,rt,Rt,Ge,Ft){switch(ft){case at:if(te.byteLength!=le.byteLength||te.byteOffset!=le.byteOffset)return!1;te=te.buffer,le=le.buffer;case we:return!(te.byteLength!=le.byteLength||!Ge(new no(te),new no(le)));case L:case S:case Re:return wn(+te,+le);case F:return te.name==le.name&&te.message==le.message;case _e:case Pe:return te==le+"";case oe:var Wn=ya;case Fe:var Mr=1&rt;if(Wn||(Wn=Js),te.size!=le.size&&!Mr)return!1;var Lo=Ft.get(te);if(Lo)return Lo==le;rt|=2,Ft.set(te,le);var gu=sl(Wn(te),Wn(le),rt,Rt,Ge,Ft);return Ft.delete(te),gu;case st:if(fs)return fs.call(te)==fs.call(le)}return!1}(g,$,K,w,I,N,A);if(!(1&w)){var B=R&&Ne.call(g,"__wrapped__"),ye=P&&Ne.call($,"__wrapped__");if(B||ye){var ge=B?g.value():g,Te=ye?$.value():$;return A||(A=new $n),N(ge,Te,w,I,A)}}return!!ce&&(A||(A=new $n),function(te,le,ft,rt,Rt,Ge){var Ft=1&ft,Wn=Ha(te),Mr=Wn.length,Lo=Ha(le),gu=Lo.length;if(Mr!=gu&&!Ft)return!1;for(var No=Mr;No--;){var ei=Wn[No];if(!(Ft?ei in le:Ne.call(le,ei)))return!1}var Yl=Ge.get(te),Jl=Ge.get(le);if(Yl&&Jl)return Yl==le&&Jl==te;var Ro=!0;Ge.set(te,le),Ge.set(le,te);for(var _u=Ft;++No<Mr;){var jo=te[ei=Wn[No]],Do=le[ei];if(rt)var Ql=Ft?rt(Do,jo,ei,le,te,Ge):rt(jo,Do,ei,te,le,Ge);if(!(Ql===o?jo===Do||Rt(jo,Do,ft,rt,Ge):Ql)){Ro=!1;break}_u||(_u=ei=="constructor")}if(Ro&&!_u){var Uo=te.constructor,qo=le.constructor;Uo==qo||!("constructor"in te)||!("constructor"in le)||typeof Uo=="function"&&Uo instanceof Uo&&typeof qo=="function"&&qo instanceof qo||(Ro=!1)}return Ge.delete(te),Ge.delete(le),Ro}(g,$,w,I,N,A))}(e,n,a,l,_s,d))}function Aa(e,n,a,l){var d=a.length,g=d,$=!l;if(e==null)return!g;for(e=Ve(e);d--;){var w=a[d];if($&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++d<g;){var I=(w=a[d])[0],N=e[I],A=w[1];if($&&w[2]){if(N===o&&!(I in e))return!1}else{var z=new $n;if(l)var Q=l(N,A,I,e,n,z);if(!(Q===o?_s(A,N,3,l,z):Q))return!1}}return!0}function Ec(e){return!(!Je(e)||(n=e,cc&&cc in n))&&(rr(e)?yf:Xi).test(Xr(e));var n}function Mc(e){return typeof e=="function"?e:e==null?Wt:typeof e=="object"?$e(e)?Tc(e[0],e[1]):Ac(e):Zl(e)}function Ta(e){if(!ys(e))return Sf(e);var n=[];for(var a in Ve(e))Ne.call(e,a)&&a!="constructor"&&n.push(a);return n}function qf(e){if(!Je(e))return function(d){var g=[];if(d!=null)for(var $ in Ve(d))g.push($);return g}(e);var n=ys(e),a=[];for(var l in e)(l!="constructor"||!n&&Ne.call(e,l))&&a.push(l);return a}function Fa(e,n){return e<n}function kc(e,n){var a=-1,l=zt(e)?V(e.length):[];return xr(e,function(d,g,$){l[++a]=n(d,g,$)}),l}function Ac(e){var n=Ga(e);return n.length==1&&n[0][2]?ll(n[0][0],n[0][1]):function(a){return a===e||Aa(a,e,n)}}function Tc(e,n){return Ya(e)&&cl(n)?ll(Pn(e),n):function(a){var l=su(a,e);return l===o&&l===n?ou(a,e):_s(n,l,3)}}function go(e,n,a,l,d){e!==n&&Ia(n,function(g,$){if(d||(d=new $n),Je(g))(function(I,N,A,z,Q,K,se){var R=Qa(I,A),P=Qa(N,A),ce=se.get(P);if(ce)Ca(I,A,ce);else{var B=K?K(R,P,A+"",I,N,se):o,ye=B===o;if(ye){var ge=$e(P),Te=!ge&&Er(P),te=!ge&&!Te&&Mi(P);B=P,ge||Te||te?$e(R)?B=R:nt(R)?B=qt(R):Te?(ye=!1,B=Wc(P,!0)):te?(ye=!1,B=Hc(P,!0)):B=[]:$s(P)||Kr(P)?(B=R,Kr(R)?B=Dl(R):Je(R)&&!rr(R)||(B=ul(P))):ye=!1}ye&&(se.set(P,B),Q(B,P,z,K,se),se.delete(P)),Ca(I,A,B)}})(e,n,$,a,go,l,d);else{var w=l?l(Qa(e,$),g,$+"",e,n,d):o;w===o&&(w=g),Ca(e,$,w)}},Pt)}function Fc(e,n){var a=e.length;if(a)return nr(n+=n<0?a:0,a)?e[n]:o}function Oc(e,n,a){n=n.length?je(n,function(g){return $e(g)?function($){return Jr($,g.length===1?g[0]:g)}:g}):[Wt];var l=-1;n=je(n,Vt(ae()));var d=kc(e,function(g,$,w){var I=je(n,function(N){return N(g)});return{criteria:I,index:++l,value:g}});return function(g,$){var w=g.length;for(g.sort($);w--;)g[w]=g[w].value;return g}(d,function(g,$){return function(w,I,N){for(var A=-1,z=w.criteria,Q=I.criteria,K=z.length,se=N.length;++A<K;){var R=Bc(z[A],Q[A]);if(R)return A>=se?R:R*(N[A]=="desc"?-1:1)}return w.index-I.index}(g,$,a)})}function Lc(e,n,a){for(var l=-1,d=n.length,g={};++l<d;){var $=n[l],w=Jr(e,$);a(w,$)&&ms(g,Sr($,e),w)}return g}function Oa(e,n,a,l){var d=l?mi:Jn,g=-1,$=n.length,w=e;for(e===n&&(n=qt(n)),a&&(w=je(e,Vt(a)));++g<$;)for(var I=0,N=n[g],A=a?a(N):N;(I=d(w,A,I,l))>-1;)w!==e&&io.call(w,I,1),io.call(e,I,1);return e}function Nc(e,n){for(var a=e?n.length:0,l=a-1;a--;){var d=n[a];if(a==l||d!==g){var g=d;nr(d)?io.call(e,d,1):ja(e,d)}}return e}function La(e,n){return e+ao(gc()*(n-e+1))}function Na(e,n){var a="";if(!e||n<1||n>_)return a;do n%2&&(a+=e),(n=ao(n/2))&&(e+=e);while(n);return a}function Ce(e,n){return Xa(hl(e,n,Wt),e+"")}function zf(e){return vc(ki(e))}function Pf(e,n){var a=ki(e);return So(a,Yr(n,0,a.length))}function ms(e,n,a,l){if(!Je(e))return e;for(var d=-1,g=(n=Sr(n,e)).length,$=g-1,w=e;w!=null&&++d<g;){var I=Pn(n[d]),N=a;if(I==="__proto__"||I==="constructor"||I==="prototype")return e;if(d!=$){var A=w[I];(N=l?l(A,I,w):o)===o&&(N=Je(A)?A:nr(n[d+1])?[]:{})}ds(w,I,N),w=w[I]}return e}var Rc=uo?function(e,n){return uo.set(e,n),e}:Wt,Wf=so?function(e,n){return so(e,"toString",{configurable:!0,enumerable:!1,value:uu(n),writable:!0})}:Wt;function Hf(e){return So(ki(e))}function hn(e,n,a){var l=-1,d=e.length;n<0&&(n=-n>d?0:d+n),(a=a>d?d:a)<0&&(a+=d),d=n>a?0:a-n>>>0,n>>>=0;for(var g=V(d);++l<d;)g[l]=e[l+n];return g}function Bf(e,n){var a;return xr(e,function(l,d,g){return!(a=n(l,d,g))}),!!a}function _o(e,n,a){var l=0,d=e==null?l:e.length;if(typeof n=="number"&&n==n&&d<=2147483647){for(;l<d;){var g=l+d>>>1,$=e[g];$!==null&&!Zt($)&&(a?$<=n:$<n)?l=g+1:d=g}return d}return Ra(e,n,Wt,a)}function Ra(e,n,a,l){var d=0,g=e==null?0:e.length;if(g===0)return 0;for(var $=(n=a(n))!=n,w=n===null,I=Zt(n),N=n===o;d<g;){var A=ao((d+g)/2),z=a(e[A]),Q=z!==o,K=z===null,se=z==z,R=Zt(z);if($)var P=l||se;else P=N?se&&(l||Q):w?se&&Q&&(l||!K):I?se&&Q&&!K&&(l||!R):!K&&!R&&(l?z<=n:z<n);P?d=A+1:g=A}return At(g,4294967294)}function jc(e,n){for(var a=-1,l=e.length,d=0,g=[];++a<l;){var $=e[a],w=n?n($):$;if(!a||!wn(w,I)){var I=w;g[d++]=$===0?0:$}}return g}function Dc(e){return typeof e=="number"?e:Zt(e)?b:+e}function Gt(e){if(typeof e=="string")return e;if($e(e))return je(e,Gt)+"";if(Zt(e))return _c?_c.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function Cr(e,n,a){var l=-1,d=Dn,g=e.length,$=!0,w=[],I=w;if(a)$=!1,d=yr;else if(g>=200){var N=n?null:Gf(e);if(N)return Js(N);$=!1,d=as,I=new Zr}else I=n?[]:w;e:for(;++l<g;){var A=e[l],z=n?n(A):A;if(A=a||A!==0?A:0,$&&z==z){for(var Q=I.length;Q--;)if(I[Q]===z)continue e;n&&I.push(z),w.push(A)}else d(I,z,a)||(I!==w&&I.push(z),w.push(A))}return w}function ja(e,n){return(e=fl(e,n=Sr(n,e)))==null||delete e[Pn(fn(n))]}function Uc(e,n,a,l){return ms(e,n,a(Jr(e,n)),l)}function mo(e,n,a,l){for(var d=e.length,g=l?d:-1;(l?g--:++g<d)&&n(e[g],g,e););return a?hn(e,l?0:g,l?g+1:d):hn(e,l?g+1:0,l?d:g)}function qc(e,n){var a=e;return a instanceof Ee&&(a=a.value()),yn(n,function(l,d){return d.func.apply(d.thisArg,Bt([l],d.args))},a)}function Da(e,n,a){var l=e.length;if(l<2)return l?Cr(e[0]):[];for(var d=-1,g=V(l);++d<l;)for(var $=e[d],w=-1;++w<l;)w!=d&&(g[d]=ps(g[d]||$,e[w],n,a));return Cr(Et(g,1),n,a)}function zc(e,n,a){for(var l=-1,d=e.length,g=n.length,$={};++l<d;){var w=l<g?n[l]:o;a($,e[l],w)}return $}function Ua(e){return nt(e)?e:[]}function qa(e){return typeof e=="function"?e:Wt}function Sr(e,n){return $e(e)?e:Ya(e,n)?[e]:_l(Le(e))}var Vf=Ce;function Ir(e,n,a){var l=e.length;return a=a===o?l:a,!n&&a>=l?e:hn(e,n,a)}var Pc=bf||function(e){return ze.clearTimeout(e)};function Wc(e,n){if(n)return e.slice();var a=e.length,l=lc?lc(a):new e.constructor(a);return e.copy(l),l}function za(e){var n=new e.constructor(e.byteLength);return new no(n).set(new no(e)),n}function Hc(e,n){var a=n?za(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Bc(e,n){if(e!==n){var a=e!==o,l=e===null,d=e==e,g=Zt(e),$=n!==o,w=n===null,I=n==n,N=Zt(n);if(!w&&!N&&!g&&e>n||g&&$&&I&&!w&&!N||l&&$&&I||!a&&I||!d)return 1;if(!l&&!g&&!N&&e<n||N&&a&&d&&!l&&!g||w&&a&&d||!$&&d||!I)return-1}return 0}function Vc(e,n,a,l){for(var d=-1,g=e.length,$=a.length,w=-1,I=n.length,N=ht(g-$,0),A=V(I+N),z=!l;++w<I;)A[w]=n[w];for(;++d<$;)(z||d<g)&&(A[a[d]]=e[d]);for(;N--;)A[w++]=e[d++];return A}function Gc(e,n,a,l){for(var d=-1,g=e.length,$=-1,w=a.length,I=-1,N=n.length,A=ht(g-w,0),z=V(A+N),Q=!l;++d<A;)z[d]=e[d];for(var K=d;++I<N;)z[K+I]=n[I];for(;++$<w;)(Q||d<g)&&(z[K+a[$]]=e[d++]);return z}function qt(e,n){var a=-1,l=e.length;for(n||(n=V(l));++a<l;)n[a]=e[a];return n}function zn(e,n,a,l){var d=!a;a||(a={});for(var g=-1,$=n.length;++g<$;){var w=n[g],I=l?l(a[w],e[w],w,a,e):o;I===o&&(I=e[w]),d?Kn(a,w,I):ds(a,w,I)}return a}function vo(e,n){return function(a,l){var d=$e(a)?jn:Rf,g=n?n():{};return d(a,e,ae(l,2),g)}}function Si(e){return Ce(function(n,a){var l=-1,d=a.length,g=d>1?a[d-1]:o,$=d>2?a[2]:o;for(g=e.length>3&&typeof g=="function"?(d--,g):o,$&&Nt(a[0],a[1],$)&&(g=d<3?o:g,d=1),n=Ve(n);++l<d;){var w=a[l];w&&e(n,w,l,g)}return n})}function Zc(e,n){return function(a,l){if(a==null)return a;if(!zt(a))return e(a,l);for(var d=a.length,g=n?d:-1,$=Ve(a);(n?g--:++g<d)&&l($[g],g,$)!==!1;);return a}}function Yc(e){return function(n,a,l){for(var d=-1,g=Ve(n),$=l(n),w=$.length;w--;){var I=$[e?w:++d];if(a(g[I],I,g)===!1)break}return n}}function Jc(e){return function(n){var a=vi(n=Le(n))?bn(n):o,l=a?a[0]:n.charAt(0),d=a?Ir(a,1).join(""):n.slice(1);return l[e]()+d}}function Ii(e){return function(n){return yn(Vl(Bl(n).replace(Wr,"")),e,"")}}function vs(e){return function(){var n=arguments;switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3]);case 5:return new e(n[0],n[1],n[2],n[3],n[4]);case 6:return new e(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=Ci(e.prototype),l=e.apply(a,n);return Je(l)?l:a}}function Qc(e){return function(n,a,l){var d=Ve(n);if(!zt(n)){var g=ae(a,3);n=_t(n),a=function(w){return g(d[w],w,d)}}var $=e(n,a,l);return $>-1?d[g?n[$]:$]:o}}function Xc(e){return tr(function(n){var a=n.length,l=a,d=cn.prototype.thru;for(e&&n.reverse();l--;){var g=n[l];if(typeof g!="function")throw new un(t);if(d&&!$&&xo(g)=="wrapper")var $=new cn([],!0)}for(l=$?l:a;++l<a;){var w=xo(g=n[l]),I=w=="wrapper"?Va(g):o;$=I&&Ja(I[0])&&I[1]==424&&!I[4].length&&I[9]==1?$[xo(I[0])].apply($,I[3]):g.length==1&&Ja(g)?$[w]():$.thru(g)}return function(){var N=arguments,A=N[0];if($&&N.length==1&&$e(A))return $.plant(A).value();for(var z=0,Q=a?n[z].apply(this,N):A;++z<a;)Q=n[z].call(this,Q);return Q}})}function yo(e,n,a,l,d,g,$,w,I,N){var A=n&h,z=1&n,Q=2&n,K=24&n,se=512&n,R=Q?o:vs(e);return function P(){for(var ce=arguments.length,B=V(ce),ye=ce;ye--;)B[ye]=arguments[ye];if(K)var ge=Ei(P),Te=function(rt,Rt){for(var Ge=rt.length,Ft=0;Ge--;)rt[Ge]===Rt&&++Ft;return Ft}(B,ge);if(l&&(B=Vc(B,l,d,K)),g&&(B=Gc(B,g,$,K)),ce-=Te,K&&ce<N){var te=$r(B,ge);return tl(e,n,yo,P.placeholder,a,B,te,w,I,N-ce)}var le=z?a:this,ft=Q?le[e]:e;return ce=B.length,w?B=function(rt,Rt){for(var Ge=rt.length,Ft=At(Rt.length,Ge),Wn=qt(rt);Ft--;){var Mr=Rt[Ft];rt[Ft]=nr(Mr,Ge)?Wn[Mr]:o}return rt}(B,w):se&&ce>1&&B.reverse(),A&&I<ce&&(B.length=I),this&&this!==ze&&this instanceof P&&(ft=R||vs(ft)),ft.apply(le,B)}}function Kc(e,n){return function(a,l){return function(d,g,$,w){return qn(d,function(I,N,A){g(w,$(I),N,A)}),w}(a,e,n(l),{})}}function bo(e,n){return function(a,l){var d;if(a===o&&l===o)return n;if(a!==o&&(d=a),l!==o){if(d===o)return l;typeof a=="string"||typeof l=="string"?(a=Gt(a),l=Gt(l)):(a=Dc(a),l=Dc(l)),d=e(a,l)}return d}}function Pa(e){return tr(function(n){return n=je(n,Vt(ae())),Ce(function(a){var l=this;return e(n,function(d){return gt(d,l,a)})})})}function $o(e,n){var a=(n=n===o?" ":Gt(n)).length;if(a<2)return a?Na(n,e):n;var l=Na(n,oo(e/yi(n)));return vi(n)?Ir(bn(l),0,e).join(""):l.slice(0,e)}function el(e){return function(n,a,l){return l&&typeof l!="number"&&Nt(n,a,l)&&(a=l=o),n=ir(n),a===o?(a=n,n=0):a=ir(a),function(d,g,$,w){for(var I=-1,N=ht(oo((g-d)/($||1)),0),A=V(N);N--;)A[w?N:++I]=d,d+=$;return A}(n,a,l=l===o?n<a?1:-1:ir(l),e)}}function wo(e){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=dn(n),a=dn(a)),e(n,a)}}function tl(e,n,a,l,d,g,$,w,I,N){var A=8&n;n|=A?u:c,4&(n&=~(A?c:u))||(n&=-4);var z=[e,n,d,A?g:o,A?$:o,A?o:g,A?o:$,w,I,N],Q=a.apply(o,z);return Ja(e)&&dl(Q,z),Q.placeholder=l,pl(Q,e,n)}function Wa(e){var n=Un[e];return function(a,l){if(a=dn(a),(l=l==null?0:At(xe(l),292))&&pc(a)){var d=(Le(a)+"e").split("e");return+((d=(Le(n(d[0]+"e"+(+d[1]+l)))+"e").split("e"))[0]+"e"+(+d[1]-l))}return n(a)}}var Gf=wi&&1/Js(new wi([,-0]))[1]==v?function(e){return new wi(e)}:hu;function nl(e){return function(n){var a=Tt(n);return a==oe?ya(n):a==Fe?ff(n):function(l,d){return je(d,function(g){return[g,l[g]]})}(n,e(n))}}function er(e,n,a,l,d,g,$,w){var I=2&n;if(!I&&typeof e!="function")throw new un(t);var N=l?l.length:0;if(N||(n&=-97,l=d=o),$=$===o?$:ht(xe($),0),w=w===o?w:xe(w),N-=d?d.length:0,n&c){var A=l,z=d;l=d=o}var Q=I?o:Va(e),K=[e,n,a,l,d,A,z,g,$,w];if(Q&&function(R,P){var ce=R[1],B=P[1],ye=ce|B,ge=ye<131,Te=B==h&&ce==8||B==h&&ce==f&&R[7].length<=P[8]||B==384&&P[7].length<=P[8]&&ce==8;if(!ge&&!Te)return R;1&B&&(R[2]=P[2],ye|=1&ce?0:4);var te=P[3];if(te){var le=R[3];R[3]=le?Vc(le,te,P[4]):te,R[4]=le?$r(R[3],i):P[4]}(te=P[5])&&(le=R[5],R[5]=le?Gc(le,te,P[6]):te,R[6]=le?$r(R[5],i):P[6]),(te=P[7])&&(R[7]=te),B&h&&(R[8]=R[8]==null?P[8]:At(R[8],P[8])),R[9]==null&&(R[9]=P[9]),R[0]=P[0],R[1]=ye}(K,Q),e=K[0],n=K[1],a=K[2],l=K[3],d=K[4],!(w=K[9]=K[9]===o?I?0:e.length:ht(K[9]-N,0))&&24&n&&(n&=-25),n&&n!=1)se=n==8||n==s?function(R,P,ce){var B=vs(R);return function ye(){for(var ge=arguments.length,Te=V(ge),te=ge,le=Ei(ye);te--;)Te[te]=arguments[te];var ft=ge<3&&Te[0]!==le&&Te[ge-1]!==le?[]:$r(Te,le);return(ge-=ft.length)<ce?tl(R,P,yo,ye.placeholder,o,Te,ft,o,o,ce-ge):gt(this&&this!==ze&&this instanceof ye?B:R,this,Te)}}(e,n,w):n!=u&&n!=33||d.length?yo.apply(o,K):function(R,P,ce,B){var ye=1&P,ge=vs(R);return function Te(){for(var te=-1,le=arguments.length,ft=-1,rt=B.length,Rt=V(rt+le),Ge=this&&this!==ze&&this instanceof Te?ge:R;++ft<rt;)Rt[ft]=B[ft];for(;le--;)Rt[ft++]=arguments[++te];return gt(Ge,ye?ce:this,Rt)}}(e,n,a,l);else var se=function(R,P,ce){var B=1&P,ye=vs(R);return function ge(){return(this&&this!==ze&&this instanceof ge?ye:R).apply(B?ce:this,arguments)}}(e,n,a);return pl((Q?Rc:dl)(se,K),e,n)}function rl(e,n,a,l){return e===o||wn(e,$i[a])&&!Ne.call(l,a)?n:e}function il(e,n,a,l,d,g){return Je(e)&&Je(n)&&(g.set(n,e),go(e,n,o,il,g),g.delete(n)),e}function Zf(e){return $s(e)?o:e}function sl(e,n,a,l,d,g){var $=1&a,w=e.length,I=n.length;if(w!=I&&!($&&I>w))return!1;var N=g.get(e),A=g.get(n);if(N&&A)return N==n&&A==e;var z=-1,Q=!0,K=2&a?new Zr:o;for(g.set(e,n),g.set(n,e);++z<w;){var se=e[z],R=n[z];if(l)var P=$?l(R,se,z,n,e,g):l(se,R,z,e,n,g);if(P!==o){if(P)continue;Q=!1;break}if(K){if(!br(n,function(ce,B){if(!as(K,B)&&(se===ce||d(se,ce,a,l,g)))return K.push(B)})){Q=!1;break}}else if(se!==R&&!d(se,R,a,l,g)){Q=!1;break}}return g.delete(e),g.delete(n),Q}function tr(e){return Xa(hl(e,o,bl),e+"")}function Ha(e){return Sc(e,_t,Za)}function Ba(e){return Sc(e,Pt,ol)}var Va=uo?function(e){return uo.get(e)}:hu;function xo(e){for(var n=e.name+"",a=xi[n],l=Ne.call(xi,n)?a.length:0;l--;){var d=a[l],g=d.func;if(g==null||g==e)return d.name}return n}function Ei(e){return(Ne.call(p,"placeholder")?p:e).placeholder}function ae(){var e=p.iteratee||cu;return e=e===cu?Mc:e,arguments.length?e(arguments[0],arguments[1]):e}function Co(e,n){var a,l,d=e.__data__;return((l=typeof(a=n))=="string"||l=="number"||l=="symbol"||l=="boolean"?a!=="__proto__":a===null)?d[typeof n=="string"?"string":"hash"]:d.map}function Ga(e){for(var n=_t(e),a=n.length;a--;){var l=n[a],d=e[l];n[a]=[l,d,cl(d)]}return n}function Qr(e,n){var a=function(l,d){return l==null?o:l[d]}(e,n);return Ec(a)?a:o}var Za=$a?function(e){return e==null?[]:(e=Ve(e),It($a(e),function(n){return fc.call(e,n)}))}:fu,ol=$a?function(e){for(var n=[];e;)Bt(n,Za(e)),e=ro(e);return n}:fu,Tt=Lt;function al(e,n,a){for(var l=-1,d=(n=Sr(n,e)).length,g=!1;++l<d;){var $=Pn(n[l]);if(!(g=e!=null&&a(e,$)))break;e=e[$]}return g||++l!=d?g:!!(d=e==null?0:e.length)&&To(d)&&nr($,d)&&($e(e)||Kr(e))}function ul(e){return typeof e.constructor!="function"||ys(e)?{}:Ci(ro(e))}function Yf(e){return $e(e)||Kr(e)||!!(dc&&e&&e[dc])}function nr(e,n){var a=typeof e;return!!(n=n??_)&&(a=="number"||a!="symbol"&&la.test(e))&&e>-1&&e%1==0&&e<n}function Nt(e,n,a){if(!Je(a))return!1;var l=typeof n;return!!(l=="number"?zt(a)&&nr(n,a.length):l=="string"&&n in a)&&wn(a[n],e)}function Ya(e,n){if($e(e))return!1;var a=typeof e;return!(a!="number"&&a!="symbol"&&a!="boolean"&&e!=null&&!Zt(e))||Os.test(e)||!rn.test(e)||n!=null&&e in Ve(n)}function Ja(e){var n=xo(e),a=p[n];if(typeof a!="function"||!(n in Ee.prototype))return!1;if(e===a)return!0;var l=Va(a);return!!l&&e===l[0]}(wa&&Tt(new wa(new ArrayBuffer(1)))!=at||cs&&Tt(new cs)!=oe||xa&&Tt(xa.resolve())!=Ie||wi&&Tt(new wi)!=Fe||ls&&Tt(new ls)!=Se)&&(Tt=function(e){var n=Lt(e),a=n==pe?e.constructor:o,l=a?Xr(a):"";if(l)switch(l){case kf:return at;case Af:return oe;case Tf:return Ie;case Ff:return Fe;case Of:return Se}return n});var Jf=Xs?rr:du;function ys(e){var n=e&&e.constructor;return e===(typeof n=="function"&&n.prototype||$i)}function cl(e){return e==e&&!Je(e)}function ll(e,n){return function(a){return a!=null&&a[e]===n&&(n!==o||e in Ve(a))}}function hl(e,n,a){return n=ht(n===o?e.length-1:n,0),function(){for(var l=arguments,d=-1,g=ht(l.length-n,0),$=V(g);++d<g;)$[d]=l[n+d];d=-1;for(var w=V(n+1);++d<n;)w[d]=l[d];return w[n]=a($),gt(e,this,w)}}function fl(e,n){return n.length<2?e:Jr(e,hn(n,0,-1))}function Qa(e,n){if((n!=="constructor"||typeof e[n]!="function")&&n!="__proto__")return e[n]}var dl=gl(Rc),bs=wf||function(e,n){return ze.setTimeout(e,n)},Xa=gl(Wf);function pl(e,n,a){var l=n+"";return Xa(e,function(d,g){var $=g.length;if(!$)return d;var w=$-1;return g[w]=($>1?"& ":"")+g[w],g=g.join($>2?", ":" "),d.replace(js,`{
/* [wrapped with `+g+`] */
`)}(l,function(d,g){return kt(E,function($){var w="_."+$[0];g&$[1]&&!Dn(d,w)&&d.push(w)}),d.sort()}(function(d){var g=d.match(aa);return g?g[1].split(Vn):[]}(l),a)))}function gl(e){var n=0,a=0;return function(){var l=If(),d=16-(l-a);if(a=l,d>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(o,arguments)}}function So(e,n){var a=-1,l=e.length,d=l-1;for(n=n===o?l:n;++a<n;){var g=La(a,d),$=e[g];e[g]=e[a],e[a]=$}return e.length=n,e}var _l=function(e){var n=ko(e,function(l){return a.size===500&&a.clear(),l}),a=n.cache;return n}(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Ls,function(a,l,d,g){n.push(d?g.replace(ca,"$1"):l||a)}),n});function Pn(e){if(typeof e=="string"||Zt(e))return e;var n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function Xr(e){if(e!=null){try{return Ks.call(e)}catch{}try{return e+""}catch{}}return""}function ml(e){if(e instanceof Ee)return e.clone();var n=new cn(e.__wrapped__,e.__chain__);return n.__actions__=qt(e.__actions__),n.__index__=e.__index__,n.__values__=e.__values__,n}var Qf=Ce(function(e,n){return nt(e)?ps(e,Et(n,1,nt,!0)):[]}),Xf=Ce(function(e,n){var a=fn(n);return nt(a)&&(a=o),nt(e)?ps(e,Et(n,1,nt,!0),ae(a,2)):[]}),Kf=Ce(function(e,n){var a=fn(n);return nt(a)&&(a=o),nt(e)?ps(e,Et(n,1,nt,!0),o,a):[]});function vl(e,n,a){var l=e==null?0:e.length;if(!l)return-1;var d=a==null?0:xe(a);return d<0&&(d=ht(l+d,0)),Yn(e,ae(n,3),d)}function yl(e,n,a){var l=e==null?0:e.length;if(!l)return-1;var d=l-1;return a!==o&&(d=xe(a),d=a<0?ht(l+d,0):At(d,l-1)),Yn(e,ae(n,3),d,!0)}function bl(e){return e!=null&&e.length?Et(e,1):[]}function $l(e){return e&&e.length?e[0]:o}var ed=Ce(function(e){var n=je(e,Ua);return n.length&&n[0]===e[0]?ka(n):[]}),td=Ce(function(e){var n=fn(e),a=je(e,Ua);return n===fn(a)?n=o:a.pop(),a.length&&a[0]===e[0]?ka(a,ae(n,2)):[]}),nd=Ce(function(e){var n=fn(e),a=je(e,Ua);return(n=typeof n=="function"?n:o)&&a.pop(),a.length&&a[0]===e[0]?ka(a,o,n):[]});function fn(e){var n=e==null?0:e.length;return n?e[n-1]:o}var rd=Ce(wl);function wl(e,n){return e&&e.length&&n&&n.length?Oa(e,n):e}var id=tr(function(e,n){var a=e==null?0:e.length,l=Sa(e,n);return Nc(e,je(n,function(d){return nr(d,a)?+d:d}).sort(Bc)),l});function Ka(e){return e==null?e:Mf.call(e)}var sd=Ce(function(e){return Cr(Et(e,1,nt,!0))}),od=Ce(function(e){var n=fn(e);return nt(n)&&(n=o),Cr(Et(e,1,nt,!0),ae(n,2))}),ad=Ce(function(e){var n=fn(e);return n=typeof n=="function"?n:o,Cr(Et(e,1,nt,!0),o,n)});function eu(e){if(!e||!e.length)return[];var n=0;return e=It(e,function(a){if(nt(a))return n=ht(a.length,n),!0}),ma(n,function(a){return je(e,pa(a))})}function xl(e,n){if(!e||!e.length)return[];var a=eu(e);return n==null?a:je(a,function(l){return gt(n,o,l)})}var ud=Ce(function(e,n){return nt(e)?ps(e,n):[]}),cd=Ce(function(e){return Da(It(e,nt))}),ld=Ce(function(e){var n=fn(e);return nt(n)&&(n=o),Da(It(e,nt),ae(n,2))}),hd=Ce(function(e){var n=fn(e);return n=typeof n=="function"?n:o,Da(It(e,nt),o,n)}),fd=Ce(eu),dd=Ce(function(e){var n=e.length,a=n>1?e[n-1]:o;return a=typeof a=="function"?(e.pop(),a):o,xl(e,a)});function Cl(e){var n=p(e);return n.__chain__=!0,n}function Io(e,n){return n(e)}var pd=tr(function(e){var n=e.length,a=n?e[0]:0,l=this.__wrapped__,d=function(g){return Sa(g,e)};return!(n>1||this.__actions__.length)&&l instanceof Ee&&nr(a)?((l=l.slice(a,+a+(n?1:0))).__actions__.push({func:Io,args:[d],thisArg:o}),new cn(l,this.__chain__).thru(function(g){return n&&!g.length&&g.push(o),g})):this.thru(d)}),gd=vo(function(e,n,a){Ne.call(e,a)?++e[a]:Kn(e,a,1)}),_d=Qc(vl),md=Qc(yl);function Sl(e,n){return($e(e)?kt:xr)(e,ae(n,3))}function Il(e,n){return($e(e)?Ut:wc)(e,ae(n,3))}var vd=vo(function(e,n,a){Ne.call(e,a)?e[a].push(n):Kn(e,a,[n])}),yd=Ce(function(e,n,a){var l=-1,d=typeof n=="function",g=zt(e)?V(e.length):[];return xr(e,function($){g[++l]=d?gt(n,$,a):gs($,n,a)}),g}),bd=vo(function(e,n,a){Kn(e,a,n)});function Eo(e,n){return($e(e)?je:kc)(e,ae(n,3))}var $d=vo(function(e,n,a){e[a?0:1].push(n)},function(){return[[],[]]}),wd=Ce(function(e,n){if(e==null)return[];var a=n.length;return a>1&&Nt(e,n[0],n[1])?n=[]:a>2&&Nt(n[0],n[1],n[2])&&(n=[n[0]]),Oc(e,Et(n,1),[])}),Mo=$f||function(){return ze.Date.now()};function El(e,n,a){return n=a?o:n,n=e&&n==null?e.length:n,er(e,h,o,o,o,o,n)}function Ml(e,n){var a;if(typeof n!="function")throw new un(t);return e=xe(e),function(){return--e>0&&(a=n.apply(this,arguments)),e<=1&&(n=o),a}}var tu=Ce(function(e,n,a){var l=1;if(a.length){var d=$r(a,Ei(tu));l|=u}return er(e,l,n,a,d)}),kl=Ce(function(e,n,a){var l=3;if(a.length){var d=$r(a,Ei(kl));l|=u}return er(n,l,e,a,d)});function Al(e,n,a){var l,d,g,$,w,I,N=0,A=!1,z=!1,Q=!0;if(typeof e!="function")throw new un(t);function K(B){var ye=l,ge=d;return l=d=o,N=B,$=e.apply(ge,ye)}function se(B){var ye=B-I;return I===o||ye>=n||ye<0||z&&B-N>=g}function R(){var B=Mo();if(se(B))return P(B);w=bs(R,function(ye){var ge=n-(ye-I);return z?At(ge,g-(ye-N)):ge}(B))}function P(B){return w=o,Q&&l?K(B):(l=d=o,$)}function ce(){var B=Mo(),ye=se(B);if(l=arguments,d=this,I=B,ye){if(w===o)return function(ge){return N=ge,w=bs(R,n),A?K(ge):$}(I);if(z)return Pc(w),w=bs(R,n),K(I)}return w===o&&(w=bs(R,n)),$}return n=dn(n)||0,Je(a)&&(A=!!a.leading,g=(z="maxWait"in a)?ht(dn(a.maxWait)||0,n):g,Q="trailing"in a?!!a.trailing:Q),ce.cancel=function(){w!==o&&Pc(w),N=0,l=I=d=w=o},ce.flush=function(){return w===o?$:P(Mo())},ce}var xd=Ce(function(e,n){return $c(e,1,n)}),Cd=Ce(function(e,n,a){return $c(e,dn(n)||0,a)});function ko(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new un(t);var a=function(){var l=arguments,d=n?n.apply(this,l):l[0],g=a.cache;if(g.has(d))return g.get(d);var $=e.apply(this,l);return a.cache=g.set(d,$)||g,$};return a.cache=new(ko.Cache||Xn),a}function Ao(e){if(typeof e!="function")throw new un(t);return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}ko.Cache=Xn;var Sd=Vf(function(e,n){var a=(n=n.length==1&&$e(n[0])?je(n[0],Vt(ae())):je(Et(n,1),Vt(ae()))).length;return Ce(function(l){for(var d=-1,g=At(l.length,a);++d<g;)l[d]=n[d].call(this,l[d]);return gt(e,this,l)})}),nu=Ce(function(e,n){var a=$r(n,Ei(nu));return er(e,u,o,n,a)}),Tl=Ce(function(e,n){var a=$r(n,Ei(Tl));return er(e,c,o,n,a)}),Id=tr(function(e,n){return er(e,f,o,o,o,n)});function wn(e,n){return e===n||e!=e&&n!=n}var Ed=wo(Ma),Md=wo(function(e,n){return e>=n}),Kr=Ic(function(){return arguments}())?Ic:function(e){return Ke(e)&&Ne.call(e,"callee")&&!fc.call(e,"callee")},$e=V.isArray,kd=vr?Vt(vr):function(e){return Ke(e)&&Lt(e)==we};function zt(e){return e!=null&&To(e.length)&&!rr(e)}function nt(e){return Ke(e)&&zt(e)}var Er=xf||du,Ad=ss?Vt(ss):function(e){return Ke(e)&&Lt(e)==S};function ru(e){if(!Ke(e))return!1;var n=Lt(e);return n==F||n=="[object DOMException]"||typeof e.message=="string"&&typeof e.name=="string"&&!$s(e)}function rr(e){if(!Je(e))return!1;var n=Lt(e);return n==ne||n==de||n=="[object AsyncFunction]"||n=="[object Proxy]"}function Fl(e){return typeof e=="number"&&e==xe(e)}function To(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_}function Je(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function Ke(e){return e!=null&&typeof e=="object"}var Ol=Gs?Vt(Gs):function(e){return Ke(e)&&Tt(e)==oe};function Ll(e){return typeof e=="number"||Ke(e)&&Lt(e)==Re}function $s(e){if(!Ke(e)||Lt(e)!=pe)return!1;var n=ro(e);if(n===null)return!0;var a=Ne.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&Ks.call(a)==mf}var iu=Zs?Vt(Zs):function(e){return Ke(e)&&Lt(e)==_e},Nl=Oe?Vt(Oe):function(e){return Ke(e)&&Tt(e)==Fe};function Fo(e){return typeof e=="string"||!$e(e)&&Ke(e)&&Lt(e)==Pe}function Zt(e){return typeof e=="symbol"||Ke(e)&&Lt(e)==st}var Mi=Ae?Vt(Ae):function(e){return Ke(e)&&To(e.length)&&!!X[Lt(e)]},Td=wo(Fa),Fd=wo(function(e,n){return e<=n});function Rl(e){if(!e)return[];if(zt(e))return Fo(e)?bn(e):qt(e);if(us&&e[us])return function(a){for(var l,d=[];!(l=a.next()).done;)d.push(l.value);return d}(e[us]());var n=Tt(e);return(n==oe?ya:n==Fe?Js:ki)(e)}function ir(e){return e?(e=dn(e))===v||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0}function xe(e){var n=ir(e),a=n%1;return n==n?a?n-a:n:0}function jl(e){return e?Yr(xe(e),0,x):0}function dn(e){if(typeof e=="number")return e;if(Zt(e))return b;if(Je(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=Je(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=ic(e);var a=Qi.test(e);return a||Ur.test(e)?tt(e.slice(2),a?2:8):Ji.test(e)?b:+e}function Dl(e){return zn(e,Pt(e))}function Le(e){return e==null?"":Gt(e)}var Od=Si(function(e,n){if(ys(n)||zt(n))zn(n,_t(n),e);else for(var a in n)Ne.call(n,a)&&ds(e,a,n[a])}),Ul=Si(function(e,n){zn(n,Pt(n),e)}),Oo=Si(function(e,n,a,l){zn(n,Pt(n),e,l)}),Ld=Si(function(e,n,a,l){zn(n,_t(n),e,l)}),Nd=tr(Sa),Rd=Ce(function(e,n){e=Ve(e);var a=-1,l=n.length,d=l>2?n[2]:o;for(d&&Nt(n[0],n[1],d)&&(l=1);++a<l;)for(var g=n[a],$=Pt(g),w=-1,I=$.length;++w<I;){var N=$[w],A=e[N];(A===o||wn(A,$i[N])&&!Ne.call(e,N))&&(e[N]=g[N])}return e}),jd=Ce(function(e){return e.push(o,il),gt(ql,o,e)});function su(e,n,a){var l=e==null?o:Jr(e,n);return l===o?a:l}function ou(e,n){return e!=null&&al(e,n,Uf)}var Dd=Kc(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=eo.call(n)),e[n]=a},uu(Wt)),Ud=Kc(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=eo.call(n)),Ne.call(e,n)?e[n].push(a):e[n]=[a]},ae),qd=Ce(gs);function _t(e){return zt(e)?mc(e):Ta(e)}function Pt(e){return zt(e)?mc(e,!0):qf(e)}var zd=Si(function(e,n,a){go(e,n,a)}),ql=Si(function(e,n,a,l){go(e,n,a,l)}),Pd=tr(function(e,n){var a={};if(e==null)return a;var l=!1;n=je(n,function(g){return g=Sr(g,e),l||(l=g.length>1),g}),zn(e,Ba(e),a),l&&(a=ln(a,7,Zf));for(var d=n.length;d--;)ja(a,n[d]);return a}),Wd=tr(function(e,n){return e==null?{}:function(a,l){return Lc(a,l,function(d,g){return ou(a,g)})}(e,n)});function zl(e,n){if(e==null)return{};var a=je(Ba(e),function(l){return[l]});return n=ae(n),Lc(e,a,function(l,d){return n(l,d[0])})}var Pl=nl(_t),Wl=nl(Pt);function ki(e){return e==null?[]:va(e,_t(e))}var Hd=Ii(function(e,n,a){return n=n.toLowerCase(),e+(a?Hl(n):n)});function Hl(e){return au(Le(e).toLowerCase())}function Bl(e){return(e=Le(e))&&e.replace(ha,cf).replace(Vs,"")}var Bd=Ii(function(e,n,a){return e+(a?"-":"")+n.toLowerCase()}),Vd=Ii(function(e,n,a){return e+(a?" ":"")+n.toLowerCase()}),Gd=Jc("toLowerCase"),Zd=Ii(function(e,n,a){return e+(a?"_":"")+n.toLowerCase()}),Yd=Ii(function(e,n,a){return e+(a?" ":"")+au(n)}),Jd=Ii(function(e,n,a){return e+(a?" ":"")+n.toUpperCase()}),au=Jc("toUpperCase");function Vl(e,n,a){return e=Le(e),(n=a?o:n)===o?function(l){return W.test(l)}(e)?function(l){return l.match(C)||[]}(e):function(l){return l.match(Ds)||[]}(e):e.match(n)||[]}var Gl=Ce(function(e,n){try{return gt(e,o,n)}catch(a){return ru(a)?a:new Me(a)}}),Qd=tr(function(e,n){return kt(n,function(a){a=Pn(a),Kn(e,a,tu(e[a],e))}),e});function uu(e){return function(){return e}}var Xd=Xc(),Kd=Xc(!0);function Wt(e){return e}function cu(e){return Mc(typeof e=="function"?e:ln(e,1))}var ep=Ce(function(e,n){return function(a){return gs(a,e,n)}}),tp=Ce(function(e,n){return function(a){return gs(e,a,n)}});function lu(e,n,a){var l=_t(n),d=po(n,l);a!=null||Je(n)&&(d.length||!l.length)||(a=n,n=e,e=this,d=po(n,_t(n)));var g=!(Je(a)&&"chain"in a&&!a.chain),$=rr(e);return kt(d,function(w){var I=n[w];e[w]=I,$&&(e.prototype[w]=function(){var N=this.__chain__;if(g||N){var A=e(this.__wrapped__);return(A.__actions__=qt(this.__actions__)).push({func:I,args:arguments,thisArg:e}),A.__chain__=N,A}return I.apply(e,Bt([this.value()],arguments))})}),e}function hu(){}var np=Pa(je),rp=Pa(an),ip=Pa(br);function Zl(e){return Ya(e)?pa(Pn(e)):function(n){return function(a){return Jr(a,n)}}(e)}var sp=el(),op=el(!0);function fu(){return[]}function du(){return!1}var pu,ap=bo(function(e,n){return e+n},0),up=Wa("ceil"),cp=bo(function(e,n){return e/n},1),lp=Wa("floor"),hp=bo(function(e,n){return e*n},1),fp=Wa("round"),dp=bo(function(e,n){return e-n},0);return p.after=function(e,n){if(typeof n!="function")throw new un(t);return e=xe(e),function(){if(--e<1)return n.apply(this,arguments)}},p.ary=El,p.assign=Od,p.assignIn=Ul,p.assignInWith=Oo,p.assignWith=Ld,p.at=Nd,p.before=Ml,p.bind=tu,p.bindAll=Qd,p.bindKey=kl,p.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return $e(e)?e:[e]},p.chain=Cl,p.chunk=function(e,n,a){n=(a?Nt(e,n,a):n===o)?1:ht(xe(n),0);var l=e==null?0:e.length;if(!l||n<1)return[];for(var d=0,g=0,$=V(oo(l/n));d<l;)$[g++]=hn(e,d,d+=n);return $},p.compact=function(e){for(var n=-1,a=e==null?0:e.length,l=0,d=[];++n<a;){var g=e[n];g&&(d[l++]=g)}return d},p.concat=function(){var e=arguments.length;if(!e)return[];for(var n=V(e-1),a=arguments[0],l=e;l--;)n[l-1]=arguments[l];return Bt($e(a)?qt(a):[a],Et(n,1))},p.cond=function(e){var n=e==null?0:e.length,a=ae();return e=n?je(e,function(l){if(typeof l[1]!="function")throw new un(t);return[a(l[0]),l[1]]}):[],Ce(function(l){for(var d=-1;++d<n;){var g=e[d];if(gt(g[0],this,l))return gt(g[1],this,l)}})},p.conforms=function(e){return function(n){var a=_t(n);return function(l){return bc(l,n,a)}}(ln(e,1))},p.constant=uu,p.countBy=gd,p.create=function(e,n){var a=Ci(e);return n==null?a:yc(a,n)},p.curry=function e(n,a,l){var d=er(n,8,o,o,o,o,o,a=l?o:a);return d.placeholder=e.placeholder,d},p.curryRight=function e(n,a,l){var d=er(n,s,o,o,o,o,o,a=l?o:a);return d.placeholder=e.placeholder,d},p.debounce=Al,p.defaults=Rd,p.defaultsDeep=jd,p.defer=xd,p.delay=Cd,p.difference=Qf,p.differenceBy=Xf,p.differenceWith=Kf,p.drop=function(e,n,a){var l=e==null?0:e.length;return l?hn(e,(n=a||n===o?1:xe(n))<0?0:n,l):[]},p.dropRight=function(e,n,a){var l=e==null?0:e.length;return l?hn(e,0,(n=l-(n=a||n===o?1:xe(n)))<0?0:n):[]},p.dropRightWhile=function(e,n){return e&&e.length?mo(e,ae(n,3),!0,!0):[]},p.dropWhile=function(e,n){return e&&e.length?mo(e,ae(n,3),!0):[]},p.fill=function(e,n,a,l){var d=e==null?0:e.length;return d?(a&&typeof a!="number"&&Nt(e,n,a)&&(a=0,l=d),function(g,$,w,I){var N=g.length;for((w=xe(w))<0&&(w=-w>N?0:N+w),(I=I===o||I>N?N:xe(I))<0&&(I+=N),I=w>I?0:jl(I);w<I;)g[w++]=$;return g}(e,n,a,l)):[]},p.filter=function(e,n){return($e(e)?It:xc)(e,ae(n,3))},p.flatMap=function(e,n){return Et(Eo(e,n),1)},p.flatMapDeep=function(e,n){return Et(Eo(e,n),v)},p.flatMapDepth=function(e,n,a){return a=a===o?1:xe(a),Et(Eo(e,n),a)},p.flatten=bl,p.flattenDeep=function(e){return e!=null&&e.length?Et(e,v):[]},p.flattenDepth=function(e,n){return e!=null&&e.length?Et(e,n=n===o?1:xe(n)):[]},p.flip=function(e){return er(e,512)},p.flow=Xd,p.flowRight=Kd,p.fromPairs=function(e){for(var n=-1,a=e==null?0:e.length,l={};++n<a;){var d=e[n];l[d[0]]=d[1]}return l},p.functions=function(e){return e==null?[]:po(e,_t(e))},p.functionsIn=function(e){return e==null?[]:po(e,Pt(e))},p.groupBy=vd,p.initial=function(e){return e!=null&&e.length?hn(e,0,-1):[]},p.intersection=ed,p.intersectionBy=td,p.intersectionWith=nd,p.invert=Dd,p.invertBy=Ud,p.invokeMap=yd,p.iteratee=cu,p.keyBy=bd,p.keys=_t,p.keysIn=Pt,p.map=Eo,p.mapKeys=function(e,n){var a={};return n=ae(n,3),qn(e,function(l,d,g){Kn(a,n(l,d,g),l)}),a},p.mapValues=function(e,n){var a={};return n=ae(n,3),qn(e,function(l,d,g){Kn(a,d,n(l,d,g))}),a},p.matches=function(e){return Ac(ln(e,1))},p.matchesProperty=function(e,n){return Tc(e,ln(n,1))},p.memoize=ko,p.merge=zd,p.mergeWith=ql,p.method=ep,p.methodOf=tp,p.mixin=lu,p.negate=Ao,p.nthArg=function(e){return e=xe(e),Ce(function(n){return Fc(n,e)})},p.omit=Pd,p.omitBy=function(e,n){return zl(e,Ao(ae(n)))},p.once=function(e){return Ml(2,e)},p.orderBy=function(e,n,a,l){return e==null?[]:($e(n)||(n=n==null?[]:[n]),$e(a=l?o:a)||(a=a==null?[]:[a]),Oc(e,n,a))},p.over=np,p.overArgs=Sd,p.overEvery=rp,p.overSome=ip,p.partial=nu,p.partialRight=Tl,p.partition=$d,p.pick=Wd,p.pickBy=zl,p.property=Zl,p.propertyOf=function(e){return function(n){return e==null?o:Jr(e,n)}},p.pull=rd,p.pullAll=wl,p.pullAllBy=function(e,n,a){return e&&e.length&&n&&n.length?Oa(e,n,ae(a,2)):e},p.pullAllWith=function(e,n,a){return e&&e.length&&n&&n.length?Oa(e,n,o,a):e},p.pullAt=id,p.range=sp,p.rangeRight=op,p.rearg=Id,p.reject=function(e,n){return($e(e)?It:xc)(e,Ao(ae(n,3)))},p.remove=function(e,n){var a=[];if(!e||!e.length)return a;var l=-1,d=[],g=e.length;for(n=ae(n,3);++l<g;){var $=e[l];n($,l,e)&&(a.push($),d.push(l))}return Nc(e,d),a},p.rest=function(e,n){if(typeof e!="function")throw new un(t);return Ce(e,n=n===o?n:xe(n))},p.reverse=Ka,p.sampleSize=function(e,n,a){return n=(a?Nt(e,n,a):n===o)?1:xe(n),($e(e)?Lf:Pf)(e,n)},p.set=function(e,n,a){return e==null?e:ms(e,n,a)},p.setWith=function(e,n,a,l){return l=typeof l=="function"?l:o,e==null?e:ms(e,n,a,l)},p.shuffle=function(e){return($e(e)?Nf:Hf)(e)},p.slice=function(e,n,a){var l=e==null?0:e.length;return l?(a&&typeof a!="number"&&Nt(e,n,a)?(n=0,a=l):(n=n==null?0:xe(n),a=a===o?l:xe(a)),hn(e,n,a)):[]},p.sortBy=wd,p.sortedUniq=function(e){return e&&e.length?jc(e):[]},p.sortedUniqBy=function(e,n){return e&&e.length?jc(e,ae(n,2)):[]},p.split=function(e,n,a){return a&&typeof a!="number"&&Nt(e,n,a)&&(n=a=o),(a=a===o?x:a>>>0)?(e=Le(e))&&(typeof n=="string"||n!=null&&!iu(n))&&!(n=Gt(n))&&vi(e)?Ir(bn(e),0,a):e.split(n,a):[]},p.spread=function(e,n){if(typeof e!="function")throw new un(t);return n=n==null?0:ht(xe(n),0),Ce(function(a){var l=a[n],d=Ir(a,0,n);return l&&Bt(d,l),gt(e,this,d)})},p.tail=function(e){var n=e==null?0:e.length;return n?hn(e,1,n):[]},p.take=function(e,n,a){return e&&e.length?hn(e,0,(n=a||n===o?1:xe(n))<0?0:n):[]},p.takeRight=function(e,n,a){var l=e==null?0:e.length;return l?hn(e,(n=l-(n=a||n===o?1:xe(n)))<0?0:n,l):[]},p.takeRightWhile=function(e,n){return e&&e.length?mo(e,ae(n,3),!1,!0):[]},p.takeWhile=function(e,n){return e&&e.length?mo(e,ae(n,3)):[]},p.tap=function(e,n){return n(e),e},p.throttle=function(e,n,a){var l=!0,d=!0;if(typeof e!="function")throw new un(t);return Je(a)&&(l="leading"in a?!!a.leading:l,d="trailing"in a?!!a.trailing:d),Al(e,n,{leading:l,maxWait:n,trailing:d})},p.thru=Io,p.toArray=Rl,p.toPairs=Pl,p.toPairsIn=Wl,p.toPath=function(e){return $e(e)?je(e,Pn):Zt(e)?[e]:qt(_l(Le(e)))},p.toPlainObject=Dl,p.transform=function(e,n,a){var l=$e(e),d=l||Er(e)||Mi(e);if(n=ae(n,4),a==null){var g=e&&e.constructor;a=d?l?new g:[]:Je(e)&&rr(g)?Ci(ro(e)):{}}return(d?kt:qn)(e,function($,w,I){return n(a,$,w,I)}),a},p.unary=function(e){return El(e,1)},p.union=sd,p.unionBy=od,p.unionWith=ad,p.uniq=function(e){return e&&e.length?Cr(e):[]},p.uniqBy=function(e,n){return e&&e.length?Cr(e,ae(n,2)):[]},p.uniqWith=function(e,n){return n=typeof n=="function"?n:o,e&&e.length?Cr(e,o,n):[]},p.unset=function(e,n){return e==null||ja(e,n)},p.unzip=eu,p.unzipWith=xl,p.update=function(e,n,a){return e==null?e:Uc(e,n,qa(a))},p.updateWith=function(e,n,a,l){return l=typeof l=="function"?l:o,e==null?e:Uc(e,n,qa(a),l)},p.values=ki,p.valuesIn=function(e){return e==null?[]:va(e,Pt(e))},p.without=ud,p.words=Vl,p.wrap=function(e,n){return nu(qa(n),e)},p.xor=cd,p.xorBy=ld,p.xorWith=hd,p.zip=fd,p.zipObject=function(e,n){return zc(e||[],n||[],ds)},p.zipObjectDeep=function(e,n){return zc(e||[],n||[],ms)},p.zipWith=dd,p.entries=Pl,p.entriesIn=Wl,p.extend=Ul,p.extendWith=Oo,lu(p,p),p.add=ap,p.attempt=Gl,p.camelCase=Hd,p.capitalize=Hl,p.ceil=up,p.clamp=function(e,n,a){return a===o&&(a=n,n=o),a!==o&&(a=(a=dn(a))==a?a:0),n!==o&&(n=(n=dn(n))==n?n:0),Yr(dn(e),n,a)},p.clone=function(e){return ln(e,4)},p.cloneDeep=function(e){return ln(e,5)},p.cloneDeepWith=function(e,n){return ln(e,5,n=typeof n=="function"?n:o)},p.cloneWith=function(e,n){return ln(e,4,n=typeof n=="function"?n:o)},p.conformsTo=function(e,n){return n==null||bc(e,n,_t(n))},p.deburr=Bl,p.defaultTo=function(e,n){return e==null||e!=e?n:e},p.divide=cp,p.endsWith=function(e,n,a){e=Le(e),n=Gt(n);var l=e.length,d=a=a===o?l:Yr(xe(a),0,l);return(a-=n.length)>=0&&e.slice(a,d)==n},p.eq=wn,p.escape=function(e){return(e=Le(e))&&oa.test(e)?e.replace(Bi,lf):e},p.escapeRegExp=function(e){return(e=Le(e))&&Ns.test(e)?e.replace(Zi,"\\$&"):e},p.every=function(e,n,a){var l=$e(e)?an:jf;return a&&Nt(e,n,a)&&(n=o),l(e,ae(n,3))},p.find=_d,p.findIndex=vl,p.findKey=function(e,n){return Hr(e,ae(n,3),qn)},p.findLast=md,p.findLastIndex=yl,p.findLastKey=function(e,n){return Hr(e,ae(n,3),Ea)},p.floor=lp,p.forEach=Sl,p.forEachRight=Il,p.forIn=function(e,n){return e==null?e:Ia(e,ae(n,3),Pt)},p.forInRight=function(e,n){return e==null?e:Cc(e,ae(n,3),Pt)},p.forOwn=function(e,n){return e&&qn(e,ae(n,3))},p.forOwnRight=function(e,n){return e&&Ea(e,ae(n,3))},p.get=su,p.gt=Ed,p.gte=Md,p.has=function(e,n){return e!=null&&al(e,n,Df)},p.hasIn=ou,p.head=$l,p.identity=Wt,p.includes=function(e,n,a,l){e=zt(e)?e:ki(e),a=a&&!l?xe(a):0;var d=e.length;return a<0&&(a=ht(d+a,0)),Fo(e)?a<=d&&e.indexOf(n,a)>-1:!!d&&Jn(e,n,a)>-1},p.indexOf=function(e,n,a){var l=e==null?0:e.length;if(!l)return-1;var d=a==null?0:xe(a);return d<0&&(d=ht(l+d,0)),Jn(e,n,d)},p.inRange=function(e,n,a){return n=ir(n),a===o?(a=n,n=0):a=ir(a),function(l,d,g){return l>=At(d,g)&&l<ht(d,g)}(e=dn(e),n,a)},p.invoke=qd,p.isArguments=Kr,p.isArray=$e,p.isArrayBuffer=kd,p.isArrayLike=zt,p.isArrayLikeObject=nt,p.isBoolean=function(e){return e===!0||e===!1||Ke(e)&&Lt(e)==L},p.isBuffer=Er,p.isDate=Ad,p.isElement=function(e){return Ke(e)&&e.nodeType===1&&!$s(e)},p.isEmpty=function(e){if(e==null)return!0;if(zt(e)&&($e(e)||typeof e=="string"||typeof e.splice=="function"||Er(e)||Mi(e)||Kr(e)))return!e.length;var n=Tt(e);if(n==oe||n==Fe)return!e.size;if(ys(e))return!Ta(e).length;for(var a in e)if(Ne.call(e,a))return!1;return!0},p.isEqual=function(e,n){return _s(e,n)},p.isEqualWith=function(e,n,a){var l=(a=typeof a=="function"?a:o)?a(e,n):o;return l===o?_s(e,n,o,a):!!l},p.isError=ru,p.isFinite=function(e){return typeof e=="number"&&pc(e)},p.isFunction=rr,p.isInteger=Fl,p.isLength=To,p.isMap=Ol,p.isMatch=function(e,n){return e===n||Aa(e,n,Ga(n))},p.isMatchWith=function(e,n,a){return a=typeof a=="function"?a:o,Aa(e,n,Ga(n),a)},p.isNaN=function(e){return Ll(e)&&e!=+e},p.isNative=function(e){if(Jf(e))throw new Me("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ec(e)},p.isNil=function(e){return e==null},p.isNull=function(e){return e===null},p.isNumber=Ll,p.isObject=Je,p.isObjectLike=Ke,p.isPlainObject=$s,p.isRegExp=iu,p.isSafeInteger=function(e){return Fl(e)&&e>=-9007199254740991&&e<=_},p.isSet=Nl,p.isString=Fo,p.isSymbol=Zt,p.isTypedArray=Mi,p.isUndefined=function(e){return e===o},p.isWeakMap=function(e){return Ke(e)&&Tt(e)==Se},p.isWeakSet=function(e){return Ke(e)&&Lt(e)=="[object WeakSet]"},p.join=function(e,n){return e==null?"":Cf.call(e,n)},p.kebabCase=Bd,p.last=fn,p.lastIndexOf=function(e,n,a){var l=e==null?0:e.length;if(!l)return-1;var d=l;return a!==o&&(d=(d=xe(a))<0?ht(l+d,0):At(d,l-1)),n==n?function(g,$,w){for(var I=w+1;I--;)if(g[I]===$)return I;return I}(e,n,d):Yn(e,Br,d,!0)},p.lowerCase=Vd,p.lowerFirst=Gd,p.lt=Td,p.lte=Fd,p.max=function(e){return e&&e.length?fo(e,Wt,Ma):o},p.maxBy=function(e,n){return e&&e.length?fo(e,ae(n,2),Ma):o},p.mean=function(e){return nc(e,Wt)},p.meanBy=function(e,n){return nc(e,ae(n,2))},p.min=function(e){return e&&e.length?fo(e,Wt,Fa):o},p.minBy=function(e,n){return e&&e.length?fo(e,ae(n,2),Fa):o},p.stubArray=fu,p.stubFalse=du,p.stubObject=function(){return{}},p.stubString=function(){return""},p.stubTrue=function(){return!0},p.multiply=hp,p.nth=function(e,n){return e&&e.length?Fc(e,xe(n)):o},p.noConflict=function(){return ze._===this&&(ze._=vf),this},p.noop=hu,p.now=Mo,p.pad=function(e,n,a){e=Le(e);var l=(n=xe(n))?yi(e):0;if(!n||l>=n)return e;var d=(n-l)/2;return $o(ao(d),a)+e+$o(oo(d),a)},p.padEnd=function(e,n,a){e=Le(e);var l=(n=xe(n))?yi(e):0;return n&&l<n?e+$o(n-l,a):e},p.padStart=function(e,n,a){e=Le(e);var l=(n=xe(n))?yi(e):0;return n&&l<n?$o(n-l,a)+e:e},p.parseInt=function(e,n,a){return a||n==null?n=0:n&&(n=+n),Ef(Le(e).replace(dr,""),n||0)},p.random=function(e,n,a){if(a&&typeof a!="boolean"&&Nt(e,n,a)&&(n=a=o),a===o&&(typeof n=="boolean"?(a=n,n=o):typeof e=="boolean"&&(a=e,e=o)),e===o&&n===o?(e=0,n=1):(e=ir(e),n===o?(n=e,e=0):n=ir(n)),e>n){var l=e;e=n,n=l}if(a||e%1||n%1){var d=gc();return At(e+d*(n-e+Ht("1e-"+((d+"").length-1))),n)}return La(e,n)},p.reduce=function(e,n,a){var l=$e(e)?yn:rc,d=arguments.length<3;return l(e,ae(n,4),a,d,xr)},p.reduceRight=function(e,n,a){var l=$e(e)?Ys:rc,d=arguments.length<3;return l(e,ae(n,4),a,d,wc)},p.repeat=function(e,n,a){return n=(a?Nt(e,n,a):n===o)?1:xe(n),Na(Le(e),n)},p.replace=function(){var e=arguments,n=Le(e[0]);return e.length<3?n:n.replace(e[1],e[2])},p.result=function(e,n,a){var l=-1,d=(n=Sr(n,e)).length;for(d||(d=1,e=o);++l<d;){var g=e==null?o:e[Pn(n[l])];g===o&&(l=d,g=a),e=rr(g)?g.call(e):g}return e},p.round=fp,p.runInContext=M,p.sample=function(e){return($e(e)?vc:zf)(e)},p.size=function(e){if(e==null)return 0;if(zt(e))return Fo(e)?yi(e):e.length;var n=Tt(e);return n==oe||n==Fe?e.size:Ta(e).length},p.snakeCase=Zd,p.some=function(e,n,a){var l=$e(e)?br:Bf;return a&&Nt(e,n,a)&&(n=o),l(e,ae(n,3))},p.sortedIndex=function(e,n){return _o(e,n)},p.sortedIndexBy=function(e,n,a){return Ra(e,n,ae(a,2))},p.sortedIndexOf=function(e,n){var a=e==null?0:e.length;if(a){var l=_o(e,n);if(l<a&&wn(e[l],n))return l}return-1},p.sortedLastIndex=function(e,n){return _o(e,n,!0)},p.sortedLastIndexBy=function(e,n,a){return Ra(e,n,ae(a,2),!0)},p.sortedLastIndexOf=function(e,n){if(e!=null&&e.length){var a=_o(e,n,!0)-1;if(wn(e[a],n))return a}return-1},p.startCase=Yd,p.startsWith=function(e,n,a){return e=Le(e),a=a==null?0:Yr(xe(a),0,e.length),n=Gt(n),e.slice(a,a+n.length)==n},p.subtract=dp,p.sum=function(e){return e&&e.length?_a(e,Wt):0},p.sumBy=function(e,n){return e&&e.length?_a(e,ae(n,2)):0},p.template=function(e,n,a){var l=p.templateSettings;a&&Nt(e,n,a)&&(n=o),e=Le(e),n=Oo({},n,l,rl);var d,g,$=Oo({},n.imports,l.imports,rl),w=_t($),I=va($,w),N=0,A=n.interpolate||fi,z="__p += '",Q=ba((n.escape||fi).source+"|"+A.source+"|"+(A===Gi?Yi:fi).source+"|"+(n.evaluate||fi).source+"|$","g"),K="//# sourceURL="+(Ne.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qe+"]")+`
`;e.replace(Q,function(P,ce,B,ye,ge,Te){return B||(B=ye),z+=e.slice(N,Te).replace(fa,hf),ce&&(d=!0,z+=`' +
__e(`+ce+`) +
'`),ge&&(g=!0,z+=`';
`+ge+`;
__p += '`),B&&(z+=`' +
((__t = (`+B+`)) == null ? '' : __t) +
'`),N=Te+P.length,P}),z+=`';
`;var se=Ne.call(n,"variable")&&n.variable;if(se){if(ua.test(se))throw new Me("Invalid `variable` option passed into `_.template`")}else z=`with (obj) {
`+z+`
}
`;z=(g?z.replace(ra,""):z).replace(ia,"$1").replace(Fs,"$1;"),z="function("+(se||"obj")+`) {
`+(se?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(g?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+z+`return __p
}`;var R=Gl(function(){return lt(w,K+"return "+z).apply(o,I)});if(R.source=z,ru(R))throw R;return R},p.times=function(e,n){if((e=xe(e))<1||e>_)return[];var a=x,l=At(e,x);n=ae(n),e-=x;for(var d=ma(l,n);++a<e;)n(a);return d},p.toFinite=ir,p.toInteger=xe,p.toLength=jl,p.toLower=function(e){return Le(e).toLowerCase()},p.toNumber=dn,p.toSafeInteger=function(e){return e?Yr(xe(e),-9007199254740991,_):e===0?e:0},p.toString=Le,p.toUpper=function(e){return Le(e).toUpperCase()},p.trim=function(e,n,a){if((e=Le(e))&&(a||n===o))return ic(e);if(!e||!(n=Gt(n)))return e;var l=bn(e),d=bn(n);return Ir(l,sc(l,d),oc(l,d)+1).join("")},p.trimEnd=function(e,n,a){if((e=Le(e))&&(a||n===o))return e.slice(0,uc(e)+1);if(!e||!(n=Gt(n)))return e;var l=bn(e);return Ir(l,0,oc(l,bn(n))+1).join("")},p.trimStart=function(e,n,a){if((e=Le(e))&&(a||n===o))return e.replace(dr,"");if(!e||!(n=Gt(n)))return e;var l=bn(e);return Ir(l,sc(l,bn(n))).join("")},p.truncate=function(e,n){var a=30,l="...";if(Je(n)){var d="separator"in n?n.separator:d;a="length"in n?xe(n.length):a,l="omission"in n?Gt(n.omission):l}var g=(e=Le(e)).length;if(vi(e)){var $=bn(e);g=$.length}if(a>=g)return e;var w=a-yi(l);if(w<1)return l;var I=$?Ir($,0,w).join(""):e.slice(0,w);if(d===o)return I+l;if($&&(w+=I.length-w),iu(d)){if(e.slice(w).search(d)){var N,A=I;for(d.global||(d=ba(d.source,Le(pr.exec(d))+"g")),d.lastIndex=0;N=d.exec(A);)var z=N.index;I=I.slice(0,z===o?w:z)}}else if(e.indexOf(Gt(d),w)!=w){var Q=I.lastIndexOf(d);Q>-1&&(I=I.slice(0,Q))}return I+l},p.unescape=function(e){return(e=Le(e))&&sa.test(e)?e.replace(Hi,df):e},p.uniqueId=function(e){var n=++_f;return Le(e)+n},p.upperCase=Jd,p.upperFirst=au,p.each=Sl,p.eachRight=Il,p.first=$l,lu(p,(pu={},qn(p,function(e,n){Ne.call(p.prototype,n)||(pu[n]=e)}),pu),{chain:!1}),p.VERSION="4.17.21",kt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),kt(["drop","take"],function(e,n){Ee.prototype[e]=function(a){a=a===o?1:ht(xe(a),0);var l=this.__filtered__&&!n?new Ee(this):this.clone();return l.__filtered__?l.__takeCount__=At(a,l.__takeCount__):l.__views__.push({size:At(a,x),type:e+(l.__dir__<0?"Right":"")}),l},Ee.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),kt(["filter","map","takeWhile"],function(e,n){var a=n+1,l=a==1||a==3;Ee.prototype[e]=function(d){var g=this.clone();return g.__iteratees__.push({iteratee:ae(d,3),type:a}),g.__filtered__=g.__filtered__||l,g}}),kt(["head","last"],function(e,n){var a="take"+(n?"Right":"");Ee.prototype[e]=function(){return this[a](1).value()[0]}}),kt(["initial","tail"],function(e,n){var a="drop"+(n?"":"Right");Ee.prototype[e]=function(){return this.__filtered__?new Ee(this):this[a](1)}}),Ee.prototype.compact=function(){return this.filter(Wt)},Ee.prototype.find=function(e){return this.filter(e).head()},Ee.prototype.findLast=function(e){return this.reverse().find(e)},Ee.prototype.invokeMap=Ce(function(e,n){return typeof e=="function"?new Ee(this):this.map(function(a){return gs(a,e,n)})}),Ee.prototype.reject=function(e){return this.filter(Ao(ae(e)))},Ee.prototype.slice=function(e,n){e=xe(e);var a=this;return a.__filtered__&&(e>0||n<0)?new Ee(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),n!==o&&(a=(n=xe(n))<0?a.dropRight(-n):a.take(n-e)),a)},Ee.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ee.prototype.toArray=function(){return this.take(x)},qn(Ee.prototype,function(e,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),l=/^(?:head|last)$/.test(n),d=p[l?"take"+(n=="last"?"Right":""):n],g=l||/^find/.test(n);d&&(p.prototype[n]=function(){var $=this.__wrapped__,w=l?[1]:arguments,I=$ instanceof Ee,N=w[0],A=I||$e($),z=function(ce){var B=d.apply(p,Bt([ce],w));return l&&Q?B[0]:B};A&&a&&typeof N=="function"&&N.length!=1&&(I=A=!1);var Q=this.__chain__,K=!!this.__actions__.length,se=g&&!Q,R=I&&!K;if(!g&&A){$=R?$:new Ee(this);var P=e.apply($,w);return P.__actions__.push({func:Io,args:[z],thisArg:o}),new cn(P,Q)}return se&&R?e.apply(this,w):(P=this.thru(z),se?l?P.value()[0]:P.value():P)})}),kt(["pop","push","shift","sort","splice","unshift"],function(e){var n=Qs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",l=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var d=arguments;if(l&&!this.__chain__){var g=this.value();return n.apply($e(g)?g:[],d)}return this[a](function($){return n.apply($e($)?$:[],d)})}}),qn(Ee.prototype,function(e,n){var a=p[n];if(a){var l=a.name+"";Ne.call(xi,l)||(xi[l]=[]),xi[l].push({name:n,func:a})}}),xi[yo(o,2).name]=[{name:"wrapper",func:o}],Ee.prototype.clone=function(){var e=new Ee(this.__wrapped__);return e.__actions__=qt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=qt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=qt(this.__views__),e},Ee.prototype.reverse=function(){if(this.__filtered__){var e=new Ee(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ee.prototype.value=function(){var e=this.__wrapped__.value(),n=this.__dir__,a=$e(e),l=n<0,d=a?e.length:0,g=function(Te,te,le){for(var ft=-1,rt=le.length;++ft<rt;){var Rt=le[ft],Ge=Rt.size;switch(Rt.type){case"drop":Te+=Ge;break;case"dropRight":te-=Ge;break;case"take":te=At(te,Te+Ge);break;case"takeRight":Te=ht(Te,te-Ge)}}return{start:Te,end:te}}(0,d,this.__views__),$=g.start,w=g.end,I=w-$,N=l?w:$-1,A=this.__iteratees__,z=A.length,Q=0,K=At(I,this.__takeCount__);if(!a||!l&&d==I&&K==I)return qc(e,this.__actions__);var se=[];e:for(;I--&&Q<K;){for(var R=-1,P=e[N+=n];++R<z;){var ce=A[R],B=ce.iteratee,ye=ce.type,ge=B(P);if(ye==2)P=ge;else if(!ge){if(ye==1)continue e;break e}}se[Q++]=P}return se},p.prototype.at=pd,p.prototype.chain=function(){return Cl(this)},p.prototype.commit=function(){return new cn(this.value(),this.__chain__)},p.prototype.next=function(){this.__values__===o&&(this.__values__=Rl(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?o:this.__values__[this.__index__++]}},p.prototype.plant=function(e){for(var n,a=this;a instanceof lo;){var l=ml(a);l.__index__=0,l.__values__=o,n?d.__wrapped__=l:n=l;var d=l;a=a.__wrapped__}return d.__wrapped__=e,n},p.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Ee){var n=e;return this.__actions__.length&&(n=new Ee(this)),(n=n.reverse()).__actions__.push({func:Io,args:[Ka],thisArg:o}),new cn(n,this.__chain__)}return this.thru(Ka)},p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=function(){return qc(this.__wrapped__,this.__actions__)},p.prototype.first=p.prototype.head,us&&(p.prototype[us]=function(){return this}),p}();St?((St.exports=bi)._=bi,ut._=bi):ze._=bi}).call(tn);var Jg=Pu.exports;function lr(o){return Array.isArray?Array.isArray(o):tf(o)==="[object Array]"}const Qg=1/0;function Xg(o){return o==null?"":function(t){if(typeof t=="string")return t;let r=t+"";return r=="0"&&1/t==-Qg?"-0":r}(o)}function Hn(o){return typeof o=="string"}function Kh(o){return typeof o=="number"}function Kg(o){return o===!0||o===!1||function(t){return ef(t)&&t!==null}(o)&&tf(o)=="[object Boolean]"}function ef(o){return typeof o=="object"}function en(o){return o!=null}function Su(o){return!o.trim().length}function tf(o){return o==null?o===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(o)}const e_=o=>`Missing ${o} property in key`,t_=o=>`Property 'weight' in key '${o}' must be a positive integer`,mh=Object.prototype.hasOwnProperty;class n_{constructor(t){this._keys=[],this._keyMap={};let r=0;t.forEach(i=>{let s=nf(i);this._keys.push(s),this._keyMap[s.id]=s,r+=s.weight}),this._keys.forEach(i=>{i.weight/=r})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function nf(o){let t=null,r=null,i=null,s=1,u=null;if(Hn(o)||lr(o))i=o,t=vh(o),r=Wu(o);else{if(!mh.call(o,"name"))throw new Error(e_("name"));const c=o.name;if(i=c,mh.call(o,"weight")&&(s=o.weight,s<=0))throw new Error(t_(c));t=vh(c),r=Wu(c),u=o.getFn}return{path:t,id:r,weight:s,src:i,getFn:u}}function vh(o){return lr(o)?o:o.split(".")}function Wu(o){return lr(o)?o.join("."):o}var ve={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(o,t)=>o.score===t.score?o.idx<t.idx?-1:1:o.score<t.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,useExtendedSearch:!1,getFn:function(o,t){let r=[],i=!1;const s=(u,c,h)=>{if(en(u))if(c[h]){const f=u[c[h]];if(!en(f))return;if(h===c.length-1&&(Hn(f)||Kh(f)||Kg(f)))r.push(Xg(f));else if(lr(f)){i=!0;for(let v=0,_=f.length;v<_;v+=1)s(f[v],c,h+1)}else c.length&&s(f,c,h+1)}else r.push(u)};return s(o,Hn(t)?t.split("."):t,0),i?r:r[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};const r_=/[^ ]+/g;class Ku{constructor({getFn:t=ve.getFn,fieldNormWeight:r=ve.fieldNormWeight}={}){this.norm=function(i=1,s=3){const u=new Map,c=Math.pow(10,s);return{get(h){const f=h.match(r_).length;if(u.has(f))return u.get(f);const v=1/Math.pow(f,.5*i),_=parseFloat(Math.round(v*c)/c);return u.set(f,_),_},clear(){u.clear()}}}(r,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((r,i)=>{this._keysMap[r.id]=i})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,Hn(this.docs[0])?this.docs.forEach((t,r)=>{this._addString(t,r)}):this.docs.forEach((t,r)=>{this._addObject(t,r)}),this.norm.clear())}add(t){const r=this.size();Hn(t)?this._addString(t,r):this._addObject(t,r)}removeAt(t){this.records.splice(t,1);for(let r=t,i=this.size();r<i;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(t,r){return t[this._keysMap[r]]}size(){return this.records.length}_addString(t,r){if(!en(t)||Su(t))return;let i={v:t,i:r,n:this.norm.get(t)};this.records.push(i)}_addObject(t,r){let i={i:r,$:{}};this.keys.forEach((s,u)=>{let c=s.getFn?s.getFn(t):this.getFn(t,s.path);if(en(c)){if(lr(c)){let h=[];const f=[{nestedArrIndex:-1,value:c}];for(;f.length;){const{nestedArrIndex:v,value:_}=f.pop();if(en(_))if(Hn(_)&&!Su(_)){let b={v:_,i:v,n:this.norm.get(_)};h.push(b)}else lr(_)&&_.forEach((b,x)=>{f.push({nestedArrIndex:x,value:b})})}i.$[u]=h}else if(Hn(c)&&!Su(c)){let h={v:c,n:this.norm.get(c)};i.$[u]=h}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function rf(o,t,{getFn:r=ve.getFn,fieldNormWeight:i=ve.fieldNormWeight}={}){const s=new Ku({getFn:r,fieldNormWeight:i});return s.setKeys(o.map(nf)),s.setSources(t),s.create(),s}function Bo(o,{errors:t=0,currentLocation:r=0,expectedLocation:i=0,distance:s=ve.distance,ignoreLocation:u=ve.ignoreLocation}={}){const c=t/o.length;if(u)return c;const h=Math.abs(i-r);return s?c+h/s:h?1:c}const ti=32;function i_(o,t,r,{location:i=ve.location,distance:s=ve.distance,threshold:u=ve.threshold,findAllMatches:c=ve.findAllMatches,minMatchCharLength:h=ve.minMatchCharLength,includeMatches:f=ve.includeMatches,ignoreLocation:v=ve.ignoreLocation}={}){if(t.length>ti)throw new Error(`Pattern length exceeds max of ${ti}.`);const _=t.length,b=o.length,x=Math.max(0,Math.min(i,b));let E=u,T=x;const q=h>1||f,L=q?Array(b):[];let S;for(;(S=o.indexOf(t,T))>-1;){let pe=Bo(t,{currentLocation:S,expectedLocation:x,distance:s,ignoreLocation:v});if(E=Math.min(pe,E),T=S+_,q){let Ie=0;for(;Ie<_;)L[S+Ie]=1,Ie+=1}}T=-1;let F=[],ne=1,de=_+b;const oe=1<<_-1;for(let pe=0;pe<_;pe+=1){let Ie=0,_e=de;for(;Ie<_e;)Bo(t,{errors:pe,currentLocation:x+_e,expectedLocation:x,distance:s,ignoreLocation:v})<=E?Ie=_e:de=_e,_e=Math.floor((de-Ie)/2+Ie);de=_e;let Fe=Math.max(1,x-_e+1),Pe=c?b:Math.min(x+_e,b)+_,st=Array(Pe+2);st[Pe+1]=(1<<pe)-1;for(let Se=Pe;Se>=Fe;Se-=1){let we=Se-1,at=r[o.charAt(we)];if(q&&(L[we]=+!!at),st[Se]=(st[Se+1]<<1|1)&at,pe&&(st[Se]|=(F[Se+1]|F[Se])<<1|1|F[Se+1]),st[Se]&oe&&(ne=Bo(t,{errors:pe,currentLocation:we,expectedLocation:x,distance:s,ignoreLocation:v}),ne<=E)){if(E=ne,T=we,T<=x)break;Fe=Math.max(1,2*x-T)}}if(Bo(t,{errors:pe+1,currentLocation:x,expectedLocation:x,distance:s,ignoreLocation:v})>E)break;F=st}const Re={isMatch:T>=0,score:Math.max(.001,ne)};if(q){const pe=function(Ie=[],_e=ve.minMatchCharLength){let Fe=[],Pe=-1,st=-1,Se=0;for(let we=Ie.length;Se<we;Se+=1){let at=Ie[Se];at&&Pe===-1?Pe=Se:at||Pe===-1||(st=Se-1,st-Pe+1>=_e&&Fe.push([Pe,st]),Pe=-1)}return Ie[Se-1]&&Se-Pe>=_e&&Fe.push([Pe,Se-1]),Fe}(L,h);pe.length?f&&(Re.indices=pe):Re.isMatch=!1}return Re}function s_(o){let t={};for(let r=0,i=o.length;r<i;r+=1){const s=o.charAt(r);t[s]=(t[s]||0)|1<<i-r-1}return t}class sf{constructor(t,{location:r=ve.location,threshold:i=ve.threshold,distance:s=ve.distance,includeMatches:u=ve.includeMatches,findAllMatches:c=ve.findAllMatches,minMatchCharLength:h=ve.minMatchCharLength,isCaseSensitive:f=ve.isCaseSensitive,ignoreLocation:v=ve.ignoreLocation}={}){if(this.options={location:r,threshold:i,distance:s,includeMatches:u,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:f,ignoreLocation:v},this.pattern=f?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const _=(x,E)=>{this.chunks.push({pattern:x,alphabet:s_(x),startIndex:E})},b=this.pattern.length;if(b>ti){let x=0;const E=b%ti,T=b-E;for(;x<T;)_(this.pattern.substr(x,ti),x),x+=ti;if(E){const q=b-ti;_(this.pattern.substr(q),q)}}else _(this.pattern,0)}searchIn(t){const{isCaseSensitive:r,includeMatches:i}=this.options;if(r||(t=t.toLowerCase()),this.pattern===t){let T={isMatch:!0,score:0};return i&&(T.indices=[[0,t.length-1]]),T}const{location:s,distance:u,threshold:c,findAllMatches:h,minMatchCharLength:f,ignoreLocation:v}=this.options;let _=[],b=0,x=!1;this.chunks.forEach(({pattern:T,alphabet:q,startIndex:L})=>{const{isMatch:S,score:F,indices:ne}=i_(t,T,q,{location:s+L,distance:u,threshold:c,findAllMatches:h,minMatchCharLength:f,includeMatches:i,ignoreLocation:v});S&&(x=!0),b+=F,S&&ne&&(_=[..._,...ne])});let E={isMatch:x,score:x?b/this.chunks.length:1};return x&&i&&(E.indices=_),E}}class Or{constructor(t){this.pattern=t}static isMultiMatch(t){return yh(t,this.multiRegex)}static isSingleMatch(t){return yh(t,this.singleRegex)}search(){}}function yh(o,t){const r=o.match(t);return r?r[1]:null}class of extends Or{constructor(t,{location:r=ve.location,threshold:i=ve.threshold,distance:s=ve.distance,includeMatches:u=ve.includeMatches,findAllMatches:c=ve.findAllMatches,minMatchCharLength:h=ve.minMatchCharLength,isCaseSensitive:f=ve.isCaseSensitive,ignoreLocation:v=ve.ignoreLocation}={}){super(t),this._bitapSearch=new sf(t,{location:r,threshold:i,distance:s,includeMatches:u,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:f,ignoreLocation:v})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class af extends Or{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let r,i=0;const s=[],u=this.pattern.length;for(;(r=t.indexOf(this.pattern,i))>-1;)i=r+u,s.push([r,i-1]);const c=!!s.length;return{isMatch:c,score:c?0:1,indices:s}}}const Hu=[class extends Or{constructor(o){super(o)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(o){const t=o===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},af,class extends Or{constructor(o){super(o)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(o){const t=o.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends Or{constructor(o){super(o)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(o){const t=!o.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,o.length-1]}}},class extends Or{constructor(o){super(o)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(o){const t=!o.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,o.length-1]}}},class extends Or{constructor(o){super(o)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(o){const t=o.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[o.length-this.pattern.length,o.length-1]}}},class extends Or{constructor(o){super(o)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(o){const t=o.indexOf(this.pattern)===-1;return{isMatch:t,score:t?0:1,indices:[0,o.length-1]}}},of],bh=Hu.length,o_=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,a_=new Set([of.type,af.type]);class u_{constructor(t,{isCaseSensitive:r=ve.isCaseSensitive,includeMatches:i=ve.includeMatches,minMatchCharLength:s=ve.minMatchCharLength,ignoreLocation:u=ve.ignoreLocation,findAllMatches:c=ve.findAllMatches,location:h=ve.location,threshold:f=ve.threshold,distance:v=ve.distance}={}){this.query=null,this.options={isCaseSensitive:r,includeMatches:i,minMatchCharLength:s,findAllMatches:c,ignoreLocation:u,location:h,threshold:f,distance:v},this.pattern=r?t:t.toLowerCase(),this.query=function(_,b={}){return _.split("|").map(x=>{let E=x.trim().split(o_).filter(q=>q&&!!q.trim()),T=[];for(let q=0,L=E.length;q<L;q+=1){const S=E[q];let F=!1,ne=-1;for(;!F&&++ne<bh;){const de=Hu[ne];let oe=de.isMultiMatch(S);oe&&(T.push(new de(oe,b)),F=!0)}if(!F)for(ne=-1;++ne<bh;){const de=Hu[ne];let oe=de.isSingleMatch(S);if(oe){T.push(new de(oe,b));break}}}return T})}(this.pattern,this.options)}static condition(t,r){return r.useExtendedSearch}searchIn(t){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let u=0,c=[],h=0;for(let f=0,v=r.length;f<v;f+=1){const _=r[f];c.length=0,u=0;for(let b=0,x=_.length;b<x;b+=1){const E=_[b],{isMatch:T,indices:q,score:L}=E.search(t);if(!T){h=0,u=0,c.length=0;break}if(u+=1,h+=L,i){const S=E.constructor.type;a_.has(S)?c=[...c,...q]:c.push(q)}}if(u){let b={isMatch:!0,score:h/u};return i&&(b.indices=c),b}}return{isMatch:!1,score:1}}}const Bu=[];function Vu(o,t){for(let r=0,i=Bu.length;r<i;r+=1){let s=Bu[r];if(s.condition(o,t))return new s(o,t)}return new sf(o,t)}const ec="$and",c_="$or",$h="$path",l_="$val",Iu=o=>!(!o[ec]&&!o[c_]),wh=o=>({[ec]:Object.keys(o).map(t=>({[t]:o[t]}))});function uf(o,t,{auto:r=!0}={}){const i=s=>{let u=Object.keys(s);const c=(f=>!!f[$h])(s);if(!c&&u.length>1&&!Iu(s))return i(wh(s));if((f=>!lr(f)&&ef(f)&&!Iu(f))(s)){const f=c?s[$h]:u[0],v=c?s[l_]:s[f];if(!Hn(v))throw new Error((b=>`Invalid value for key ${b}`)(f));const _={keyId:Wu(f),pattern:v};return r&&(_.searcher=Vu(v,t)),_}let h={children:[],operator:u[0]};return u.forEach(f=>{const v=s[f];lr(v)&&v.forEach(_=>{h.children.push(i(_))})}),h};return Iu(o)||(o=wh(o)),i(o)}function h_(o,t){const r=o.matches;t.matches=[],en(r)&&r.forEach(i=>{if(!en(i.indices)||!i.indices.length)return;const{indices:s,value:u}=i;let c={indices:s,value:u};i.key&&(c.key=i.key.src),i.idx>-1&&(c.refIndex=i.idx),t.matches.push(c)})}function f_(o,t){t.score=o.score}class Ti{constructor(t,r={},i){this.options={...ve,...r},this.options.useExtendedSearch,this._keyStore=new n_(this.options.keys),this.setCollection(t,i)}setCollection(t,r){if(this._docs=t,r&&!(r instanceof Ku))throw new Error("Incorrect 'index' type");this._myIndex=r||rf(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){en(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const r=[];for(let i=0,s=this._docs.length;i<s;i+=1){const u=this._docs[i];t(u,i)&&(this.removeAt(i),i-=1,s-=1,r.push(u))}return r}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:r=-1}={}){const{includeMatches:i,includeScore:s,shouldSort:u,sortFn:c,ignoreFieldNorm:h}=this.options;let f=Hn(t)?Hn(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(v,{ignoreFieldNorm:_=ve.ignoreFieldNorm}){v.forEach(b=>{let x=1;b.matches.forEach(({key:E,norm:T,score:q})=>{const L=E?E.weight:null;x*=Math.pow(q===0&&L?Number.EPSILON:q,(L||1)*(_?1:T))}),b.score=x})}(f,{ignoreFieldNorm:h}),u&&f.sort(c),Kh(r)&&r>-1&&(f=f.slice(0,r)),function(v,_,{includeMatches:b=ve.includeMatches,includeScore:x=ve.includeScore}={}){const E=[];return b&&E.push(h_),x&&E.push(f_),v.map(T=>{const{idx:q}=T,L={item:_[q],refIndex:q};return E.length&&E.forEach(S=>{S(T,L)}),L})}(f,this._docs,{includeMatches:i,includeScore:s})}_searchStringList(t){const r=Vu(t,this.options),{records:i}=this._myIndex,s=[];return i.forEach(({v:u,i:c,n:h})=>{if(!en(u))return;const{isMatch:f,score:v,indices:_}=r.searchIn(u);f&&s.push({item:u,idx:c,matches:[{score:v,value:u,norm:h,indices:_}]})}),s}_searchLogical(t){const r=uf(t,this.options),i=(h,f,v)=>{if(!h.children){const{keyId:b,searcher:x}=h,E=this._findMatches({key:this._keyStore.get(b),value:this._myIndex.getValueForItemAtKeyId(f,b),searcher:x});return E&&E.length?[{idx:v,item:f,matches:E}]:[]}const _=[];for(let b=0,x=h.children.length;b<x;b+=1){const E=h.children[b],T=i(E,f,v);if(T.length)_.push(...T);else if(h.operator===ec)return[]}return _},s=this._myIndex.records,u={},c=[];return s.forEach(({$:h,i:f})=>{if(en(h)){let v=i(r,h,f);v.length&&(u[f]||(u[f]={idx:f,item:h,matches:[]},c.push(u[f])),v.forEach(({matches:_})=>{u[f].matches.push(..._)}))}}),c}_searchObjectList(t){const r=Vu(t,this.options),{keys:i,records:s}=this._myIndex,u=[];return s.forEach(({$:c,i:h})=>{if(!en(c))return;let f=[];i.forEach((v,_)=>{f.push(...this._findMatches({key:v,value:c[_],searcher:r}))}),f.length&&u.push({idx:h,item:c,matches:f})}),u}_findMatches({key:t,value:r,searcher:i}){if(!en(r))return[];let s=[];if(lr(r))r.forEach(({v:u,i:c,n:h})=>{if(!en(u))return;const{isMatch:f,score:v,indices:_}=i.searchIn(u);f&&s.push({score:v,key:t,value:u,idx:c,norm:h,indices:_})});else{const{v:u,n:c}=r,{isMatch:h,score:f,indices:v}=i.searchIn(u);h&&s.push({score:f,key:t,value:u,norm:c,indices:v})}return s}}Ti.version="7.0.0",Ti.createIndex=rf,Ti.parseIndex=function(o,{getFn:t=ve.getFn,fieldNormWeight:r=ve.fieldNormWeight}={}){const{keys:i,records:s}=o,u=new Ku({getFn:t,fieldNormWeight:r});return u.setKeys(i),u.setIndexRecords(s),u},Ti.config=ve,Ti.parseQuery=uf,function(...o){Bu.push(...o)}(u_);const Lr=class Lr{constructor(t,r){m(this,"_disposers",[]);m(this,"_allMentionables",bt([]));m(this,"_breadcrumbIds",bt([]));m(this,"_userQuery",bt(""));m(this,"_active",bt(!1));m(this,"_allGroups",vu([this._active,this._allMentionables],([t,r])=>t?Rp(r):[]));m(this,"_currentGroup",vu([this._breadcrumbIds,this._allGroups],([t,r])=>{if(t.length===0)return;const i=t[t.length-1];return r.find(s=>ks(s)&&s.id===i)}));m(this,"dispose",()=>{for(const t of this._disposers)t()});m(this,"openDropdown",()=>{this._active.set(!0)});m(this,"closeDropdown",()=>{this._active.set(!1),this._resetState()});m(this,"toggleDropdown",()=>pt(this._active)?(this.closeDropdown(),!1):(this.openDropdown(),!0));m(this,"pushBreadcrumb",t=>{pt(this._active)&&this._breadcrumbIds.update(r=>[...r,t.id])});m(this,"popBreadcrumb",()=>{pt(this._active)&&this._breadcrumbIds.update(t=>t.slice(0,-1))});m(this,"selectMentionable",t=>{var s;const r=this._chatModel.extensionClient,i=this._chatModel.specialContextInputModel;return ks(t)&&t.type==="breadcrumb"?(this.pushBreadcrumb(t),!0):t.type==="breadcrumb-back"?(this.popBreadcrumb(),!0):qh(t)?(i.markAllActive(),this.closeDropdown(),r.reportWebviewClientEvent(Au.chatRestoreDefaultContext),!0):t.clearContext?(i.markAllInactive(),this.closeDropdown(),r.reportWebviewClientEvent(Au.chatClearContext),!0):t.userGuidelines?(r.openSettingsPage("userGuidelines"),this.closeDropdown(),!0):((s=this._insertMentionNode)==null||s.call(this,t),this.closeDropdown(),!0)});m(this,"_displayItems",vu([this._active,this._breadcrumbIds,this._userQuery,this._currentGroup,this.allGroups],([t,r,i,s,u])=>t?r.length>0&&s?[{...s,type:"breadcrumb-back"},...s.group.items.slice(0,Lr.SINGLE_GROUP_MAX_ITEMS).map(c=>({...c,type:"item"}))]:i.length>0?u.flatMap(c=>[{...c,type:"breadcrumb"},...c.group.items.slice(0,Lr.MULTI_GROUP_MAX_ITEMS).map(h=>({...h,type:"item"}))]):[{...jp,type:"item"},...u.map(c=>({...c,type:"breadcrumb"})),{...Dp,type:"item"},{...Up,type:"item"}]:[]));m(this,"_refreshSeqNum",0);m(this,"_refreshMentionables",Jg.throttle(async()=>{if(!pt(this._active))return;this._refreshSeqNum++;const t=this._refreshSeqNum,r=this._chatModel.currentConversationModel&&Ri(this._chatModel.currentConversationModel),i=pt(this._userQuery),s=await this._chatModel.extensionClient.getSuggestions(i,r);t===this._refreshSeqNum&&this._allMentionables.set(d_(i,s))},Lr.REFRESH_THROTTLE_MS,{leading:!0,trailing:!0}));this._chatModel=t,this._insertMentionNode=r,this._disposers.push(this._userQuery.subscribe(this._refreshMentionables)),this._disposers.push(this._active.subscribe(this._refreshMentionables))}get allGroups(){return this._allGroups}get currentGroup(){return this._currentGroup}get breadcrumbIds(){return this._breadcrumbIds}get displayItems(){return this._displayItems}get active(){return this._active}get userQuery(){return this._userQuery}_resetState(){this._breadcrumbIds.set([]),this._userQuery.set("")}};m(Lr,"REFRESH_THROTTLE_MS",600),m(Lr,"SINGLE_GROUP_MAX_ITEMS",12),m(Lr,"MULTI_GROUP_MAX_ITEMS",6);let Gu=Lr;const d_=(o,t)=>{if(o.length<=1)return t;const r=new Ti(t,{keys:["label"],threshold:1,minMatchCharLength:0,ignoreLocation:!0,includeScore:!0,useExtendedSearch:!1,shouldSort:!0,findAllMatches:!0}).search(o);return r.length===0?t:r.map(i=>i.item)};function ta(o){switch(o){case Mt.DEFAULT:return th;case Mt.PROTOTYPER:return Pp;case Mt.BRAINSTORM:return zp;case Mt.REVIEWER:return qp;default:return th}}function p_(o){let t,r,i,s=o[0].label+"";return{c(){t=We("span"),r=We("span"),i=xt(s),De(r,"class","c-mentionable-group-label__text right"),De(t,"class","c-mentionable-group-label")},m(u,c){re(u,t,c),He(t,r),He(r,i)},p(u,c){1&c&&s!==(s=u[0].label+"")&&cr(i,s)},i:Be,o:Be,d(u){u&&ie(t)}}}function g_(o){let t,r;return t=new Hp({props:{$$slots:{text:[C_],leftIcon:[x_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};17&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function __(o){let t,r=o[0].label+"";return{c(){t=xt(r)},m(i,s){re(i,t,s)},p(i,s){1&s&&r!==(r=i[0].label+"")&&cr(t,r)},i:Be,o:Be,d(i){i&&ie(t)}}}function m_(o){let t,r;return t=new nn({props:{filepath:o[0].recentFile.pathName,$$slots:{leftIcon:[S_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].recentFile.pathName),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function v_(o){let t,r;return t=new nn({props:{filepath:o[0].selection.pathName,$$slots:{leftIcon:[I_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].selection.pathName),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function y_(o){let t,r;return t=new nn({props:{filepath:o[0].sourceFolder.folderRoot,$$slots:{leftIcon:[E_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].sourceFolder.folderRoot),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function b_(o){let t,r;return t=new nn({props:{filepath:o[0].externalSource.name,$$slots:{leftIcon:[M_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].externalSource.name),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function $_(o){let t,r;return t=new nn({props:{filepath:o[0].folder.pathName,$$slots:{leftIcon:[k_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].folder.pathName),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function w_(o){let t,r;return t=new nn({props:{filepath:o[0].file.pathName,$$slots:{leftIcon:[A_]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};1&s&&(u.filepath=i[0].file.pathName),16&s&&(u.$$scope={dirty:s,ctx:i}),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function x_(o){let t,r,i;var s=ta(o[0].personality.type);return s&&(r=zi(s,{})),{c(){t=We("span"),r&&G(r.$$.fragment),De(t,"slot","leftIcon"),De(t,"class","c-context-menu-item__icon svelte-1b93fdw")},m(u,c){re(u,t,c),r&&Z(r,t,null),i=!0},p(u,c){if(1&c&&s!==(s=ta(u[0].personality.type))){if(r){$t();const h=r;U(h.$$.fragment,1,0,()=>{Y(h,1)}),wt()}s?(r=zi(s,{}),G(r.$$.fragment),O(r.$$.fragment,1),Z(r,t,null)):r=null}},i(u){i||(r&&O(r.$$.fragment,u),i=!0)},o(u){r&&U(r.$$.fragment,u),i=!1},d(u){u&&ie(t),r&&Y(r)}}}function C_(o){let t,r,i=o[0].label+"";return{c(){t=We("span"),r=xt(i),De(t,"slot","text")},m(s,u){re(s,t,u),He(t,r)},p(s,u){1&u&&i!==(i=s[0].label+"")&&cr(r,i)},d(s){s&&ie(t)}}}function S_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"description"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function I_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"text_select_start"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function E_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"folder_managed"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function M_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"import_contacts"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function k_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"folder_open"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function A_(o){let t,r;return t=new Pi({props:{slot:"leftIcon",iconName:"description"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function T_(o){let t,r,i,s,u,c,h,f,v,_,b,x,E;const T=[w_,$_,b_,y_,v_,m_,__,g_,p_],q=[];function L(S,F){return 1&F&&(t=null),1&F&&(r=null),1&F&&(i=null),1&F&&(s=null),1&F&&(u=null),1&F&&(c=null),1&F&&(h=null),1&F&&(f=null),1&F&&(v=null),t==null&&(t=!!Ju(S[0])),t?0:(r==null&&(r=!!Qu(S[0])),r?1:(i==null&&(i=!!Xu(S[0])),i?2:(s==null&&(s=!!Xo(S[0])),s?3:(u==null&&(u=!!Qo(S[0])),u?4:(c==null&&(c=!!Jo(S[0])),c?5:(h==null&&(h=!!ks(S[0])),h?6:(f==null&&(f=!!na(S[0])),f?7:(v==null&&(v=!!(qh(S[0])||Wp(S[0])||Ko(S[0]))),v?8:-1))))))))}return~(_=L(o,-1))&&(b=q[_]=T[_](o)),{c(){b&&b.c(),x=hr()},m(S,F){~_&&q[_].m(S,F),re(S,x,F),E=!0},p(S,F){let ne=_;_=L(S,F),_===ne?~_&&q[_].p(S,F):(b&&($t(),U(q[ne],1,1,()=>{q[ne]=null}),wt()),~_?(b=q[_],b?b.p(S,F):(b=q[_]=T[_](S),b.c()),O(b,1),b.m(x.parentNode,x)):b=null)},i(S){E||(O(b),E=!0)},o(S){U(b),E=!1},d(S){S&&ie(x),~_&&q[_].d(S)}}}function F_(o){let t,r,i;var s=o[3];function u(c,h){return{props:{highlight:c[2],onSelect:c[1],$$slots:{default:[T_]},$$scope:{ctx:c}}}}return s&&(t=zi(s,u(o))),{c(){t&&G(t.$$.fragment),r=hr()},m(c,h){t&&Z(t,c,h),re(c,r,h),i=!0},p(c,[h]){if(8&h&&s!==(s=c[3])){if(t){$t();const f=t;U(f.$$.fragment,1,0,()=>{Y(f,1)}),wt()}s?(t=zi(s,u(c)),G(t.$$.fragment),O(t.$$.fragment,1),Z(t,r.parentNode,r)):t=null}else if(s){const f={};4&h&&(f.highlight=c[2]),2&h&&(f.onSelect=c[1]),17&h&&(f.$$scope={dirty:h,ctx:c}),t.$set(f)}},i(c){i||(t&&O(t.$$.fragment,c),i=!0)},o(c){t&&U(t.$$.fragment,c),i=!1},d(c){c&&ie(r),t&&Y(t,c)}}}function O_(o,t,r){let i,{item:s}=t,{onSelect:u}=t,{highlight:c}=t;return o.$$set=h=>{"item"in h&&r(0,s=h.item),"onSelect"in h&&r(1,u=h.onSelect),"highlight"in h&&r(2,c=h.highlight)},o.$$.update=()=>{1&o.$$.dirty&&(s.type==="breadcrumb-back"?r(3,i=wu.BreadcrumbBackItem):s.type==="breadcrumb"&&ks(s)?r(3,i=wu.BreadcrumbItem):s.type!=="item"||ks(s)||r(3,i=wu.Item))},[s,u,c,i]}class L_ extends oi{constructor(t){super(),ai(this,t,O_,F_,ui,{item:0,onSelect:1,highlight:2})}}function N_(o){let t,r=o[0].label+"";return{c(){t=xt(r)},m(i,s){re(i,t,s)},p(i,s){1&s&&r!==(r=i[0].label+"")&&cr(t,r)},i:Be,o:Be,d(i){i&&ie(t)}}}function R_(o){let t,r,i,s,u,c,h,f;return r=new Bp({props:{heightPx:32,floatHeight:4,animationDuration:2.25,$$slots:{default:[H_]},$$scope:{ctx:o}}}),u=new eh({props:{size:2,weight:"medium",$$slots:{default:[B_]},$$scope:{ctx:o}}}),h=new eh({props:{size:1,$$slots:{default:[V_]},$$scope:{ctx:o}}}),{c(){t=We("div"),G(r.$$.fragment),i=Ue(),s=We("div"),G(u.$$.fragment),c=Ue(),G(h.$$.fragment),De(t,"class","c-mention-hover-contents__personality-icon svelte-11069rs"),De(s,"class","c-mention-hover-contents__personality svelte-11069rs")},m(v,_){re(v,t,_),Z(r,t,null),re(v,i,_),re(v,s,_),Z(u,s,null),He(s,c),Z(h,s,null),f=!0},p(v,_){const b={};3&_&&(b.$$scope={dirty:_,ctx:v}),r.$set(b);const x={};3&_&&(x.$$scope={dirty:_,ctx:v}),u.$set(x);const E={};3&_&&(E.$$scope={dirty:_,ctx:v}),h.$set(E)},i(v){f||(O(r.$$.fragment,v),O(u.$$.fragment,v),O(h.$$.fragment,v),f=!0)},o(v){U(r.$$.fragment,v),U(u.$$.fragment,v),U(h.$$.fragment,v),f=!1},d(v){v&&(ie(t),ie(i),ie(s)),Y(r),Y(u),Y(h)}}}function j_(o){var u,c;let t,r,i,s;return t=new Vp({}),i=new nn({props:{filepath:`${o[0].selection.pathName}:L${(u=o[0].selection.fullRange)==null?void 0:u.startLineNumber}-${(c=o[0].selection.fullRange)==null?void 0:c.endLineNumber}`}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(h,f){Z(t,h,f),re(h,r,f),Z(i,h,f),s=!0},p(h,f){var _,b;const v={};1&f&&(v.filepath=`${h[0].selection.pathName}:L${(_=h[0].selection.fullRange)==null?void 0:_.startLineNumber}-${(b=h[0].selection.fullRange)==null?void 0:b.endLineNumber}`),i.$set(v)},i(h){s||(O(t.$$.fragment,h),O(i.$$.fragment,h),s=!0)},o(h){U(t.$$.fragment,h),U(i.$$.fragment,h),s=!1},d(h){h&&ie(r),Y(t,h),Y(i,h)}}}function D_(o){let t,r,i=o[0].userGuidelines.overLimit&&xh(o);return{c(){i&&i.c(),t=hr()},m(s,u){i&&i.m(s,u),re(s,t,u),r=!0},p(s,u){s[0].userGuidelines.overLimit?i?(i.p(s,u),1&u&&O(i,1)):(i=xh(s),i.c(),O(i,1),i.m(t.parentNode,t)):i&&($t(),U(i,1,1,()=>{i=null}),wt())},i(s){r||(O(i),r=!0)},o(s){U(i),r=!1},d(s){s&&ie(t),i&&i.d(s)}}}function U_(o){let t,r,i,s,u,c,h,f;return i=new Gp({}),u=new nn({props:{class:"c-source-folder-item",filepath:o[0].sourceFolder.folderRoot}}),h=new Zp({props:{class:"guidelines-filespan",sourceFolder:o[0].sourceFolder}}),{c(){t=We("div"),r=We("div"),G(i.$$.fragment),s=Ue(),G(u.$$.fragment),c=Ue(),G(h.$$.fragment),De(r,"class","l-source-folder-name svelte-11069rs"),De(t,"class","l-mention-hover-contents__source-folder")},m(v,_){re(v,t,_),He(t,r),Z(i,r,null),He(r,s),Z(u,r,null),He(t,c),Z(h,t,null),f=!0},p(v,_){const b={};1&_&&(b.filepath=v[0].sourceFolder.folderRoot),u.$set(b);const x={};1&_&&(x.sourceFolder=v[0].sourceFolder),h.$set(x)},i(v){f||(O(i.$$.fragment,v),O(u.$$.fragment,v),O(h.$$.fragment,v),f=!0)},o(v){U(i.$$.fragment,v),U(u.$$.fragment,v),U(h.$$.fragment,v),f=!1},d(v){v&&ie(t),Y(i),Y(u),Y(h)}}}function q_(o){let t,r,i,s;return t=new Yp({}),i=new nn({props:{filepath:o[0].externalSource.name}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};1&c&&(h.filepath=u[0].externalSource.name),i.$set(h)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function z_(o){let t,r,i,s;return t=new rg({}),i=new nn({props:{filepath:o[0].folder.pathName}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};1&c&&(h.filepath=u[0].folder.pathName),i.$set(h)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function P_(o){let t,r,i,s;return t=new Wh({}),i=new nn({props:{filepath:o[0].recentFile.pathName}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};1&c&&(h.filepath=u[0].recentFile.pathName),i.$set(h)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function W_(o){let t,r,i,s;return t=new Wh({}),i=new nn({props:{filepath:o[0].file.pathName}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};1&c&&(h.filepath=u[0].file.pathName),i.$set(h)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function H_(o){let t,r,i;var s=ta(o[0].personality.type);return s&&(t=zi(s,{})),{c(){t&&G(t.$$.fragment),r=hr()},m(u,c){t&&Z(t,u,c),re(u,r,c),i=!0},p(u,c){if(1&c&&s!==(s=ta(u[0].personality.type))){if(t){$t();const h=t;U(h.$$.fragment,1,0,()=>{Y(h,1)}),wt()}s?(t=zi(s,{}),G(t.$$.fragment),O(t.$$.fragment,1),Z(t,r.parentNode,r)):t=null}},i(u){i||(t&&O(t.$$.fragment,u),i=!0)},o(u){t&&U(t.$$.fragment,u),i=!1},d(u){u&&ie(r),t&&Y(t,u)}}}function B_(o){let t,r=o[0].label+"";return{c(){t=xt(r)},m(i,s){re(i,t,s)},p(i,s){1&s&&r!==(r=i[0].label+"")&&cr(t,r)},d(i){i&&ie(t)}}}function V_(o){let t,r=o[0].personality.description+"";return{c(){t=xt(r)},m(i,s){re(i,t,s)},p(i,s){1&s&&r!==(r=i[0].personality.description+"")&&cr(t,r)},d(i){i&&ie(t)}}}function xh(o){let t,r,i,s;return t=new ag({props:{class:"c-mention-hover-contents__guidelines-warning-icon"}}),i=new nn({props:{filepath:`Guidelines exceeded length limit of ${o[0].userGuidelines.lengthLimit} characters`}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};1&c&&(h.filepath=`Guidelines exceeded length limit of ${u[0].userGuidelines.lengthLimit} characters`),i.$set(h)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function G_(o){let t,r,i,s,u,c,h,f,v,_,b,x;const E=[W_,P_,z_,q_,U_,D_,j_,R_,N_],T=[];function q(L,S){return 1&S&&(r=null),1&S&&(i=null),1&S&&(s=null),1&S&&(u=null),1&S&&(c=null),1&S&&(h=null),1&S&&(f=null),1&S&&(v=null),r==null&&(r=!(!L[0]||!Ju(L[0]))),r?0:(i==null&&(i=!(!L[0]||!Jo(L[0]))),i?1:(s==null&&(s=!(!L[0]||!Qu(L[0]))),s?2:(u==null&&(u=!(!L[0]||!Xu(L[0]))),u?3:(c==null&&(c=!(!L[0]||!Xo(L[0]))),c?4:(h==null&&(h=!!(L[0]&&Ko(L[0])&&L[0].userGuidelines.enabled)),h?5:(f==null&&(f=!(!L[0]||!Qo(L[0]))),f?6:(v==null&&(v=!(!L[0]||!na(L[0]))),v?7:8)))))))}return _=q(o,-1),b=T[_]=E[_](o),{c(){t=We("div"),b.c(),De(t,"class","c-mention-hover-contents svelte-11069rs")},m(L,S){re(L,t,S),T[_].m(t,null),x=!0},p(L,[S]){let F=_;_=q(L,S),_===F?T[_].p(L,S):($t(),U(T[F],1,1,()=>{T[F]=null}),wt(),b=T[_],b?b.p(L,S):(b=T[_]=E[_](L),b.c()),O(b,1),b.m(t,null))},i(L){x||(O(b),x=!0)},o(L){U(b),x=!1},d(L){L&&ie(t),T[_].d()}}}function Z_(o,t,r){let{option:i}=t;return o.$$set=s=>{"option"in s&&r(0,i=s.option)},[i]}class Y_ extends oi{constructor(t){super(),ai(this,t,Z_,G_,ui,{option:0})}}function Ch(o,t,r){const i=o.slice();return i[15]=t[r],i}function Sh(o){let t,r;function i(){return o[8](o[15])}return t=new L_({props:{item:o[15],highlight:o[15]===o[14],onSelect:i}}),{c(){G(t.$$.fragment)},m(s,u){Z(t,s,u),r=!0},p(s,u){o=s;const c={};4&u&&(c.item=o[15]),16388&u&&(c.highlight=o[15]===o[14]),4&u&&(c.onSelect=i),t.$set(c)},i(s){r||(O(t.$$.fragment,s),r=!0)},o(s){U(t.$$.fragment,s),r=!1},d(s){Y(t,s)}}}function J_(o){let t,r,i=Yo(o[2]),s=[];for(let c=0;c<i.length;c+=1)s[c]=Sh(Ch(o,i,c));const u=c=>U(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();t=hr()},m(c,h){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(c,h);re(c,t,h),r=!0},p(c,h){if(16420&h){let f;for(i=Yo(c[2]),f=0;f<i.length;f+=1){const v=Ch(c,i,f);s[f]?(s[f].p(v,h),O(s[f],1)):(s[f]=Sh(v),s[f].c(),O(s[f],1),s[f].m(t.parentNode,t))}for($t(),f=i.length;f<s.length;f+=1)u(f);wt()}},i(c){if(!r){for(let h=0;h<i.length;h+=1)O(s[h]);r=!0}},o(c){s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)U(s[h]);r=!1},d(c){c&&ie(t),Dh(s,c)}}}function Q_(o){let t,r;return t=new Y_({props:{slot:"mentionable",option:o[13]}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p(i,s){const u={};8192&s&&(u.option=i[13]),t.$set(u)},i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function X_(o){let t,r,i,s;return t=new ku.Menu.Root({props:{mentionables:o[2],onQueryUpdate:o[4],onSelectMentionable:o[5],$$slots:{default:[J_,({activeItem:u})=>({14:u}),({activeItem:u})=>u?16384:0]},$$scope:{ctx:o}}}),i=new ku.ChipTooltip({props:{$$slots:{mentionable:[Q_,({mentionable:u})=>({13:u}),({mentionable:u})=>u?8192:0]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment)},m(u,c){Z(t,u,c),re(u,r,c),Z(i,u,c),s=!0},p(u,c){const h={};4&c&&(h.mentionables=u[2]),278532&c&&(h.$$scope={dirty:c,ctx:u}),t.$set(h);const f={};270336&c&&(f.$$scope={dirty:c,ctx:u}),i.$set(f)},i(u){s||(O(t.$$.fragment,u),O(i.$$.fragment,u),s=!0)},o(u){U(t.$$.fragment,u),U(i.$$.fragment,u),s=!1},d(u){u&&ie(r),Y(t,u),Y(i,u)}}}function K_(o){let t,r,i={triggerCharacter:"@",onMentionItemsUpdated:o[0],$$slots:{default:[X_]},$$scope:{ctx:o}};return t=new ku.Root({props:i}),o[9](t),{c(){G(t.$$.fragment)},m(s,u){Z(t,s,u),r=!0},p(s,[u]){const c={};1&u&&(c.onMentionItemsUpdated=s[0]),262148&u&&(c.$$scope={dirty:u,ctx:s}),t.$set(c)},i(s){r||(O(t.$$.fragment,s),r=!0)},o(s){U(t.$$.fragment,s),r=!1},d(s){o[9](null),Y(t,s)}}}function em(o,t,r){let i,{requestEditorFocus:s}=t,{onMentionItemsUpdated:u}=t;const c=vp("chatModel");if(!c)throw new Error("ChatModel not found in context");const h=new Gu(c,_),f=h.displayItems;let v;function _(x){return!!v&&(v.insertMention(x),h.closeDropdown(),!0)}function b(x){const E=h.selectMentionable(x);return s(),E}return si(o,f,x=>r(2,i=x)),Yu(()=>{h.dispose()}),o.$$set=x=>{"requestEditorFocus"in x&&r(6,s=x.requestEditorFocus),"onMentionItemsUpdated"in x&&r(0,u=x.onMentionItemsUpdated)},[u,v,i,f,function(x){x===void 0?h.closeDropdown():(h.openDropdown(),h.userQuery.set(x))},b,s,x=>_(x),x=>b(x),function(x){Oi[x?"unshift":"push"](()=>{v=x,r(1,v)})}]}class tm extends oi{constructor(t){super(),ai(this,t,em,K_,ui,{requestEditorFocus:6,onMentionItemsUpdated:0,insertMentionNode:7})}get insertMentionNode(){return this.$$.ctx[7]}}function Ih(o){let t,r,i,s,u,c,h,f,v,_,b,x,E,T,q={focusOnInit:!0,$$slots:{default:[nm]},$$scope:{ctx:o}};return c=new zh.Root({props:q}),o[25](c),v=new jr({props:{id:"close",size:1,variant:"soft",color:"neutral",title:"Close",$$slots:{default:[rm]},$$scope:{ctx:o}}}),v.$on("click",function(){ur(o[0].disposeDiffViewPanel)&&o[0].disposeDiffViewPanel.apply(this,arguments)}),b=new jr({props:{id:"send",size:1,variant:"solid",color:"accent",title:o[3]===Dr.instruction?"Instruct Augment":"Edit with Augment",disabled:!o[4].trim()||o[11],$$slots:{iconRight:[sm],default:[im]},$$scope:{ctx:o}}}),b.$on("click",o[14]),{c(){t=We("div"),r=Ue(),i=We("div"),s=We("div"),u=We("div"),G(c.$$.fragment),h=Ue(),f=We("div"),G(v.$$.fragment),_=Ue(),G(b.$$.fragment),De(u,"class","l-input-area__input svelte-1cxscce"),De(f,"class","c-instruction-drawer-panel__btn-container svelte-1cxscce"),De(s,"class","instruction-drawer-panel__contents svelte-1cxscce"),De(s,"tabindex","0"),De(s,"role","button"),De(i,"class","instruction-drawer-panel svelte-1cxscce"),Fi(i,"top",o[5]+"px"),Fi(i,"height",o[6]+"px")},m(L,S){re(L,t,S),re(L,r,S),re(L,i,S),He(i,s),He(s,u),Z(c,u,null),o[26](u),He(s,h),He(s,f),Z(v,f,null),He(f,_),Z(b,f,null),x=!0,E||(T=[Rh(o[15].call(null,t)),Rr(s,"click",o[17]),Rr(s,"keydown",o[27])],E=!0)},p(L,S){o=L;const F={};1296&S[0]|256&S[1]&&(F.$$scope={dirty:S,ctx:o}),c.$set(F);const ne={};256&S[1]&&(ne.$$scope={dirty:S,ctx:o}),v.$set(ne);const de={};8&S[0]&&(de.title=o[3]===Dr.instruction?"Instruct Augment":"Edit with Augment"),2064&S[0]&&(de.disabled=!o[4].trim()||o[11]),8&S[0]|256&S[1]&&(de.$$scope={dirty:S,ctx:o}),b.$set(de),(!x||32&S[0])&&Fi(i,"top",o[5]+"px"),(!x||64&S[0])&&Fi(i,"height",o[6]+"px")},i(L){x||(O(c.$$.fragment,L),O(v.$$.fragment,L),O(b.$$.fragment,L),x=!0)},o(L){U(c.$$.fragment,L),U(v.$$.fragment,L),U(b.$$.fragment,L),x=!1},d(L){L&&(ie(t),ie(r),ie(i)),o[25](null),Y(c),o[26](null),Y(v),Y(b),E=!1,Zu(T)}}}function nm(o){let t,r,i,s,u,c,h,f;t=new Qp({props:{shortcuts:{Enter:o[23]}}});let v={requestEditorFocus:o[16],onMentionItemsUpdated:o[18]};return i=new tm({props:v}),o[24](i),u=new zh.Content({props:{content:o[4],onContentChanged:o[19]}}),h=new Xp({props:{placeholder:o[10]}}),{c(){G(t.$$.fragment),r=Ue(),G(i.$$.fragment),s=Ue(),G(u.$$.fragment),c=Ue(),G(h.$$.fragment)},m(_,b){Z(t,_,b),re(_,r,b),Z(i,_,b),re(_,s,b),Z(u,_,b),re(_,c,b),Z(h,_,b),f=!0},p(_,b){i.$set({});const x={};16&b[0]&&(x.content=_[4]),u.$set(x);const E={};1024&b[0]&&(E.placeholder=_[10]),h.$set(E)},i(_){f||(O(t.$$.fragment,_),O(i.$$.fragment,_),O(u.$$.fragment,_),O(h.$$.fragment,_),f=!0)},o(_){U(t.$$.fragment,_),U(i.$$.fragment,_),U(u.$$.fragment,_),U(h.$$.fragment,_),f=!1},d(_){_&&(ie(r),ie(s),ie(c)),Y(t,_),o[24](null),Y(i,_),Y(u,_),Y(h,_)}}}function rm(o){let t,r,i;return r=new ci({props:{keybinding:"esc"}}),{c(){t=xt(`Close
          `),G(r.$$.fragment)},m(s,u){re(s,t,u),Z(r,s,u),i=!0},p:Be,i(s){i||(O(r.$$.fragment,s),i=!0)},o(s){U(r.$$.fragment,s),i=!1},d(s){s&&ie(t),Y(r,s)}}}function im(o){let t,r=o[3]===Dr.instruction?"Instruct":"Edit";return{c(){t=xt(r)},m(i,s){re(i,t,s)},p(i,s){8&s[0]&&r!==(r=i[3]===Dr.instruction?"Instruct":"Edit")&&cr(t,r)},d(i){i&&ie(t)}}}function sm(o){let t,r;return t=new Jp({props:{slot:"iconRight"}}),{c(){G(t.$$.fragment)},m(i,s){Z(t,i,s),r=!0},p:Be,i(i){r||(O(t.$$.fragment,i),r=!0)},o(i){U(t.$$.fragment,i),r=!1},d(i){Y(t,i)}}}function om(o){let t,r,i=o[2]&&Ih(o);return{c(){i&&i.c(),t=hr()},m(s,u){i&&i.m(s,u),re(s,t,u),r=!0},p(s,u){s[2]?i?(i.p(s,u),4&u[0]&&O(i,1)):(i=Ih(s),i.c(),O(i,1),i.m(t.parentNode,t)):i&&($t(),U(i,1,1,()=>{i=null}),wt())},i(s){r||(O(i),r=!0)},o(s){U(i),r=!1},d(s){s&&ie(t),i&&i.d(s)}}}function am(o,t,r){let i,s,u,c,h,f,v=Be,_=()=>(v(),v=ar(x,fe=>r(22,c=fe)),x),b=Be;o.$$.on_destroy.push(()=>v()),o.$$.on_destroy.push(()=>b());let{diffViewModel:x}=t;_();let{initialConversation:E}=t,{initialFlags:T}=t;const q=bp.getContext().monaco,L={isWholeLine:!0,marginClassName:"instruction-edit-area-margin"},S=new Hh(Es);let F=new Xh;S.registerConsumer(F);let ne=new Zh(S,Es,F,{initialConversation:E,initialFlags:T});const de=ne.currentConversationModel;let oe,Re;S.registerConsumer(ne),function(fe){yp("chatModel",fe)}(ne);let pe,Ie="";const _e=x.mode;si(o,_e,fe=>r(3,h=fe));const Fe=x.selectionLines;function Pe(){const fe=x.getModifiedEditor(),mn=pt(q);if(!fe||!mn||(pe==null||pe.clear(),!u))return;const Tn=u.start,Bn=u.end,fr={range:new mn.Range(Tn+1,1,Bn+1,1),options:L};pe||(pe=fe.createDecorationsCollection()),pe.set([fr])}function st(){return!!(Ie!=null&&Ie.trim())&&(x.handleInstructionSubmit(Ie),!0)}si(o,Fe,fe=>r(2,u=fe)),Uh(async()=>{await Mu(),Ct(),r(5,at=x.editorOffset)}),Yu(()=>{oe==null||oe.destroy(),pe==null||pe.clear()});let Se,we,at=0,_n=57;const Ct=()=>Se==null?void 0:Se.forceFocus();return o.$$set=fe=>{"diffViewModel"in fe&&_(r(0,x=fe.diffViewModel)),"initialConversation"in fe&&r(20,E=fe.initialConversation),"initialFlags"in fe&&r(21,T=fe.initialFlags)},o.$$.update=()=>{if(8&o.$$.dirty[0]&&r(10,i=(h===Dr.instruction?"Instruct":"Edit with")+" Augment... @ to focus on files or docs"),4194304&o.$$.dirty[0]&&(r(9,s=c.isLoading),b(),b=ar(s,fe=>r(11,f=fe))),6&o.$$.dirty[0]&&Re){if(u==null)r(6,_n=0);else{const fe=Re.scrollHeight;r(6,_n=Math.min(40+fe,108))}oe==null||oe.update({heightInPx:_n}),Pe()}},[x,Re,u,h,Ie,at,_n,Se,we,s,i,f,_e,Fe,st,function(fe){if(fe){const mn=u?u.start:1;oe=x.renderInstructionsDrawerViewZone(fe,{line:mn,heightInPx:_n,onDomNodeTop:Tn=>{r(5,at=x.editorOffset+Tn)},autoFocus:!0}),Pe()}},()=>Se==null?void 0:Se.requestFocus(),Ct,fe=>{de.saveDraftMentions(fe.current)},function(fe){r(4,Ie=fe.rawText)},E,T,c,()=>st(),function(fe){Oi[fe?"unshift":"push"](()=>{we=fe,r(8,we)})},function(fe){Oi[fe?"unshift":"push"](()=>{Se=fe,r(7,Se)})},function(fe){Oi[fe?"unshift":"push"](()=>{Re=fe,r(1,Re)})},fe=>{fe.key==="Enter"&&(Ct(),fe.stopPropagation(),fe.preventDefault())}]}class um extends oi{constructor(t){super(),ai(this,t,am,om,ui,{diffViewModel:0,initialConversation:20,initialFlags:21},null,[-1,-1])}}const{window:Eu}=Ip;function Eh(o,t,r){const i=o.slice();return i[17]=t[r],i[19]=r,i}function Mh(o){let t,r,i,s,u;return r=new Yg({props:{diffViewModel:o[3]}}),s=new um({props:{diffViewModel:o[3]}}),{c(){t=We("div"),G(r.$$.fragment),i=Ue(),G(s.$$.fragment),De(t,"class","sticky-top svelte-dpt00g")},m(c,h){re(c,t,h),Z(r,t,null),re(c,i,h),Z(s,c,h),u=!0},p(c,h){const f={};8&h&&(f.diffViewModel=c[3]),r.$set(f);const v={};8&h&&(v.diffViewModel=c[3]),s.$set(v)},i(c){u||(O(r.$$.fragment,c),O(s.$$.fragment,c),u=!0)},o(c){U(r.$$.fragment,c),U(s.$$.fragment,c),u=!1},d(c){c&&(ie(t),ie(i)),Y(r),Y(s,c)}}}function kh(o){let t,r,i=Yo(o[4]),s=[];for(let c=0;c<i.length;c+=1)s[c]=Th(Eh(o,i,c));const u=c=>U(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();t=hr()},m(c,h){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(c,h);re(c,t,h),r=!0},p(c,h){if(280&h){let f;for(i=Yo(c[4]),f=0;f<i.length;f+=1){const v=Eh(c,i,f);s[f]?(s[f].p(v,h),O(s[f],1)):(s[f]=Th(v),s[f].c(),O(s[f],1),s[f].m(t.parentNode,t))}for($t(),f=i.length;f<s.length;f+=1)u(f);wt()}},i(c){if(!r){for(let h=0;h<i.length;h+=1)O(s[h]);r=!0}},o(c){s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)U(s[h]);r=!1},d(c){c&&ie(t),Dh(s,c)}}}function Ah(o){var u;let t,r;function i(){return o[14](o[17])}function s(){return o[15](o[17])}return t=new jg({props:{isFocused:((u=o[3])==null?void 0:u.currFocusedChunkIdx)===o[19],onAccept:i,onReject:s,diffViewModel:o[3],leaf:o[17],align:"right",disableApply:o[8]}}),{c(){G(t.$$.fragment)},m(c,h){Z(t,c,h),r=!0},p(c,h){var v;o=c;const f={};8&h&&(f.isFocused=((v=o[3])==null?void 0:v.currFocusedChunkIdx)===o[19]),24&h&&(f.onAccept=i),24&h&&(f.onReject=s),8&h&&(f.diffViewModel=o[3]),16&h&&(f.leaf=o[17]),256&h&&(f.disableApply=o[8]),t.$set(f)},i(c){r||(O(t.$$.fragment,c),r=!0)},o(c){U(t.$$.fragment,c),r=!1},d(c){Y(t,c)}}}function Th(o){let t,r,i=o[17].unitOfCodeWork.modifiedCode!==o[17].unitOfCodeWork.originalCode&&Ah(o);return{c(){i&&i.c(),t=hr()},m(s,u){i&&i.m(s,u),re(s,t,u),r=!0},p(s,u){s[17].unitOfCodeWork.modifiedCode!==s[17].unitOfCodeWork.originalCode?i?(i.p(s,u),16&u&&O(i,1)):(i=Ah(s),i.c(),O(i,1),i.m(t.parentNode,t)):i&&($t(),U(i,1,1,()=>{i=null}),wt())},i(s){r||(O(i),r=!0)},o(s){U(i),r=!1},d(s){s&&ie(t),i&&i.d(s)}}}function cm(o){var v;let t,r,i,s,u,c,h=o[3]&&Mh(o),f=o[3]&&((v=o[4])==null?void 0:v.length)&&!o[7]&&kh(o);return{c(){t=We("div"),h&&h.c(),r=Ue(),i=We("div"),s=We("div"),u=Ue(),f&&f.c(),De(s,"class","editor svelte-dpt00g"),De(i,"class","editor-container svelte-dpt00g"),De(t,"class","diff-view-container svelte-dpt00g")},m(_,b){re(_,t,b),h&&h.m(t,null),He(t,r),He(t,i),He(i,s),o[13](s),He(i,u),f&&f.m(i,null),c=!0},p(_,b){var x;_[3]?h?(h.p(_,b),8&b&&O(h,1)):(h=Mh(_),h.c(),O(h,1),h.m(t,r)):h&&($t(),U(h,1,1,()=>{h=null}),wt()),_[3]&&((x=_[4])!=null&&x.length)&&!_[7]?f?(f.p(_,b),152&b&&O(f,1)):(f=kh(_),f.c(),O(f,1),f.m(i,null)):f&&($t(),U(f,1,1,()=>{f=null}),wt())},i(_){c||(O(h),O(f),c=!0)},o(_){U(h),U(f),c=!1},d(_){_&&ie(t),h&&h.d(),o[13](null),f&&f.d()}}}function lm(o){let t,r,i,s;return t=new $p.Root({props:{$$slots:{default:[cm]},$$scope:{ctx:o}}}),{c(){G(t.$$.fragment)},m(u,c){Z(t,u,c),r=!0,i||(s=[Rr(Eu,"message",function(){var h,f;ur((h=o[0])==null?void 0:h.handleMessageFromExtension)&&((f=o[0])==null||f.handleMessageFromExtension.apply(this,arguments))}),Rr(Eu,"focus",o[11]),Rr(Eu,"blur",o[12])],i=!0)},p(u,[c]){o=u;const h={};1048986&c&&(h.$$scope={dirty:c,ctx:o}),t.$set(h)},i(u){r||(O(t.$$.fragment,u),r=!0)},o(u){U(t.$$.fragment,u),r=!1},d(u){Y(t,u),i=!1,Zu(s)}}}function hm(o,t,r){let i,s,u,c,h,f,v,_,b,x,E=Be,T=Be,q=Be;function L(F){const ne=xp.dark;return Cp((F==null?void 0:F.category)||ne,F==null?void 0:F.intensity)??Sp.get(ne)}si(o,wp,F=>r(10,h=F)),o.$$.on_destroy.push(()=>E()),o.$$.on_destroy.push(()=>T()),o.$$.on_destroy.push(()=>q()),Uh(async()=>{r(9,x=await window.augmentDeps.monaco),x||console.error("Monaco not loaded. Diff view cannot be initialized.")}),Yu(()=>{_==null||_.dispose()});let S=!1;return o.$$.update=()=>{if(1539&o.$$.dirty&&x&&b&&!_&&(r(0,_=new Tg(b,L(h),x)),E(),E=ar(_,F=>r(3,c=F))),1&o.$$.dirty&&(r(6,i=_==null?void 0:_.disableApply),q(),q=ar(i,F=>r(8,v=F))),1&o.$$.dirty&&(r(5,s=_==null?void 0:_.disableResolution),T(),T=ar(s,F=>r(7,f=F))),1025&o.$$.dirty){const F=h;_&&(_==null||_.updateTheme(L(F)))}8&o.$$.dirty&&r(4,u=c==null?void 0:c.leaves),5&o.$$.dirty&&(_==null||_.updateIsWebviewFocused(S))},[_,b,S,c,u,s,i,f,v,x,h,()=>r(2,S=!0),()=>r(2,S=!1),function(F){Oi[F?"unshift":"push"](()=>{b=F,r(1,b)})},F=>c==null?void 0:c.acceptChunk(F),F=>c==null?void 0:c.rejectChunk(F)]}new class extends oi{constructor(o){super(),ai(this,o,hm,lm,ui,{})}}({target:document.getElementById("app")});
