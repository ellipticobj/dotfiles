import{S as Y,d as J,e as X,h as ne,j as x,k as M,l as E,n as F,m as _,a5 as Ee,y as k,z as w,Q as B,_ as Ae,E as N,A as y,ai as rt,b as m,a as A,t as p,c as H,B as C,a0 as He,a2 as Te,a4 as U,ad as V,a7 as G,aj as Ne,K as Fe,$ as pe,o as Be,D as Re,ag as ze,ak as qe,Z as lt,T as re,Y as Ue,I as ot,af as se}from"./index-Bg5k1fBH.js";import{e as O,u as at,o as ct}from"./ButtonAugment-CSwi-JVg.js";import{G as it,t as ut,a as gt,M as $t,e as mt,f as pt,S as dt,A as ft,C as ht,g as vt,U as xt,h as We,E as wt,i as yt,R as Ct,j as Mt,k as _t}from"./MessageListBottomButton-Dfm2AIK9.js";import{a as bt}from"./Content-DlSDhH-b.js";import{R as De,O as Lt,M as St,S as le,D as kt,A as Q,i as oe,a as Ze,b as Oe,c as Ge,d as Ve,e as Ke,f as Pe,g as Qe,h as Ye,j as ae,k as jt,E as Je,T as Xe,l as de}from"./circle-backslash-DcaYy8Cz.js";import"./isObjectLike-BM7wo5O1.js";import{S as It}from"./main-panel-DHLQkfbk.js";import{aI as Et,aG as At,aH as Ht}from"./AugmentMessage-DPQ5COF7.js";import{C as Tt,R as fe,a as q}from"./CollapseButtonAugment-BGvJcqaG.js";import{T as Nt}from"./TextTooltipAugment-BspEVawc.js";import{I as et}from"./IconButtonAugment-CMGBc7C3.js";import{E as Ft}from"./expand-DPRXx-qB.js";import{s as he}from"./index-CUDfp9dg.js";import"./MaterialIcon-BhPUHxOM.js";import"./keypress-DD1aQVr0.js";import"./autofix-state-d-ymFdyn.js";import"./Keybindings-B3h1jpi_.js";import"./folder-opened-Bm8IVIHF.js";import"./file-paths-BcSg4gks.js";import"./pen-to-square-DVpukHrw.js";import"./index-CqmTMtlA.js";import"./exclamation-triangle-CVGAe7xx.js";import"./augment-logo-rit98iY0.js";import"./globals-D0QH3NT1.js";import"./design-system-init-CB2neNOj.js";import"./magnifying-glass-B45gORk9.js";import"./github-DJRJsxRC.js";import"./ellipsis-D4o8IzPJ.js";import"./await_block-mV9LhbR_.js";import"./preload-helper-Dv6uf1Os.js";import"./IconFilePath-Db9jFTUr.js";import"./LanguageIcon-elXUw7jw.js";import"./next-edit-types-904A5ehg.js";import"./mcp-logo-BTaOefqG.js";import"./play-B7RwZVmm.js";import"./terminal-BosCzoBy.js";import"./toggleHighContrast-CwIv4U26.js";function Bt(r){let e,n,t;return{c(){e=ne("svg"),n=ne("g"),t=ne("path"),x(t,"id","Vector"),x(t,"fill-rule","evenodd"),x(t,"clip-rule","evenodd"),x(t,"d","M8.09854 1.54233C4.197 1.54233 1.03418 4.70515 1.03418 8.60668C1.03418 12.5081 4.197 15.671 8.09854 15.671C12.0001 15.671 15.1628 12.5081 15.1628 8.60668C15.1628 4.70515 12.0001 1.54233 8.09854 1.54233ZM2.04752 8.60668C2.04752 5.2648 4.75665 2.55566 8.09854 2.55566C11.4404 2.55566 14.1495 5.2648 14.1495 8.60668C14.1495 11.9486 11.4404 14.6577 8.09854 14.6577C4.75665 14.6577 2.04752 11.9486 2.04752 8.60668ZM10.9348 6.51374C11.1043 6.27285 11.0465 5.94016 10.8056 5.77064C10.5647 5.60113 10.232 5.65899 10.0625 5.89988L7.05305 10.1765L5.81256 8.91301C5.6062 8.70283 5.26852 8.69973 5.05834 8.9061C4.84816 9.11246 4.84506 9.45013 5.05143 9.66031L6.74032 11.3805C6.85121 11.4934 7.00655 11.5512 7.16431 11.5383C7.32207 11.5255 7.46595 11.4432 7.55704 11.3137L10.9348 6.51374Z"),x(t,"fill","currentColor"),x(e,"width","16"),x(e,"height","16"),x(e,"viewBox","0 0 16 16"),x(e,"fill","none"),x(e,"xmlns","http://www.w3.org/2000/svg")},m(s,l){M(s,e,l),E(e,n),E(n,t)},p:F,i:F,o:F,d(s){s&&_(e)}}}class Rt extends Y{constructor(e){super(),J(this,e,null,Bt,X,{})}}function zt(r){let e;return{c(){e=He(r[2])},m(n,t){M(n,e,t)},p(n,t){4&t&&Te(e,n[2])},d(n){n&&_(e)}}}function ve(r){let e,n,t;return n=new et({props:{variant:"ghost",color:"neutral",size:1,$$slots:{default:[Wt]},$$scope:{ctx:r}}}),n.$on("click",r[5]),{c(){e=k("div"),w(n.$$.fragment),x(e,"class","c-expandable-log-toggle svelte-awg7ah")},m(s,l){M(s,e,l),y(n,e,null),t=!0},p(s,l){const a={};4104&l&&(a.$$scope={dirty:l,ctx:s}),n.$set(a)},i(s){t||(m(n.$$.fragment,s),t=!0)},o(s){p(n.$$.fragment,s),t=!1},d(s){s&&_(e),C(n)}}}function qt(r){let e,n;return e=new Ft({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Ut(r){let e,n;return e=new Tt({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Wt(r){let e,n,t,s;const l=[Ut,qt],a=[];function i(c,o){return c[3]?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),M(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e!==u&&(A(),p(a[u],1,1,()=>{a[u]=null}),H(),n=a[e],n||(n=a[e]=l[e](c),n.c()),m(n,1),n.m(t.parentNode,t))},i(c){s||(m(n),s=!0)},o(c){p(n),s=!1},d(c){c&&_(t),a[e].d(c)}}}function Dt(r){let e,n,t,s,l,a,i,c;s=new Ee({props:{size:1,type:"monospace",$$slots:{default:[zt]},$$scope:{ctx:r}}});let o=r[4]&&ve(r);return{c(){e=k("div"),n=k("div"),t=k("div"),w(s.$$.fragment),i=B(),o&&o.c(),x(t,"class",l="c-expandable-log-content c-expandable-log-content--lines-"+r[1]+" svelte-awg7ah"),Ae(()=>r[11].call(t)),x(n,"class","c-expandable-log-preview svelte-awg7ah"),N(n,"c-expandable-log-preview--expanded",r[3]),N(n,"c-expandable-log-preview--single-line",!r[4]),x(e,"class","c-expandable-log svelte-awg7ah")},m(u,$){M(u,e,$),E(e,n),E(n,t),y(s,t,null),a=rt(t,r[11].bind(t)),E(n,i),o&&o.m(n,null),c=!0},p(u,[$]){const g={};4100&$&&(g.$$scope={dirty:$,ctx:u}),s.$set(g),(!c||2&$&&l!==(l="c-expandable-log-content c-expandable-log-content--lines-"+u[1]+" svelte-awg7ah"))&&x(t,"class",l),u[4]?o?(o.p(u,$),16&$&&m(o,1)):(o=ve(u),o.c(),m(o,1),o.m(n,null)):o&&(A(),p(o,1,1,()=>{o=null}),H()),(!c||8&$)&&N(n,"c-expandable-log-preview--expanded",u[3]),(!c||16&$)&&N(n,"c-expandable-log-preview--single-line",!u[4])},i(u){c||(m(s.$$.fragment,u),m(o),c=!0)},o(u){p(s.$$.fragment,u),p(o),c=!1},d(u){u&&_(e),C(s),a(),o&&o.d()}}}function Zt(r,e,n){let t,s,l,a,i,c,o,u,{logs:$}=e,g=!1;return r.$$set=d=>{"logs"in d&&n(6,$=d.logs)},r.$$.update=()=>{64&r.$$.dirty&&n(2,t=$.replace(/\r/g,`
`)),1&r.$$.dirty&&n(10,s=u/6),1028&r.$$.dirty&&n(9,l=t.trim().split(`
`).map(d=>Math.max(1,Math.ceil(d.length/s)))),512&r.$$.dirty&&n(7,a=l.reduce((d,f)=>d+f,0)),512&r.$$.dirty&&n(8,i=l[l.length-1]),256&r.$$.dirty&&n(1,c=i>1?2:1),130&r.$$.dirty&&n(4,o=a>c)},[u,c,t,g,o,function(){n(3,g=!g)},$,a,i,l,s,function(){u=this.clientWidth,n(0,u)}]}class Ot extends Y{constructor(e){super(),J(this,e,Zt,Dt,X,{logs:6})}}function xe(r,e,n){const t=r.slice();return t[12]=e[n],t}function we(r){let e,n,t,s=O(r[2].steps),l=[];for(let i=0;i<s.length;i+=1)l[i]=Ce(xe(r,s,i));const a=i=>p(l[i],1,1,()=>{l[i]=null});return{c(){e=k("div"),n=k("div");for(let i=0;i<l.length;i+=1)l[i].c();x(n,"class","c-agent-setup-logs svelte-3gxca2"),x(e,"class","c-agent-setup-logs-container svelte-3gxca2"),N(e,"c-agent-setup-logs-container--loading",!r[1])},m(i,c){M(i,e,c),E(e,n);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,null);r[10](e),t=!0},p(i,c){if(52&c){let o;for(s=O(i[2].steps),o=0;o<s.length;o+=1){const u=xe(i,s,o);l[o]?(l[o].p(u,c),m(l[o],1)):(l[o]=Ce(u),l[o].c(),m(l[o],1),l[o].m(n,null))}for(A(),o=s.length;o<l.length;o+=1)a(o);H()}(!t||2&c)&&N(e,"c-agent-setup-logs-container--loading",!i[1])},i(i){if(!t){for(let c=0;c<s.length;c+=1)m(l[c]);t=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)p(l[c]);t=!1},d(i){i&&_(e),Ne(l,i),r[10](null)}}}function Gt(r){let e,n;return{c(){e=k("div"),x(e,"class",n="c-agent-setup-log-status-dot c-agent-setup-log-status-dot--"+r[12].status+" svelte-3gxca2")},m(t,s){M(t,e,s)},p(t,s){4&s&&n!==(n="c-agent-setup-log-status-dot c-agent-setup-log-status-dot--"+t[12].status+" svelte-3gxca2")&&x(e,"class",n)},i:F,o:F,d(t){t&&_(e)}}}function Vt(r){let e,n,t;n=new Et({});let s=[qe("error"),{style:"color: var(--ds-color-a11);"}],l={};for(let a=0;a<s.length;a+=1)l=Be(l,s[a]);return{c(){e=k("div"),w(n.$$.fragment),Re(e,l),N(e,"svelte-3gxca2",!0)},m(a,i){M(a,e,i),y(n,e,null),t=!0},p(a,i){N(e,"svelte-3gxca2",!0)},i(a){t||(m(n.$$.fragment,a),t=!0)},o(a){p(n.$$.fragment,a),t=!1},d(a){a&&_(e),C(n)}}}function Kt(r){let e,n,t;n=new Rt({});let s=[qe("success"),{style:"color: var(--ds-color-a11);"}],l={};for(let a=0;a<s.length;a+=1)l=Be(l,s[a]);return{c(){e=k("div"),w(n.$$.fragment),Re(e,l),N(e,"svelte-3gxca2",!0)},m(a,i){M(a,e,i),y(n,e,null),t=!0},p(a,i){N(e,"svelte-3gxca2",!0)},i(a){t||(m(n.$$.fragment,a),t=!0)},o(a){p(n.$$.fragment,a),t=!1},d(a){a&&_(e),C(n)}}}function Pt(r){let e,n;return e=new ze({props:{size:1}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Qt(r){let e,n,t,s;const l=[Pt,Kt,Vt,Gt],a=[];function i(c,o){return c[12].status===q.running?0:c[12].status===q.success?1:c[12].status===q.failure?2:3}return n=i(r),t=a[n]=l[n](r),{c(){e=k("div"),t.c(),x(e,"class","c-agent-setup-log-status-icon svelte-3gxca2")},m(c,o){M(c,e,o),a[n].m(e,null),s=!0},p(c,o){let u=n;n=i(c),n===u?a[n].p(c,o):(A(),p(a[u],1,1,()=>{a[u]=null}),H(),t=a[n],t?t.p(c,o):(t=a[n]=l[n](c),t.c()),m(t,1),t.m(e,null))},i(c){s||(m(t),s=!0)},o(c){p(t),s=!1},d(c){c&&_(e),a[n].d()}}}function Yt(r){let e,n=r[12].step_description+"";return{c(){e=He(n)},m(t,s){M(t,e,s)},p(t,s){4&s&&n!==(n=t[12].step_description+"")&&Te(e,n)},d(t){t&&_(e)}}}function Jt(r){let e,n;return e=new Lt({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function ye(r){let e,n,t,s;return n=new Ot({props:{logs:r[12].logs}}),{c(){e=k("div"),w(n.$$.fragment),x(e,"class","c-agent-setup-log-content svelte-3gxca2")},m(l,a){M(l,e,a),y(n,e,null),s=!0},p(l,a){const i={};4&a&&(i.logs=l[12].logs),n.$set(i)},i(l){s||(m(n.$$.fragment,l),l&&Ae(()=>{s&&(t||(t=pe(e,he,{},!0)),t.run(1))}),s=!0)},o(l){p(n.$$.fragment,l),l&&(t||(t=pe(e,he,{},!1)),t.run(0)),s=!1},d(l){l&&_(e),C(n),l&&t&&t.end()}}}function Ce(r){let e,n,t,s,l,a,i,c,o,u,$,g,d;s=new Nt({props:{content:r[4](r[12].status),triggerOn:[bt.Hover],$$slots:{default:[Qt]},$$scope:{ctx:r}}}),i=new Ee({props:{size:1,weight:"medium",$$slots:{default:[Yt]},$$scope:{ctx:r}}}),u=new et({props:{variant:"ghost",color:"neutral",size:1,title:"Open logs in new file",$$slots:{default:[Jt]},$$scope:{ctx:r}}}),u.$on("click",function(){return r[9](r[12])});let f=r[12].logs&&r[12].status!==q.success&&ye(r);return{c(){e=k("div"),n=k("div"),t=k("div"),w(s.$$.fragment),l=B(),a=k("div"),w(i.$$.fragment),c=B(),o=k("div"),w(u.$$.fragment),$=B(),f&&f.c(),g=B(),x(t,"class","c-agent-setup-log-status svelte-3gxca2"),x(a,"class","c-agent-setup-log-step-description svelte-3gxca2"),x(o,"class","c-expandable-log-open svelte-3gxca2"),x(n,"class","c-agent-setup-log-header svelte-3gxca2"),x(e,"class","c-agent-setup-log-step svelte-3gxca2")},m(h,j){M(h,e,j),E(e,n),E(n,t),y(s,t,null),E(n,l),E(n,a),y(i,a,null),E(n,c),E(n,o),y(u,o,null),E(e,$),f&&f.m(e,null),E(e,g),d=!0},p(h,j){r=h;const R={};4&j&&(R.content=r[4](r[12].status)),32772&j&&(R.$$scope={dirty:j,ctx:r}),s.$set(R);const T={};32772&j&&(T.$$scope={dirty:j,ctx:r}),i.$set(T);const z={};32768&j&&(z.$$scope={dirty:j,ctx:r}),u.$set(z),r[12].logs&&r[12].status!==q.success?f?(f.p(r,j),4&j&&m(f,1)):(f=ye(r),f.c(),m(f,1),f.m(e,g)):f&&(A(),p(f,1,1,()=>{f=null}),H())},i(h){d||(m(s.$$.fragment,h),m(i.$$.fragment,h),m(u.$$.fragment,h),m(f),d=!0)},o(h){p(s.$$.fragment,h),p(i.$$.fragment,h),p(u.$$.fragment,h),p(f),d=!1},d(h){h&&_(e),C(s),C(i),C(u),f&&f.d()}}}function Xt(r){let e,n,t=r[2]&&r[2].steps&&r[2].steps.length>0&&we(r);return{c(){t&&t.c(),e=U()},m(s,l){t&&t.m(s,l),M(s,e,l),n=!0},p(s,[l]){s[2]&&s[2].steps&&s[2].steps.length>0?t?(t.p(s,l),4&l&&m(t,1)):(t=we(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(A(),p(t,1,1,()=>{t=null}),H())},i(s){n||(m(t),n=!0)},o(s){p(t),n=!1},d(s){s&&_(e),t&&t.d(s)}}}function en(r,e,n){let t,s,l,a,i;const c=V(De.key);G(r,c,g=>n(8,a=g));const o=V("chatModel");let u=!1;function $(g){g&&o&&o.extensionClient.openScratchFile(g,"plaintext")}return r.$$.update=()=>{var g;if(256&r.$$.dirty&&n(7,t=(g=a==null?void 0:a.currentAgent)==null?void 0:g.status),128&r.$$.dirty&&n(1,s=t!==fe.agentStarting),256&r.$$.dirty&&n(2,l=a==null?void 0:a.agentSetupLogs),129&r.$$.dirty&&i&&t===fe.agentStarting&&setTimeout(()=>{i.scrollIntoView({behavior:"smooth",block:"start"})},500),67&r.$$.dirty)if(s&&!u&&i){n(6,u=!0);const d=i.closest(".c-msg-list");d&&setTimeout(()=>{d.scrollTo({top:d.scrollHeight,behavior:"smooth"})},300)}else!s&&u&&n(6,u=!1)},[i,s,l,c,function(g){switch(g){case q.running:return"Running";case q.success:return"Success";case q.failure:return"Failed";default:return"Unknown"}},$,u,t,a,g=>$(g.logs),function(g){Fe[g?"unshift":"push"](()=>{i=g,n(0,i)})}]}class tn extends Y{constructor(e){super(),J(this,e,en,Xt,X,{})}}function Me(r,e,n){const t=r.slice();t[36]=e[n],t[39]=n;const s=t[39]+1===t[11].length;return t[37]=s,t}function _e(r,e,n){const t=r.slice();t[42]=e[n].turn,t[43]=e[n].idx;const s=t[43]+1===t[5].length;return t[44]=s,t}function be(r){let e,n;return e=new tn({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function nn(r){let e,n,t,s;const l=[$n,gn],a=[];function i(c,o){return c[16].enableRichCheckpointInfo?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),M(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e===u?a[e].p(c,o):(A(),p(a[u],1,1,()=>{a[u]=null}),H(),n=a[e],n?n.p(c,o):(n=a[e]=l[e](c),n.c()),m(n,1),n.m(t.parentNode,t))},i(c){s||(m(n),s=!0)},o(c){p(n),s=!1},d(c){c&&_(t),a[e].d(c)}}}function sn(r){let e,n;return e=new ht({props:{chatModel:r[1],turn:r[42],turnIndex:r[43],isLastTurn:r[44],messageListContainer:r[0]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.turn=t[42]),2048&s[0]&&(l.turnIndex=t[43]),2080&s[0]&&(l.isLastTurn=t[44]),1&s[0]&&(l.messageListContainer=t[0]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function rn(r){let e,n;return e=new vt({props:{stage:r[42].stage,iterationId:r[42].iterationId,stageCount:r[42].stageCount}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.stage=t[42].stage),2048&s[0]&&(l.iterationId=t[42].iterationId),2048&s[0]&&(l.stageCount=t[42].stageCount),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function ln(r){let e,n;return e=new xt({props:{chatModel:r[1],msg:r[42].response_text??""}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.msg=t[42].response_text??""),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function on(r){let e,n;return e=new At({props:{markdown:r[42].response_text??"",messageListContainer:r[0]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.markdown=t[42].response_text??""),1&s[0]&&(l.messageListContainer=t[0]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function an(r){let e,n;function t(){return r[29](r[42])}return e=new We({props:{turn:r[42],preamble:It,resendTurn:t,$$slots:{default:[mn]},$$scope:{ctx:r}}}),{c(){w(e.$$.fragment)},m(s,l){y(e,s,l),n=!0},p(s,l){r=s;const a={};2048&l[0]&&(a.turn=r[42]),2052&l[0]&&(a.resendTurn=t),2176&l[0]|65536&l[1]&&(a.$$scope={dirty:l,ctx:r}),e.$set(a)},i(s){n||(m(e.$$.fragment,s),n=!0)},o(s){p(e.$$.fragment,s),n=!1},d(s){C(e,s)}}}function cn(r){let e,n;return e=new wt({props:{flagsModel:r[12],turn:r[42]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};4096&s[0]&&(l.flagsModel=t[12]),2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function un(r){let e,n;return e=new We({props:{turn:r[42]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function gn(r){let e,n;return e=new Mt({props:{turn:r[42]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function $n(r){let e,n;return e=new _t({props:{turn:r[42]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function mn(r){let e,n;return e=new Ht({props:{conversationModel:r[7],turn:r[42]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};128&s[0]&&(l.conversationModel=t[7]),2048&s[0]&&(l.turn=t[42]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Le(r){let e,n,t,s;function l(){return r[30](r[42])}return{c(){e=k("div"),x(e,"class","c-msg-list__turn-seen")},m(a,i){M(a,e,i),t||(s=re(n=pt.call(null,e,{onSeen:l,track:r[42].seen_state!==le.seen})),t=!0)},p(a,i){r=a,n&&Ue(n.update)&&2048&i[0]&&n.update.call(null,{onSeen:l,track:r[42].seen_state!==le.seen})},d(a){a&&_(e),t=!1,s()}}}function Se(r,e){let n,t,s,l,a,i,c,o,u,$,g,d,f,h,j=de(e[42]);const R=[un,cn,an,on,ln,rn,sn,nn],T=[];function z(b,L){return 2048&L[0]&&(t=null),2048&L[0]&&(s=null),2048&L[0]&&(l=null),2048&L[0]&&(a=null),2048&L[0]&&(i=null),2048&L[0]&&(c=null),2048&L[0]&&(o=null),2048&L[0]&&(u=null),t==null&&(t=!!Ze(b[42])),t?0:(s==null&&(s=!!Ge(b[42])),s?1:(l==null&&(l=!!Ve(b[42])),l?2:(a==null&&(a=!!Ke(b[42])),a?3:(i==null&&(i=!!Pe(b[42])),i?4:(c==null&&(c=!!Qe(b[42])),c?5:(o==null&&(o=!!(oe(b[42])||Oe(b[42])||Ye(b[42]))),o?6:(u==null&&(u=!(!ae(b[42])||b[42].status!==Je.success)),u?7:-1)))))))}~($=z(e,[-1,-1]))&&(g=T[$]=R[$](e));let I=j&&Le(e);return{key:r,first:null,c(){n=U(),g&&g.c(),d=B(),I&&I.c(),f=U(),this.first=n},m(b,L){M(b,n,L),~$&&T[$].m(b,L),M(b,d,L),I&&I.m(b,L),M(b,f,L),h=!0},p(b,L){let W=$;$=z(e=b,L),$===W?~$&&T[$].p(e,L):(g&&(A(),p(T[W],1,1,()=>{T[W]=null}),H()),~$?(g=T[$],g?g.p(e,L):(g=T[$]=R[$](e),g.c()),m(g,1),g.m(d.parentNode,d)):g=null),2048&L[0]&&(j=de(e[42])),j?I?I.p(e,L):(I=Le(e),I.c(),I.m(f.parentNode,f)):I&&(I.d(1),I=null)},i(b){h||(m(g),h=!0)},o(b){p(g),h=!1},d(b){b&&(_(n),_(d),_(f)),~$&&T[$].d(b),I&&I.d(b)}}}function ke(r){let e,n,t,s;const l=[fn,dn,pn],a=[];function i(o,u){return o[13]===Q.running?0:o[13]===Q.awaitingUserAction?1:o[8]?2:-1}function c(o,u){return u===0?function($){var f;const g=$.slice(),d=(f=g[7])==null?void 0:f.lastExchange;return g[40]=d,g}(o):o}return~(e=i(r))&&(n=a[e]=l[e](c(r,e))),{c(){n&&n.c(),t=U()},m(o,u){~e&&a[e].m(o,u),M(o,t,u),s=!0},p(o,u){let $=e;e=i(o),e===$?~e&&a[e].p(c(o,e),u):(n&&(A(),p(a[$],1,1,()=>{a[$]=null}),H()),~e?(n=a[e],n?n.p(c(o,e),u):(n=a[e]=l[e](c(o,e)),n.c()),m(n,1),n.m(t.parentNode,t)):n=null)},i(o){s||(m(n),s=!0)},o(o){p(n),s=!1},d(o){o&&_(t),~e&&a[e].d(o)}}}function pn(r){let e,n;return e=new dt({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function dn(r){let e,n,t,s;return e=new ft({}),{c(){w(e.$$.fragment),n=B(),t=k("div"),x(t,"class","c-agent-running-spacer svelte-1trj6wj")},m(l,a){y(e,l,a),M(l,n,a),M(l,t,a),s=!0},p:F,i(l){s||(m(e.$$.fragment,l),s=!0)},o(l){p(e.$$.fragment,l),s=!1},d(l){l&&(_(n),_(t)),C(e,l)}}}function fn(r){let e,n,t,s;const l=[xn,vn,hn],a=[];function i(o,u){var $,g;return($=o[40])!=null&&$.isRetriable&&((g=o[40])!=null&&g.display_error_message)?0:o[17]?1:2}function c(o,u){return u===1?function($){const g=$.slice(),d=g[7].getLastToolUseState();return g[41]=d,g}(o):o}return e=i(r),n=a[e]=l[e](c(r,e)),{c(){n.c(),t=U()},m(o,u){a[e].m(o,u),M(o,t,u),s=!0},p(o,u){let $=e;e=i(o),e===$?a[e].p(c(o,e),u):(A(),p(a[$],1,1,()=>{a[$]=null}),H(),n=a[e],n?n.p(c(o,e),u):(n=a[e]=l[e](c(o,e)),n.c()),m(n,1),n.m(t.parentNode,t))},i(o){s||(m(n),s=!0)},o(o){p(n),s=!1},d(o){o&&_(t),a[e].d(o)}}}function hn(r){let e,n;return e=new yt({}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p:F,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function vn(r){let e,n,t,s;const l=[yn,wn],a=[];function i(c,o){return c[41].phase!==Xe.running?0:1}return e=i(r),n=a[e]=l[e](r),{c(){n.c(),t=U()},m(c,o){a[e].m(c,o),M(c,t,o),s=!0},p(c,o){let u=e;e=i(c),e!==u&&(A(),p(a[u],1,1,()=>{a[u]=null}),H(),n=a[e],n||(n=a[e]=l[e](c),n.c()),m(n,1),n.m(t.parentNode,t))},i(c){s||(m(n),s=!0)},o(c){p(n),s=!1},d(c){c&&_(t),a[e].d(c)}}}function xn(r){let e,n;return e=new Ct({props:{message:r[40].display_error_message}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};128&s[0]&&(l.message=t[40].display_error_message),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function wn(r){let e;return{c(){e=k("div"),x(e,"class","c-agent-running-spacer svelte-1trj6wj")},m(n,t){M(n,e,t)},i:F,o:F,d(n){n&&_(e)}}}function yn(r){let e,n,t;return n=new ze({props:{size:1}}),{c(){e=k("div"),w(n.$$.fragment),x(e,"class","c-agent-running-spinner svelte-1trj6wj")},m(s,l){M(s,e,l),y(n,e,null),t=!0},i(s){t||(m(n.$$.fragment,s),t=!0)},o(s){p(n.$$.fragment,s),t=!1},d(s){s&&_(e),C(n)}}}function Cn(r){let e,n,t,s=[],l=new Map,a=O(r[36]);const i=o=>o[42].request_id??`no-request-id-${o[43]}`;for(let o=0;o<a.length;o+=1){let u=_e(r,a,o),$=i(u);l.set($,s[o]=Se($,u))}let c=r[37]&&ke(r);return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=B(),c&&c.c(),n=B()},m(o,u){for(let $=0;$<s.length;$+=1)s[$]&&s[$].m(o,u);M(o,e,u),c&&c.m(o,u),M(o,n,u),t=!0},p(o,u){33626279&u[0]&&(a=O(o[36]),A(),s=at(s,u,i,1,o,a,l,e.parentNode,ct,Se,e,_e),H()),o[37]?c?(c.p(o,u),2048&u[0]&&m(c,1)):(c=ke(o),c.c(),m(c,1),c.m(n.parentNode,n)):c&&(A(),p(c,1,1,()=>{c=null}),H())},i(o){if(!t){for(let u=0;u<a.length;u+=1)m(s[u]);m(c),t=!0}},o(o){for(let u=0;u<s.length;u+=1)p(s[u]);p(c),t=!1},d(o){o&&(_(e),_(n));for(let u=0;u<s.length;u+=1)s[u].d(o);c&&c.d(o)}}}function je(r){let e,n;return e=new mt({props:{class:"c-msg-list__item--grouped",chatModel:r[1],isLastItem:r[37],userControlsScroll:r[3],requestId:r[36][0].turn.request_id,releaseScroll:r[31],messageListContainer:r[0],minHeight:r[37]?r[10]:0,$$slots:{default:[Cn]},$$scope:{ctx:r}}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};2&s[0]&&(l.chatModel=t[1]),2048&s[0]&&(l.isLastItem=t[37]),8&s[0]&&(l.userControlsScroll=t[3]),2048&s[0]&&(l.requestId=t[36][0].turn.request_id),8&s[0]&&(l.releaseScroll=t[31]),1&s[0]&&(l.messageListContainer=t[0]),3072&s[0]&&(l.minHeight=t[37]?t[10]:0),211367&s[0]|65536&s[1]&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Mn(r){var $;let e,n,t,s,l,a,i=(($=r[6])==null?void 0:$.isActive)&&be(),c=O(r[11]),o=[];for(let g=0;g<c.length;g+=1)o[g]=je(Me(r,c,g));const u=g=>p(o[g],1,1,()=>{o[g]=null});return{c(){e=k("div"),i&&i.c(),n=B();for(let g=0;g<o.length;g+=1)o[g].c();x(e,"class","c-msg-list svelte-1trj6wj"),N(e,"c-msg-list--minimal",!r[16].fullFeatured)},m(g,d){M(g,e,d),i&&i.m(e,null),E(e,n);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(e,null);r[32](e),s=!0,l||(a=[re(ut.call(null,e,{onScrollIntoBottom:r[22],onScrollAwayFromBottom:r[23],onScroll:r[33]})),re(t=gt.call(null,e,{onHeightChange:r[34]}))],l=!0)},p(g,d){var f;if((f=g[6])!=null&&f.isActive?i?64&d[0]&&m(i,1):(i=be(),i.c(),m(i,1),i.m(e,n)):i&&(A(),p(i,1,1,()=>{i=null}),H()),33766831&d[0]){let h;for(c=O(g[11]),h=0;h<c.length;h+=1){const j=Me(g,c,h);o[h]?(o[h].p(j,d),m(o[h],1)):(o[h]=je(j),o[h].c(),m(o[h],1),o[h].m(e,null))}for(A(),h=c.length;h<o.length;h+=1)u(h);H()}t&&Ue(t.update)&&16&d[0]&&t.update.call(null,{onHeightChange:g[34]}),(!s||65536&d[0])&&N(e,"c-msg-list--minimal",!g[16].fullFeatured)},i(g){if(!s){m(i);for(let d=0;d<c.length;d+=1)m(o[d]);s=!0}},o(g){p(i),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)p(o[d]);s=!1},d(g){g&&_(e),i&&i.d(),Ne(o,g),r[32](null),l=!1,ot(a)}}}function Ie(r){let e,n;return e=new $t({props:{messageListElement:r[0],showScrollDown:r[9]}}),{c(){w(e.$$.fragment)},m(t,s){y(e,t,s),n=!0},p(t,s){const l={};1&s[0]&&(l.messageListElement=t[0]),512&s[0]&&(l.showScrollDown=t[9]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function _n(r){let e,n,t,s;n=new it({props:{$$slots:{default:[Mn]},$$scope:{ctx:r}}});let l=!r[15].doHideFloatingButtons&&Ie(r);return{c(){e=k("div"),w(n.$$.fragment),t=B(),l&&l.c(),x(e,"class","c-msg-list-container svelte-1trj6wj"),x(e,"data-testid","chat-message-list"),N(e,"c-msg-list--minimal",!r[16].fullFeatured)},m(a,i){M(a,e,i),y(n,e,null),E(e,t),l&&l.m(e,null),s=!0},p(a,i){const c={};212479&i[0]|65536&i[1]&&(c.$$scope={dirty:i,ctx:a}),n.$set(c),a[15].doHideFloatingButtons?l&&(A(),p(l,1,1,()=>{l=null}),H()):l?(l.p(a,i),32768&i[0]&&m(l,1)):(l=Ie(a),l.c(),m(l,1),l.m(e,null)),(!s||65536&i[0])&&N(e,"c-msg-list--minimal",!a[16].fullFeatured)},i(a){s||(m(n.$$.fragment,a),m(l),s=!0)},o(a){p(n.$$.fragment,a),p(l),s=!1},d(a){a&&_(e),C(n),l&&l.d()}}}function bn(r,e,n){let t,s,l,a,i,c,o,u,$,g,d,f,h,j,R,T=F,z=F,I=()=>(z(),z=se(L,v=>n(26,d=v)),L),b=F;r.$$.on_destroy.push(()=>T()),r.$$.on_destroy.push(()=>z()),r.$$.on_destroy.push(()=>b());let{chatModel:L}=e;I();let{onboardingWorkspaceModel:W}=e,{msgListElement:K}=e;const tt=V("agentConversationModel"),{agentExchangeStatus:ce,isCurrConversationAgentic:ie}=tt;G(r,ce,v=>n(27,f=v)),G(r,ie,v=>n(17,R=v));const ue=V(De.key);G(r,ue,v=>n(6,$=v));const ge=V(St);G(r,ge,v=>n(28,h=v));let Z=!1;function ee(){n(3,Z=!0)}lt(()=>{var v;((v=g.lastExchange)==null?void 0:v.seen_state)===le.unseen&&ee()});let te=0;const $e=v=>g.markSeen(v);let me=!1;return r.$$set=v=>{"chatModel"in v&&I(n(1,L=v.chatModel)),"onboardingWorkspaceModel"in v&&n(2,W=v.onboardingWorkspaceModel),"msgListElement"in v&&n(0,K=v.msgListElement)},r.$$.update=()=>{var v;if(268435456&r.$$.dirty[0]&&n(15,t=h??kt),67108864&r.$$.dirty[0]&&(n(14,s=d.currentConversationModel),T(),T=se(s,S=>n(7,g=S))),134217792&r.$$.dirty[0]&&n(13,l=$!=null&&$.isActive?$.isCurrentAgentRunning?Q.running:Q.notRunning:f),67108864&r.$$.dirty[0]&&(n(12,a=d.flags),b(),b=se(a,S=>n(16,j=S))),192&r.$$.dirty[0]&&n(5,i=$!=null&&$.isActive?$.getCurrentChatHistory():g.chatHistory.filter(S=>oe(S)||Ze(S)||Oe(S)||Ge(S)||Ve(S)||Ke(S)||Pe(S)||Qe(S)||Ye(S)||ae(S))),32&r.$$.dirty[0]&&n(11,c=i.reduce((S,D,P)=>(oe(D)&&jt(D)&&S.length>0||ae(D)&&S.length>0?S[S.length-1].push({turn:D,idx:P}):S.push([{turn:D,idx:P}]),S),[])),16&r.$$.dirty[0]&&n(10,o=te),8&r.$$.dirty[0]&&n(9,u=Z),192&r.$$.dirty[0]){const S=(v=g==null?void 0:g.lastExchange)==null?void 0:v.status,D=S===Je.cancelled,P=g==null?void 0:g.getLastToolUseState().phase,nt=P===Xe.cancelled,st=$==null?void 0:$.isActive;n(8,me=!st&&(D||nt))}},[K,L,W,Z,te,i,$,g,me,u,o,c,a,l,s,t,j,R,ce,ie,ue,ge,function(){n(3,Z=!1)},function(){n(3,Z=!0)},ee,$e,d,f,h,v=>W.retryProjectSummary(v),v=>$e(v),()=>n(3,Z=!0),function(v){Fe[v?"unshift":"push"](()=>{K=v,n(0,K)})},v=>{v<=1&&ee()},v=>n(4,te=v)]}class is extends Y{constructor(e){super(),J(this,e,bn,_n,X,{chatModel:1,onboardingWorkspaceModel:2,msgListElement:0},null,[-1,-1])}}export{is as default};
