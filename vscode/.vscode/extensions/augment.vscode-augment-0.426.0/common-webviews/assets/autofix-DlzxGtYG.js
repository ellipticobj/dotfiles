var ot=Object.defineProperty;var rt=(i,t,e)=>t in i?ot(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var _=(i,t,e)=>rt(i,typeof t!="symbol"?t+"":t,e);import{S as P,d as T,e as z,y as b,z as S,Q as C,j as D,_ as lt,k as v,l as y,A as F,ay as H,G as E,b as $,t as m,m as A,B as q,aj as nt,I as ct,a0 as k,F as K,a2 as st,az as ut,n as B,a as L,c as M,ag as dt,ao as it,ah as ft,a7 as $t,ae as pt,K as Q,ap as U,a4 as gt,aq as W}from"./index-Bg5k1fBH.js";import{A as mt}from"./autofix-state-d-ymFdyn.js";import{a as N,e as j,h as ht,W as R}from"./ButtonAugment-CSwi-JVg.js";import{s as xt,n as yt}from"./IconFilePath-Db9jFTUr.js";import{C as bt,f as It}from"./file-reader-ksW0xTCn.js";import{A as vt}from"./IconButtonAugment-CMGBc7C3.js";import"./LanguageIcon-elXUw7jw.js";import"./next-edit-types-904A5ehg.js";import"./VSCodeCodicon-CcDUR7n0.js";import"./keypress-DD1aQVr0.js";import"./toggleHighContrast-CwIv4U26.js";import"./preload-helper-Dv6uf1Os.js";import"./resize-observer-DdAtcrRr.js";import"./isObjectLike-BM7wo5O1.js";var I=(i=>(i.testLog="testLog",i.solution="solution",i))(I||{});function Y(i,t,e){const a=i.slice();return a[12]=t[e],a}function At(i){let t;return{c(){t=k("Test log")},m(e,a){v(e,t,a)},d(e){e&&A(t)}}}function wt(i){let t;return{c(){t=k("Solution")},m(e,a){v(e,t,a)},d(e){e&&A(t)}}}function J(i){let t,e,a,o,s,n=i[2].indexOf(i[12])+1+"";return{c(){t=b("option"),e=k("Test Attempt "),a=k(n),o=C(),t.__value=s=i[12].id,K(t,t.__value)},m(l,r){v(l,t,r),y(t,e),y(t,a),y(t,o)},p(l,r){4&r&&n!==(n=l[2].indexOf(l[12])+1+"")&&st(a,n),4&r&&s!==(s=l[12].id)&&(t.__value=s,K(t,t.__value))},d(l){l&&A(t)}}}function Dt(i){let t,e,a,o,s,n,l,r,c,d,g;a=new N({props:{variant:i[1]===I.testLog?"classic":"solid",$$slots:{default:[At]},$$scope:{ctx:i}}}),a.$on("click",i[8]),s=new N({props:{variant:i[1]===I.solution?"classic":"solid",disabled:!i[3],$$slots:{default:[wt]},$$scope:{ctx:i}}}),s.$on("click",i[9]);let w=j(i[2]),p=[];for(let f=0;f<w.length;f+=1)p[f]=J(Y(i,w,f));return{c(){t=b("div"),e=b("div"),S(a.$$.fragment),o=C(),S(s.$$.fragment),n=C(),l=b("div"),r=b("select");for(let f=0;f<p.length;f+=1)p[f].c();D(e,"class","tab-buttons svelte-u0jqym"),D(r,"class","iteration-selector svelte-u0jqym"),i[0]===void 0&&lt(()=>i[10].call(r)),D(l,"class","iteration-selector-container svelte-u0jqym"),D(t,"class","autofix-details-header svelte-u0jqym")},m(f,u){v(f,t,u),y(t,e),F(a,e,null),y(e,o),F(s,e,null),y(t,n),y(t,l),y(l,r);for(let h=0;h<p.length;h+=1)p[h]&&p[h].m(r,null);H(r,i[0],!0),c=!0,d||(g=[E(r,"change",i[10]),E(r,"change",i[11])],d=!0)},p(f,[u]){const h={};2&u&&(h.variant=f[1]===I.testLog?"classic":"solid"),32768&u&&(h.$$scope={dirty:u,ctx:f}),a.$set(h);const O={};if(2&u&&(O.variant=f[1]===I.solution?"classic":"solid"),8&u&&(O.disabled=!f[3]),32768&u&&(O.$$scope={dirty:u,ctx:f}),s.$set(O),4&u){let x;for(w=j(f[2]),x=0;x<w.length;x+=1){const G=Y(f,w,x);p[x]?p[x].p(G,u):(p[x]=J(G),p[x].c(),p[x].m(r,null))}for(;x<p.length;x+=1)p[x].d(1);p.length=w.length}5&u&&H(r,f[0])},i(f){c||($(a.$$.fragment,f),$(s.$$.fragment,f),c=!0)},o(f){m(a.$$.fragment,f),m(s.$$.fragment,f),c=!1},d(f){f&&A(t),q(a),q(s),nt(p,f),d=!1,ct(g)}}}function _t(i,t,e){let a,o,s,{autofixData:n}=t,{currentTab:l=I.testLog}=t,{currentIterationId:r}=t;function c(g){e(1,l=g)}function d(g){e(1,l=I.testLog),e(0,r=g)}return i.$$set=g=>{"autofixData"in g&&e(6,n=g.autofixData),"currentTab"in g&&e(1,l=g.currentTab),"currentIterationId"in g&&e(0,r=g.currentIterationId)},i.$$.update=()=>{64&i.$$.dirty&&e(2,a=n.autofixIterations||[]),5&i.$$.dirty&&a.length>0&&!r&&e(0,r=a[a.length-1].id),5&i.$$.dirty&&e(7,o=a.find(g=>g.id===r)),128&i.$$.dirty&&e(3,s=(o==null?void 0:o.suggestedSolutions)!==void 0)},[r,l,a,s,c,d,n,o,()=>c(I.testLog),()=>c(I.solution),function(){r=ut(this),e(0,r),e(2,a),e(6,n),e(2,a),e(6,n)},()=>d(r)]}class St extends P{constructor(t){super(),T(this,t,_t,Dt,z,{autofixData:6,currentTab:1,currentIterationId:0})}}function Ft(i){var o;let t,e,a=((o=i[0])==null?void 0:o.commandOutput)+"";return{c(){t=b("div"),e=k(a),D(t,"class","c-autofix-details-log svelte-18pm6ob")},m(s,n){v(s,t,n),y(t,e)},p(s,[n]){var l;1&n&&a!==(a=((l=s[0])==null?void 0:l.commandOutput)+"")&&st(e,a)},i:B,o:B,d(s){s&&A(t)}}}function qt(i,t,e){let a,{iterationId:o}=t,{autofixData:s}=t;return i.$$set=n=>{"iterationId"in n&&e(1,o=n.iterationId),"autofixData"in n&&e(2,s=n.autofixData)},i.$$.update=()=>{var n;6&i.$$.dirty&&e(0,a=(n=s.autofixIterations)==null?void 0:n.filter(l=>l.id===o)[0])},[a,o,s]}class Ot extends P{constructor(t){super(),T(this,t,qt,Ft,z,{iterationId:1,autofixData:2})}}function V(i,t,e){const a=i.slice();return a[6]=t[e][0],a[7]=t[e][1],a}function X(i){let t,e,a;return e=new dt({}),{c(){t=b("li"),S(e.$$.fragment),D(t,"class","c-code-roll__item svelte-1iyponq")},m(o,s){v(o,t,s),F(e,t,null),a=!0},i(o){a||($(e.$$.fragment,o),a=!0)},o(o){m(e.$$.fragment,o),a=!1},d(o){o&&A(t),q(e)}}}function Z(i){var s;let t,e,a,o;return e=new bt({props:{codeActions:i[1],filepath:(s=i[7][0])==null?void 0:s.qualifiedPathName,readFile:i[3],onCodeAction:i[0],suggestions:i[7]}}),{c(){t=b("li"),S(e.$$.fragment),a=C(),D(t,"class","c-code-roll__item svelte-1iyponq")},m(n,l){v(n,t,l),F(e,t,null),y(t,a),o=!0},p(n,l){var c;const r={};2&l&&(r.codeActions=n[1]),16&l&&(r.filepath=(c=n[7][0])==null?void 0:c.qualifiedPathName),8&l&&(r.readFile=n[3]),1&l&&(r.onCodeAction=n[0]),16&l&&(r.suggestions=n[7]),e.$set(r)},i(n){o||($(e.$$.fragment,n),o=!0)},o(n){m(e.$$.fragment,n),o=!1},d(n){n&&A(t),q(e)}}}function Ct(i){let t,e,a,o=i[2]&&X(),s=j(i[4]),n=[];for(let r=0;r<s.length;r+=1)n[r]=Z(V(i,s,r));const l=r=>m(n[r],1,1,()=>{n[r]=null});return{c(){t=b("ul"),o&&o.c(),e=C();for(let r=0;r<n.length;r+=1)n[r].c();D(t,"class","c-code-roll svelte-1iyponq")},m(r,c){v(r,t,c),o&&o.m(t,null),y(t,e);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null);a=!0},p(r,[c]){if(r[2]?o?4&c&&$(o,1):(o=X(),o.c(),$(o,1),o.m(t,e)):o&&(L(),m(o,1,1,()=>{o=null}),M()),27&c){let d;for(s=j(r[4]),d=0;d<s.length;d+=1){const g=V(r,s,d);n[d]?(n[d].p(g,c),$(n[d],1)):(n[d]=Z(g),n[d].c(),$(n[d],1),n[d].m(t,null))}for(L(),d=s.length;d<n.length;d+=1)l(d);M()}},i(r){if(!a){$(o);for(let c=0;c<s.length;c+=1)$(n[c]);a=!0}},o(r){m(o),n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)m(n[c]);a=!1},d(r){r&&A(t),o&&o.d(),nt(n,r)}}}function Rt(i,t,e){let a,{suggestions:o=[]}=t,{onCodeAction:s=yt}=t,{codeActions:n=[]}=t,{loading:l=!0}=t,{readFile:r}=t;return i.$$set=c=>{"suggestions"in c&&e(5,o=c.suggestions),"onCodeAction"in c&&e(0,s=c.onCodeAction),"codeActions"in c&&e(1,n=c.codeActions),"loading"in c&&e(2,l=c.loading),"readFile"in c&&e(3,r=c.readFile)},i.$$.update=()=>{32&i.$$.dirty&&e(4,a=new Map(xt(o)))},[s,n,l,r,a,o]}class kt extends P{constructor(t){super(),T(this,t,Rt,Ct,z,{suggestions:5,onCodeAction:0,codeActions:1,loading:2,readFile:3})}}function Lt(i){let t;return{c(){t=k("Apply & Retest")},m(e,a){v(e,t,a)},d(e){e&&A(t)}}}function Mt(i){let t,e,a,o,s;return o=new N({props:{$$slots:{default:[Lt]},$$scope:{ctx:i}}}),o.$on("click",i[1]),{c(){t=b("div"),e=b("span"),e.textContent=`Here are the suggestions for how to fix this failure. You must review each change before
    continuing.`,a=C(),S(o.$$.fragment),D(t,"class","autofix-details-footer svelte-ry884d")},m(n,l){v(n,t,l),y(t,e),y(t,a),F(o,t,null),s=!0},p(n,[l]){const r={};4&l&&(r.$$scope={dirty:l,ctx:n}),o.$set(r)},i(n){s||($(o.$$.fragment,n),s=!0)},o(n){m(o.$$.fragment,n),s=!1},d(n){n&&A(t),q(o)}}}function Pt(i){const t=it();return[t,()=>t("applyAndRetestClick")]}class Tt extends P{constructor(t){super(),T(this,t,Pt,Mt,z,{})}}function tt(i){let t,e;return t=new kt({props:{suggestions:i[2],readFile:i[0],loading:!1}}),{c(){S(t.$$.fragment)},m(a,o){F(t,a,o),e=!0},p(a,o){const s={};4&o&&(s.suggestions=a[2]),1&o&&(s.readFile=a[0]),t.$set(s)},i(a){e||($(t.$$.fragment,a),e=!0)},o(a){m(t.$$.fragment,a),e=!1},d(a){q(t,a)}}}function et(i){let t,e;return t=new Tt({}),t.$on("applyAndRetestClick",i[7]),{c(){S(t.$$.fragment)},m(a,o){F(t,a,o),e=!0},p:B,i(a){e||($(t.$$.fragment,a),e=!0)},o(a){m(t.$$.fragment,a),e=!1},d(a){q(t,a)}}}function zt(i){let t,e,a,o,s=i[2]&&tt(i),n=i[1]&&et(i);return{c(){t=b("div"),e=b("div"),s&&s.c(),a=C(),n&&n.c(),D(e,"class","c-autofix-details-solution-coderoll-container svelte-1uzxw9z"),D(t,"class","c-autofix-details-solution svelte-1uzxw9z")},m(l,r){v(l,t,r),y(t,e),s&&s.m(e,null),y(t,a),n&&n.m(t,null),o=!0},p(l,[r]){l[2]?s?(s.p(l,r),4&r&&$(s,1)):(s=tt(l),s.c(),$(s,1),s.m(e,null)):s&&(L(),m(s,1,1,()=>{s=null}),M()),l[1]?n?(n.p(l,r),2&r&&$(n,1)):(n=et(l),n.c(),$(n,1),n.m(t,null)):n&&(L(),m(n,1,1,()=>{n=null}),M())},i(l){o||($(s),$(n),o=!0)},o(l){m(s),m(n),o=!1},d(l){l&&A(t),s&&s.d(),n&&n.d()}}}function jt(i,t,e){let a,o,{iterationId:s}=t,{autofixData:n}=t,{readFile:l}=t;const r=it();let c;return i.$$set=d=>{"iterationId"in d&&e(4,s=d.iterationId),"autofixData"in d&&e(5,n=d.autofixData),"readFile"in d&&e(0,l=d.readFile)},i.$$.update=()=>{var d,g,w,p,f;48&i.$$.dirty&&e(6,c=(d=n.autofixIterations)==null?void 0:d.filter(u=>u.id===s)[0]),64&i.$$.dirty&&e(2,a=(w=(g=c==null?void 0:c.suggestedSolutions)==null?void 0:g.at(-1))==null?void 0:w.replacements),48&i.$$.dirty&&e(1,o=s===((f=(p=n.autofixIterations)==null?void 0:p.at(-1))==null?void 0:f.id))},[l,o,a,r,s,n,c,()=>a&&r("applyAndRetest",a)]}class Et extends P{constructor(t){super(),T(this,t,jt,zt,z,{iterationId:4,autofixData:5,readFile:0})}}class Bt{constructor(t){_(this,"_asyncMsgSender");_(this,"_latestData");_(this,"subscribers",new Set);_(this,"_readFile");_(this,"dispose",()=>{this.subscribers.clear()});_(this,"notifySubscribers",()=>{this.subscribers.forEach(t=>t(this))});_(this,"subscribe",t=>(this.subscribers.add(t),t(this),()=>{this.subscribers.delete(t)}));_(this,"initialize",async()=>{const t=await this._asyncMsgSender.send({type:R.autofixPanelDetailsInitRequest},2e3);this.onOpenSpecificStage(t.data.iterationId,t.data.stage)});_(this,"applyAndRetest",async t=>{await this._asyncMsgSender.send({type:R.autofixPanelApplyAndRetestRequest,data:{selectedSolutions:t}},2e3)});_(this,"handleMessageFromExtension",async t=>{const e=t.data;switch(e.type){case R.autofixPanelStateUpdate:this._latestData=e.data,this.notifySubscribers();break;case R.autofixPanelExecuteCommandPartialOutput:this.handlePartialOutput(e.data.iterationId,e.data.output);break;case R.autofixPanelOpenSpecificStage:this.onOpenSpecificStage(e.data.iterationId,e.data.stage);break;case R.empty:break;default:console.warn("AutofixModel got unexpected message: ",e)}});this.onOpenSpecificStage=t,this._asyncMsgSender=new vt(e=>ht.postMessage(e)),this._readFile=It(this._asyncMsgSender),this.initialize()}get latestData(){return this._latestData}get readFile(){return this._readFile}handlePartialOutput(t,e){var a,o;(o=(a=this._latestData)==null?void 0:a.autofixIterations)==null||o.forEach(s=>{s.id===t&&(s.commandOutput=e)}),this.notifySubscribers()}}function at(i){let t,e,a,o,s,n,l,r;function c(u){i[5](u)}function d(u){i[6](u)}let g={autofixData:i[0]};i[1]!==void 0&&(g.currentIterationId=i[1]),i[2]!==void 0&&(g.currentTab=i[2]),t=new St({props:g}),Q.push(()=>U(t,"currentIterationId",c)),Q.push(()=>U(t,"currentTab",d));const w=[Gt,Nt],p=[];function f(u,h){return u[2]===I.testLog?0:u[2]===I.solution?1:-1}return~(s=f(i))&&(n=p[s]=w[s](i)),{c(){S(t.$$.fragment),o=C(),n&&n.c(),l=gt()},m(u,h){F(t,u,h),v(u,o,h),~s&&p[s].m(u,h),v(u,l,h),r=!0},p(u,h){const O={};1&h&&(O.autofixData=u[0]),!e&&2&h&&(e=!0,O.currentIterationId=u[1],W(()=>e=!1)),!a&&4&h&&(a=!0,O.currentTab=u[2],W(()=>a=!1)),t.$set(O);let x=s;s=f(u),s===x?~s&&p[s].p(u,h):(n&&(L(),m(p[x],1,1,()=>{p[x]=null}),M()),~s?(n=p[s],n?n.p(u,h):(n=p[s]=w[s](u),n.c()),$(n,1),n.m(l.parentNode,l)):n=null)},i(u){r||($(t.$$.fragment,u),$(n),r=!0)},o(u){m(t.$$.fragment,u),m(n),r=!1},d(u){u&&(A(o),A(l)),q(t,u),~s&&p[s].d(u)}}}function Nt(i){let t,e;return t=new Et({props:{autofixData:i[0],iterationId:i[1],readFile:i[3].readFile}}),t.$on("applyAndRetest",i[7]),{c(){S(t.$$.fragment)},m(a,o){F(t,a,o),e=!0},p(a,o){const s={};1&o&&(s.autofixData=a[0]),2&o&&(s.iterationId=a[1]),t.$set(s)},i(a){e||($(t.$$.fragment,a),e=!0)},o(a){m(t.$$.fragment,a),e=!1},d(a){q(t,a)}}}function Gt(i){let t,e;return t=new Ot({props:{iterationId:i[1],autofixData:i[0]}}),{c(){S(t.$$.fragment)},m(a,o){F(t,a,o),e=!0},p(a,o){const s={};2&o&&(s.iterationId=a[1]),1&o&&(s.autofixData=a[0]),t.$set(s)},i(a){e||($(t.$$.fragment,a),e=!0)},o(a){m(t.$$.fragment,a),e=!1},d(a){q(t,a)}}}function Ht(i){let t,e,a=i[0]&&at(i);return{c(){t=b("div"),a&&a.c(),D(t,"class","autofix-container svelte-107lb5t")},m(o,s){v(o,t,s),a&&a.m(t,null),e=!0},p(o,s){o[0]?a?(a.p(o,s),1&s&&$(a,1)):(a=at(o),a.c(),$(a,1),a.m(t,null)):a&&(L(),m(a,1,1,()=>{a=null}),M())},i(o){e||($(a),e=!0)},o(o){m(a),e=!1},d(o){o&&A(t),a&&a.d()}}}function Kt(i){let t,e,a,o;return t=new ft.Root({props:{$$slots:{default:[Ht]},$$scope:{ctx:i}}}),{c(){S(t.$$.fragment)},m(s,n){var l;F(t,s,n),e=!0,a||(o=E(window,"message",(l=i[3])==null?void 0:l.handleMessageFromExtension),a=!0)},p(s,[n]){const l={};519&n&&(l.$$scope={dirty:n,ctx:s}),t.$set(l)},i(s){e||($(t.$$.fragment,s),e=!0)},o(s){m(t.$$.fragment,s),e=!1},d(s){q(t,s),a=!1,o()}}}function Qt(i,t,e){let a,o,s,n=I.testLog,l=new Bt((r,c)=>{e(1,s=r),e(2,n=c===mt.runTest?I.testLog:I.solution)});return $t(i,l,r=>e(4,a=r)),pt(()=>{l.dispose()}),i.$$.update=()=>{16&i.$$.dirty&&e(0,o=a.latestData)},[o,s,n,l,a,function(r){s=r,e(1,s)},function(r){n=r,e(2,n)},r=>l==null?void 0:l.applyAndRetest(r.detail)]}new class extends P{constructor(i){super(),T(this,i,Qt,Kt,z,{})}}({target:document.getElementById("app")});
