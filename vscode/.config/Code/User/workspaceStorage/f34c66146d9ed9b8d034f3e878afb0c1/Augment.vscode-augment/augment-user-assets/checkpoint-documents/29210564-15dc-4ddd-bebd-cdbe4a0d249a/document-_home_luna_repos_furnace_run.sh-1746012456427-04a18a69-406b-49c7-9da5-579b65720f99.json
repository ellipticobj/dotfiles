{"path":{"rootPath":"/home/luna/repos/furnace","relPath":"run.sh"},"originalCode":"#!/bin/bash\n\n# Print the logo\nprint_logo() {\n    cat << \"EOF\"\n    ______                _ __    __\n   / ____/______  _______(_) /_  / /__\n  / /   / ___/ / / / ___/ / __ \\/ / _ \\\n / /___/ /  / /_/ / /__/ / /_/ / /  __/  Fedora System Crafting Tool\n \\____/_/   \\__,_/\\___/_/_.___/_/\\___/   by: typecraft\n\nEOF\n}\n\n# Function to display help\nshow_help() {\n  echo \"Usage: $0 [OPTION]\"\n  echo \"Options:\"\n  echo \"  -h, --help                 Display this help message\"\n  echo \"  -i, --install              Install packages from packages.conf (default)\"\n  echo \"  -e, --export               Export currently installed packages to a file\"\n  echo \"                             Creates fedora-packages-rpm.txt\"\n  echo \"  -d, --download [FILENAME]  Download and install packages from a file\"\n  echo \"                             Default: fedora-packages-rpm.txt\"\n  echo \"  -c, --current              Export and install currently installed packages\"\n  echo \"                             This is a shortcut for exporting and then installing\"\n  echo\n}\n\n# Parse command line arguments\nMODE=\"install\"\nIMPORT_FILE=\"\"\n\nwhile [[ $# -gt 0 ]]; do\n  case $1 in\n    -h|--help)\n      show_help\n      exit 0\n      ;;\n    -i|--install)\n      MODE=\"install\"\n      shift\n      ;;\n    -e|--export)\n      MODE=\"export\"\n      shift\n      ;;\n    -d|--download)\n      MODE=\"download\"\n      if [[ -n \"$2\" && ! \"$2\" =~ ^- ]]; then\n        IMPORT_FILE=\"$2\"\n        shift\n      fi\n      shift\n      ;;\n    -c|--current)\n      MODE=\"current\"\n      shift\n      ;;\n    *)\n      echo \"Unknown option: $1\"\n      show_help\n      exit 1\n      ;;\n  esac\ndone\n\n# Clear screen and show logo\nclear\nprint_logo\n\n# Exit on any error\nset -e\n\n# Handle export mode\nif [[ \"$MODE\" == \"export\" ]]; then\n  echo \"Exporting currently installed packages...\"\n  ./rpm-export.sh\n  exit 0\nfi\n\n# Handle download mode\nif [[ \"$MODE\" == \"download\" ]]; then\n  if [[ -z \"$IMPORT_FILE\" ]]; then\n    IMPORT_FILE=\"fedora-packages-rpm.txt\"\n  fi\n\n  if [ ! -f \"$IMPORT_FILE\" ]; then\n    echo \"Error: Package list file not found: $IMPORT_FILE\"\n    exit 1\n  fi\n\n  # Update the system first\n  echo \"Updating system...\"\n  sudo dnf upgrade -y\n\n  # Import and install packages\n  ./install-packages.sh \"$IMPORT_FILE\"\n\n  # Install flatpaks if the script exists\n  if [ -f \"install-flatpaks.sh\" ]; then\n    echo \"Installing flatpaks...\"\n    . install-flatpaks.sh\n  fi\n\n  echo \"Download and installation complete! You may want to reboot your system.\"\n  exit 0\nfi\n\n# Handle current mode (export and install)\nif [[ \"$MODE\" == \"current\" ]]; then\n  echo \"Exporting currently installed packages...\"\n  ./rpm-export.sh\n\n  echo \"Installing exported packages...\"\n  ./install-packages.sh \"fedora-packages-rpm.txt\"\n\n  # Install flatpaks if the script exists\n  if [ -f \"install-flatpaks.sh\" ]; then\n    echo \"Installing flatpaks...\"\n    . install-flatpaks.sh\n  fi\n\n  echo \"Export and installation complete! You may want to reboot your system.\"\n  exit 0\nfi\n\n# Continue with installation mode from packages.conf\n# Source the package list\nif [ ! -f \"packages.conf\" ]; then\n  echo \"Error: packages.conf not found!\"\n  exit 1\nfi\n\nsource packages.conf\n\necho \"Starting system setup...\"\n\n# Update the system first\necho \"Updating system...\"\nsudo dnf upgrade -y\n\n# Install packages by category\necho \"Installing system utilities...\"\nfor pkg in \"${SYSTEM_UTILS[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\necho \"Installing development tools...\"\nfor pkg in \"${DEV_TOOLS[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\necho \"Installing system maintenance tools...\"\nfor pkg in \"${MAINTENANCE[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\necho \"Installing desktop environment...\"\nfor pkg in \"${DESKTOP[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\nif [[ -n \"${OFFICE[@]}\" ]]; then\n  echo \"Installing office applications...\"\n  for pkg in \"${OFFICE[@]}\"; do\n    sudo dnf install -y \"$pkg\"\n  done\nfi\n\necho \"Installing media packages...\"\nfor pkg in \"${MEDIA[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\necho \"Installing fonts...\"\nfor pkg in \"${FONTS[@]}\"; do\n  sudo dnf install -y \"$pkg\"\ndone\n\n# Enable services\necho \"Configuring services...\"\nfor service in \"${SERVICES[@]}\"; do\n  if ! systemctl is-enabled \"$service\" &> /dev/null; then\n    echo \"Enabling $service...\"\n    sudo systemctl enable \"$service\"\n  else\n    echo \"$service is already enabled\"\n  fi\ndone\n\n# Some programs just run better as flatpaks. Like discord/spotify\nif [ -f \"install-flatpaks.sh\" ]; then\n  echo \"Installing flatpaks...\"\n  . install-flatpaks.sh\nfi\n\necho \"Setup complete! You may want to reboot your system.\"\n","modifiedCode":"#!/bin/bash\n\n# Print the logo\nprint_logo() {\n    cat << \"EOF\"\n    ______                _ __    __\n   / ____/______  _______(_) /_  / /__\n  / /   / ___/ / / / ___/ / __ \\/ / _ \\\n / /___/ /  / /_/ / /__/ / /_/ / /  __/  Fedora System Crafting Tool\n \\____/_/   \\__,_/\\___/_/_.___/_/\\___/   by: typecraft\n\nEOF\n}\n\n# Function to display help\nshow_help() {\n  echo \"Usage: $0 [OPTION]\"\n  echo \"Options:\"\n  echo \"  -h, --help                 Display this help message\"\n  echo \"  -i, --install              Install packages from packages.conf (default)\"\n  echo \"  -e, --export               Export currently installed packages to a file\"\n  echo \"                             Creates fedora-packages-rpm.txt\"\n  echo \"  -d, --download [FILENAME]  Download and install packages from a file\"\n  echo \"                             Default: fedora-packages-rpm.txt\"\n  echo \"  -c, --current              Export and install currently installed packages\"\n  echo \"                             This is a shortcut for exporting and then installing\"\n  echo\n}\n\n# Parse command line arguments\nMODE=\"install\"\nIMPORT_FILE=\"\"\n\nwhile [[ $# -gt 0 ]]; do\n  case $1 in\n    -h|--help)\n      show_help\n      exit 0\n      ;;\n    -i|--install)\n      MODE=\"install\"\n      shift\n      ;;\n    -e|--export)\n      MODE=\"export\"\n      shift\n      ;;\n    -d|--download)\n      MODE=\"download\"\n      if [[ -n \"$2\" && ! \"$2\" =~ ^- ]]; then\n        IMPORT_FILE=\"$2\"\n        shift\n      fi\n      shift\n      ;;\n    -c|--current)\n      MODE=\"current\"\n      shift\n      ;;\n    *)\n      echo \"Unknown option: $1\"\n      show_help\n      exit 1\n      ;;\n  esac\ndone\n\n# Clear screen and show logo\nclear\nprint_logo\n\n# Exit on any error\nset -e\n\n# Handle export mode\nif [[ \"$MODE\" == \"export\" ]]; then\n  echo \"Exporting currently installed packages...\"\n  ./rpm-export.sh\n  exit 0\nfi\n\n# Handle download mode\nif [[ \"$MODE\" == \"download\" ]]; then\n  if [[ -z \"$IMPORT_FILE\" ]]; then\n    IMPORT_FILE=\"fedora-packages-rpm.txt\"\n  fi\n\n  if [ ! -f \"$IMPORT_FILE\" ]; then\n    echo \"Error: Package list file not found: $IMPORT_FILE\"\n    exit 1\n  fi\n\n  # Update the system first\n  echo \"Updating system...\"\n  sudo dnf upgrade -y\n\n  # Import and install packages\n  ./install-packages.sh \"$IMPORT_FILE\"\n\n  # Install flatpaks if the script exists\n  if [ -f \"install-flatpaks.sh\" ]; then\n    echo \"Installing flatpaks...\"\n    . install-flatpaks.sh\n  fi\n\n  echo \"Download and installation complete! You may want to reboot your system.\"\n  exit 0\nfi\n\n# Handle current mode (export and install)\nif [[ \"$MODE\" == \"current\" ]]; then\n  echo \"Exporting currently installed packages...\"\n  ./rpm-export.sh\n\n  echo \"Installing exported packages...\"\n  ./install-packages.sh \"fedora-packages-rpm.txt\"\n\n  # Install flatpaks if the script exists\n  if [ -f \"install-flatpaks.sh\" ]; then\n    echo \"Installing flatpaks...\"\n    . install-flatpaks.sh\n  fi\n\n  echo \"Export and installation complete! You may want to reboot your system.\"\n  exit 0\nfi\n\n# Continue with installation mode from packages.conf\n# Source the package list\nif [ ! -f \"packages.conf\" ]; then\n  echo \"Error: packages.conf not found!\"\n  exit 1\nfi\n\nsource packages.conf\n\necho \"Starting system setup...\"\n\n# Update the system first\necho \"Updating system...\"\nsudo dnf upgrade -y\n\n# Function to install packages in batches\ninstall_packages() {\n  local category_name=\"$1\"\n  shift\n  local packages=(\"$@\")\n\n  if [ ${#packages[@]} -eq 0 ]; then\n    return\n  fi\n\n  echo \"Installing $category_name...\"\n\n  # Install in batches of 20 to avoid command line length issues\n  local batch_size=20\n  local total_packages=${#packages[@]}\n  local batches=$(( (total_packages + batch_size - 1) / batch_size ))\n\n  for ((i=0; i<batches; i++)); do\n    local start=$((i * batch_size))\n    local end=$(( (i+1) * batch_size > total_packages ? total_packages : (i+1) * batch_size ))\n    local batch=(\"${packages[@]:start:end-start}\")\n\n    echo \"Installing batch $((i+1))/$batches ($(( end - start )) packages)...\"\n    sudo dnf install -y \"${batch[@]}\"\n  done\n}\n\n# Install packages by category\ninstall_packages \"system utilities\" \"${SYSTEM_UTILS[@]}\"\ninstall_packages \"development tools\" \"${DEV_TOOLS[@]}\"\ninstall_packages \"system maintenance tools\" \"${MAINTENANCE[@]}\"\ninstall_packages \"desktop environment\" \"${DESKTOP[@]}\"\ninstall_packages \"office applications\" \"${OFFICE[@]}\"\ninstall_packages \"media packages\" \"${MEDIA[@]}\"\ninstall_packages \"fonts\" \"${FONTS[@]}\"\n\n# Enable services\necho \"Configuring services...\"\nfor service in \"${SERVICES[@]}\"; do\n  if ! systemctl is-enabled \"$service\" &> /dev/null; then\n    echo \"Enabling $service...\"\n    sudo systemctl enable \"$service\"\n  else\n    echo \"$service is already enabled\"\n  fi\ndone\n\n# Some programs just run better as flatpaks. Like discord/spotify\nif [ -f \"install-flatpaks.sh\" ]; then\n  echo \"Installing flatpaks...\"\n  . install-flatpaks.sh\nfi\n\necho \"Setup complete! You may want to reboot your system.\"\n"}